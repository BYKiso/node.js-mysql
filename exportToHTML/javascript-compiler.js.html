<html>
<head>
<title>javascript-compiler.js</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #6aab73;}
.s1 { color: #bcbec4;}
.s2 { color: #bcbec4;}
.s3 { color: #cf8e6d;}
.s4 { color: #7a7e85;}
.s5 { color: #2aacb8;}
.s6 { color: #5f826b; font-style: italic;}
.s7 { color: #67a37c; font-style: italic;}
.s8 { color: #42c3d4;}
.ln { color: #4b5059; font-weight: normal; font-style: normal; }
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
javascript-compiler.js</font>
</center></td></tr></table>
<pre><a name="l1"><span class="ln">1    </span></a><span class="s0">'use strict'</span><span class="s1">;</span>
<a name="l2"><span class="ln">2    </span></a>
<a name="l3"><span class="ln">3    </span></a><span class="s2">exports</span><span class="s1">.</span><span class="s2">__esModule </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
<a name="l4"><span class="ln">4    </span></a><span class="s4">// istanbul ignore next</span>
<a name="l5"><span class="ln">5    </span></a>
<a name="l6"><span class="ln">6    </span></a><span class="s3">function </span><span class="s2">_interopRequireDefault</span><span class="s1">(</span><span class="s2">obj</span><span class="s1">) { </span><span class="s3">return </span><span class="s2">obj </span><span class="s1">&amp;&amp; </span><span class="s2">obj</span><span class="s1">.</span><span class="s2">__esModule </span><span class="s1">? </span><span class="s2">obj </span><span class="s1">: { </span><span class="s0">'default'</span><span class="s1">: </span><span class="s2">obj </span><span class="s1">}; }</span>
<a name="l7"><span class="ln">7    </span></a>
<a name="l8"><span class="ln">8    </span></a><span class="s3">var </span><span class="s2">_base </span><span class="s1">= </span><span class="s2">require</span><span class="s1">(</span><span class="s0">'../base'</span><span class="s1">);</span>
<a name="l9"><span class="ln">9    </span></a>
<a name="l10"><span class="ln">10   </span></a><span class="s3">var </span><span class="s2">_exception </span><span class="s1">= </span><span class="s2">require</span><span class="s1">(</span><span class="s0">'../exception'</span><span class="s1">);</span>
<a name="l11"><span class="ln">11   </span></a>
<a name="l12"><span class="ln">12   </span></a><span class="s3">var </span><span class="s2">_exception2 </span><span class="s1">= </span><span class="s2">_interopRequireDefault</span><span class="s1">(</span><span class="s2">_exception</span><span class="s1">);</span>
<a name="l13"><span class="ln">13   </span></a>
<a name="l14"><span class="ln">14   </span></a><span class="s3">var </span><span class="s2">_utils </span><span class="s1">= </span><span class="s2">require</span><span class="s1">(</span><span class="s0">'../utils'</span><span class="s1">);</span>
<a name="l15"><span class="ln">15   </span></a>
<a name="l16"><span class="ln">16   </span></a><span class="s3">var </span><span class="s2">_codeGen </span><span class="s1">= </span><span class="s2">require</span><span class="s1">(</span><span class="s0">'./code-gen'</span><span class="s1">);</span>
<a name="l17"><span class="ln">17   </span></a>
<a name="l18"><span class="ln">18   </span></a><span class="s3">var </span><span class="s2">_codeGen2 </span><span class="s1">= </span><span class="s2">_interopRequireDefault</span><span class="s1">(</span><span class="s2">_codeGen</span><span class="s1">);</span>
<a name="l19"><span class="ln">19   </span></a>
<a name="l20"><span class="ln">20   </span></a><span class="s3">function </span><span class="s2">Literal</span><span class="s1">(</span><span class="s2">value</span><span class="s1">) {</span>
<a name="l21"><span class="ln">21   </span></a>  <span class="s3">this</span><span class="s1">.</span><span class="s2">value </span><span class="s1">= </span><span class="s2">value</span><span class="s1">;</span>
<a name="l22"><span class="ln">22   </span></a><span class="s1">}</span>
<a name="l23"><span class="ln">23   </span></a>
<a name="l24"><span class="ln">24   </span></a><span class="s3">function </span><span class="s2">JavaScriptCompiler</span><span class="s1">() {}</span>
<a name="l25"><span class="ln">25   </span></a>
<a name="l26"><span class="ln">26   </span></a><span class="s2">JavaScriptCompiler</span><span class="s1">.</span><span class="s2">prototype </span><span class="s1">= {</span>
<a name="l27"><span class="ln">27   </span></a>  <span class="s4">// PUBLIC API: You can override these methods in a subclass to provide</span>
<a name="l28"><span class="ln">28   </span></a>  <span class="s4">// alternative compiled forms for name lookup and buffering semantics</span>
<a name="l29"><span class="ln">29   </span></a>  <span class="s2">nameLookup</span><span class="s1">: </span><span class="s3">function </span><span class="s2">nameLookup</span><span class="s1">(</span><span class="s2">parent</span><span class="s1">, </span><span class="s2">name </span><span class="s4">/*,  type */</span><span class="s1">) {</span>
<a name="l30"><span class="ln">30   </span></a>    <span class="s3">return this</span><span class="s1">.</span><span class="s2">internalNameLookup</span><span class="s1">(</span><span class="s2">parent</span><span class="s1">, </span><span class="s2">name</span><span class="s1">);</span>
<a name="l31"><span class="ln">31   </span></a>  <span class="s1">},</span>
<a name="l32"><span class="ln">32   </span></a>  <span class="s2">depthedLookup</span><span class="s1">: </span><span class="s3">function </span><span class="s2">depthedLookup</span><span class="s1">(</span><span class="s2">name</span><span class="s1">) {</span>
<a name="l33"><span class="ln">33   </span></a>    <span class="s3">return </span><span class="s1">[</span><span class="s3">this</span><span class="s1">.</span><span class="s2">aliasable</span><span class="s1">(</span><span class="s0">'container.lookup'</span><span class="s1">), </span><span class="s0">'(depths, '</span><span class="s1">, </span><span class="s2">JSON</span><span class="s1">.</span><span class="s2">stringify</span><span class="s1">(</span><span class="s2">name</span><span class="s1">), </span><span class="s0">')'</span><span class="s1">];</span>
<a name="l34"><span class="ln">34   </span></a>  <span class="s1">},</span>
<a name="l35"><span class="ln">35   </span></a>
<a name="l36"><span class="ln">36   </span></a>  <span class="s2">compilerInfo</span><span class="s1">: </span><span class="s3">function </span><span class="s2">compilerInfo</span><span class="s1">() {</span>
<a name="l37"><span class="ln">37   </span></a>    <span class="s3">var </span><span class="s2">revision </span><span class="s1">= </span><span class="s2">_base</span><span class="s1">.</span><span class="s2">COMPILER_REVISION</span><span class="s1">,</span>
<a name="l38"><span class="ln">38   </span></a>        <span class="s2">versions </span><span class="s1">= </span><span class="s2">_base</span><span class="s1">.</span><span class="s2">REVISION_CHANGES</span><span class="s1">[</span><span class="s2">revision</span><span class="s1">];</span>
<a name="l39"><span class="ln">39   </span></a>    <span class="s3">return </span><span class="s1">[</span><span class="s2">revision</span><span class="s1">, </span><span class="s2">versions</span><span class="s1">];</span>
<a name="l40"><span class="ln">40   </span></a>  <span class="s1">},</span>
<a name="l41"><span class="ln">41   </span></a>
<a name="l42"><span class="ln">42   </span></a>  <span class="s2">appendToBuffer</span><span class="s1">: </span><span class="s3">function </span><span class="s2">appendToBuffer</span><span class="s1">(</span><span class="s2">source</span><span class="s1">, </span><span class="s2">location</span><span class="s1">, </span><span class="s2">explicit</span><span class="s1">) {</span>
<a name="l43"><span class="ln">43   </span></a>    <span class="s4">// Force a source as this simplifies the merge logic.</span>
<a name="l44"><span class="ln">44   </span></a>    <span class="s3">if </span><span class="s1">(!</span><span class="s2">_utils</span><span class="s1">.</span><span class="s2">isArray</span><span class="s1">(</span><span class="s2">source</span><span class="s1">)) {</span>
<a name="l45"><span class="ln">45   </span></a>      <span class="s2">source </span><span class="s1">= [</span><span class="s2">source</span><span class="s1">];</span>
<a name="l46"><span class="ln">46   </span></a>    <span class="s1">}</span>
<a name="l47"><span class="ln">47   </span></a>    <span class="s2">source </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">source</span><span class="s1">.</span><span class="s2">wrap</span><span class="s1">(</span><span class="s2">source</span><span class="s1">, </span><span class="s2">location</span><span class="s1">);</span>
<a name="l48"><span class="ln">48   </span></a>
<a name="l49"><span class="ln">49   </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">environment</span><span class="s1">.</span><span class="s2">isSimple</span><span class="s1">) {</span>
<a name="l50"><span class="ln">50   </span></a>      <span class="s3">return </span><span class="s1">[</span><span class="s0">'return '</span><span class="s1">, </span><span class="s2">source</span><span class="s1">, </span><span class="s0">';'</span><span class="s1">];</span>
<a name="l51"><span class="ln">51   </span></a>    <span class="s1">} </span><span class="s3">else if </span><span class="s1">(</span><span class="s2">explicit</span><span class="s1">) {</span>
<a name="l52"><span class="ln">52   </span></a>      <span class="s4">// This is a case where the buffer operation occurs as a child of another</span>
<a name="l53"><span class="ln">53   </span></a>      <span class="s4">// construct, generally braces. We have to explicitly output these buffer</span>
<a name="l54"><span class="ln">54   </span></a>      <span class="s4">// operations to ensure that the emitted code goes in the correct location.</span>
<a name="l55"><span class="ln">55   </span></a>      <span class="s3">return </span><span class="s1">[</span><span class="s0">'buffer += '</span><span class="s1">, </span><span class="s2">source</span><span class="s1">, </span><span class="s0">';'</span><span class="s1">];</span>
<a name="l56"><span class="ln">56   </span></a>    <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
<a name="l57"><span class="ln">57   </span></a>      <span class="s2">source</span><span class="s1">.</span><span class="s2">appendToBuffer </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
<a name="l58"><span class="ln">58   </span></a>      <span class="s3">return </span><span class="s2">source</span><span class="s1">;</span>
<a name="l59"><span class="ln">59   </span></a>    <span class="s1">}</span>
<a name="l60"><span class="ln">60   </span></a>  <span class="s1">},</span>
<a name="l61"><span class="ln">61   </span></a>
<a name="l62"><span class="ln">62   </span></a>  <span class="s2">initializeBuffer</span><span class="s1">: </span><span class="s3">function </span><span class="s2">initializeBuffer</span><span class="s1">() {</span>
<a name="l63"><span class="ln">63   </span></a>    <span class="s3">return this</span><span class="s1">.</span><span class="s2">quotedString</span><span class="s1">(</span><span class="s0">''</span><span class="s1">);</span>
<a name="l64"><span class="ln">64   </span></a>  <span class="s1">},</span>
<a name="l65"><span class="ln">65   </span></a>  <span class="s4">// END PUBLIC API</span>
<a name="l66"><span class="ln">66   </span></a>  <span class="s2">internalNameLookup</span><span class="s1">: </span><span class="s3">function </span><span class="s2">internalNameLookup</span><span class="s1">(</span><span class="s2">parent</span><span class="s1">, </span><span class="s2">name</span><span class="s1">) {</span>
<a name="l67"><span class="ln">67   </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">lookupPropertyFunctionIsUsed </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
<a name="l68"><span class="ln">68   </span></a>    <span class="s3">return </span><span class="s1">[</span><span class="s0">'lookupProperty('</span><span class="s1">, </span><span class="s2">parent</span><span class="s1">, </span><span class="s0">','</span><span class="s1">, </span><span class="s2">JSON</span><span class="s1">.</span><span class="s2">stringify</span><span class="s1">(</span><span class="s2">name</span><span class="s1">), </span><span class="s0">')'</span><span class="s1">];</span>
<a name="l69"><span class="ln">69   </span></a>  <span class="s1">},</span>
<a name="l70"><span class="ln">70   </span></a>
<a name="l71"><span class="ln">71   </span></a>  <span class="s2">lookupPropertyFunctionIsUsed</span><span class="s1">: </span><span class="s3">false</span><span class="s1">,</span>
<a name="l72"><span class="ln">72   </span></a>
<a name="l73"><span class="ln">73   </span></a>  <span class="s2">compile</span><span class="s1">: </span><span class="s3">function </span><span class="s2">compile</span><span class="s1">(</span><span class="s2">environment</span><span class="s1">, </span><span class="s2">options</span><span class="s1">, </span><span class="s2">context</span><span class="s1">, </span><span class="s2">asObject</span><span class="s1">) {</span>
<a name="l74"><span class="ln">74   </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">environment </span><span class="s1">= </span><span class="s2">environment</span><span class="s1">;</span>
<a name="l75"><span class="ln">75   </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">options </span><span class="s1">= </span><span class="s2">options</span><span class="s1">;</span>
<a name="l76"><span class="ln">76   </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">stringParams </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">stringParams</span><span class="s1">;</span>
<a name="l77"><span class="ln">77   </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">trackIds </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">trackIds</span><span class="s1">;</span>
<a name="l78"><span class="ln">78   </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">precompile </span><span class="s1">= !</span><span class="s2">asObject</span><span class="s1">;</span>
<a name="l79"><span class="ln">79   </span></a>
<a name="l80"><span class="ln">80   </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">name </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">environment</span><span class="s1">.</span><span class="s2">name</span><span class="s1">;</span>
<a name="l81"><span class="ln">81   </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">isChild </span><span class="s1">= !!</span><span class="s2">context</span><span class="s1">;</span>
<a name="l82"><span class="ln">82   </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">context </span><span class="s1">= </span><span class="s2">context </span><span class="s1">|| {</span>
<a name="l83"><span class="ln">83   </span></a>      <span class="s2">decorators</span><span class="s1">: [],</span>
<a name="l84"><span class="ln">84   </span></a>      <span class="s2">programs</span><span class="s1">: [],</span>
<a name="l85"><span class="ln">85   </span></a>      <span class="s2">environments</span><span class="s1">: []</span>
<a name="l86"><span class="ln">86   </span></a>    <span class="s1">};</span>
<a name="l87"><span class="ln">87   </span></a>
<a name="l88"><span class="ln">88   </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">preamble</span><span class="s1">();</span>
<a name="l89"><span class="ln">89   </span></a>
<a name="l90"><span class="ln">90   </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">stackSlot </span><span class="s1">= </span><span class="s5">0</span><span class="s1">;</span>
<a name="l91"><span class="ln">91   </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">stackVars </span><span class="s1">= [];</span>
<a name="l92"><span class="ln">92   </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">aliases </span><span class="s1">= {};</span>
<a name="l93"><span class="ln">93   </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">registers </span><span class="s1">= { </span><span class="s2">list</span><span class="s1">: [] };</span>
<a name="l94"><span class="ln">94   </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">hashes </span><span class="s1">= [];</span>
<a name="l95"><span class="ln">95   </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">compileStack </span><span class="s1">= [];</span>
<a name="l96"><span class="ln">96   </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">inlineStack </span><span class="s1">= [];</span>
<a name="l97"><span class="ln">97   </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">blockParams </span><span class="s1">= [];</span>
<a name="l98"><span class="ln">98   </span></a>
<a name="l99"><span class="ln">99   </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">compileChildren</span><span class="s1">(</span><span class="s2">environment</span><span class="s1">, </span><span class="s2">options</span><span class="s1">);</span>
<a name="l100"><span class="ln">100  </span></a>
<a name="l101"><span class="ln">101  </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">useDepths </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">useDepths </span><span class="s1">|| </span><span class="s2">environment</span><span class="s1">.</span><span class="s2">useDepths </span><span class="s1">|| </span><span class="s2">environment</span><span class="s1">.</span><span class="s2">useDecorators </span><span class="s1">|| </span><span class="s3">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">compat</span><span class="s1">;</span>
<a name="l102"><span class="ln">102  </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">useBlockParams </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">useBlockParams </span><span class="s1">|| </span><span class="s2">environment</span><span class="s1">.</span><span class="s2">useBlockParams</span><span class="s1">;</span>
<a name="l103"><span class="ln">103  </span></a>
<a name="l104"><span class="ln">104  </span></a>    <span class="s3">var </span><span class="s2">opcodes </span><span class="s1">= </span><span class="s2">environment</span><span class="s1">.</span><span class="s2">opcodes</span><span class="s1">,</span>
<a name="l105"><span class="ln">105  </span></a>        <span class="s2">opcode </span><span class="s1">= </span><span class="s2">undefined</span><span class="s1">,</span>
<a name="l106"><span class="ln">106  </span></a>        <span class="s2">firstLoc </span><span class="s1">= </span><span class="s2">undefined</span><span class="s1">,</span>
<a name="l107"><span class="ln">107  </span></a>        <span class="s2">i </span><span class="s1">= </span><span class="s2">undefined</span><span class="s1">,</span>
<a name="l108"><span class="ln">108  </span></a>        <span class="s2">l </span><span class="s1">= </span><span class="s2">undefined</span><span class="s1">;</span>
<a name="l109"><span class="ln">109  </span></a>
<a name="l110"><span class="ln">110  </span></a>    <span class="s3">for </span><span class="s1">(</span><span class="s2">i </span><span class="s1">= </span><span class="s5">0</span><span class="s1">, </span><span class="s2">l </span><span class="s1">= </span><span class="s2">opcodes</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">l</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
<a name="l111"><span class="ln">111  </span></a>      <span class="s2">opcode </span><span class="s1">= </span><span class="s2">opcodes</span><span class="s1">[</span><span class="s2">i</span><span class="s1">];</span>
<a name="l112"><span class="ln">112  </span></a>
<a name="l113"><span class="ln">113  </span></a>      <span class="s3">this</span><span class="s1">.</span><span class="s2">source</span><span class="s1">.</span><span class="s2">currentLocation </span><span class="s1">= </span><span class="s2">opcode</span><span class="s1">.</span><span class="s2">loc</span><span class="s1">;</span>
<a name="l114"><span class="ln">114  </span></a>      <span class="s2">firstLoc </span><span class="s1">= </span><span class="s2">firstLoc </span><span class="s1">|| </span><span class="s2">opcode</span><span class="s1">.</span><span class="s2">loc</span><span class="s1">;</span>
<a name="l115"><span class="ln">115  </span></a>      <span class="s3">this</span><span class="s1">[</span><span class="s2">opcode</span><span class="s1">.</span><span class="s2">opcode</span><span class="s1">].</span><span class="s2">apply</span><span class="s1">(</span><span class="s3">this</span><span class="s1">, </span><span class="s2">opcode</span><span class="s1">.</span><span class="s2">args</span><span class="s1">);</span>
<a name="l116"><span class="ln">116  </span></a>    <span class="s1">}</span>
<a name="l117"><span class="ln">117  </span></a>
<a name="l118"><span class="ln">118  </span></a>    <span class="s4">// Flush any trailing content that might be pending.</span>
<a name="l119"><span class="ln">119  </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">source</span><span class="s1">.</span><span class="s2">currentLocation </span><span class="s1">= </span><span class="s2">firstLoc</span><span class="s1">;</span>
<a name="l120"><span class="ln">120  </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">pushSource</span><span class="s1">(</span><span class="s0">''</span><span class="s1">);</span>
<a name="l121"><span class="ln">121  </span></a>
<a name="l122"><span class="ln">122  </span></a>    <span class="s4">/* istanbul ignore next */</span>
<a name="l123"><span class="ln">123  </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">stackSlot </span><span class="s1">|| </span><span class="s3">this</span><span class="s1">.</span><span class="s2">inlineStack</span><span class="s1">.</span><span class="s2">length </span><span class="s1">|| </span><span class="s3">this</span><span class="s1">.</span><span class="s2">compileStack</span><span class="s1">.</span><span class="s2">length</span><span class="s1">) {</span>
<a name="l124"><span class="ln">124  </span></a>      <span class="s3">throw new </span><span class="s2">_exception2</span><span class="s1">[</span><span class="s0">'default'</span><span class="s1">](</span><span class="s0">'Compile completed with content left on stack'</span><span class="s1">);</span>
<a name="l125"><span class="ln">125  </span></a>    <span class="s1">}</span>
<a name="l126"><span class="ln">126  </span></a>
<a name="l127"><span class="ln">127  </span></a>    <span class="s3">if </span><span class="s1">(!</span><span class="s3">this</span><span class="s1">.</span><span class="s2">decorators</span><span class="s1">.</span><span class="s2">isEmpty</span><span class="s1">()) {</span>
<a name="l128"><span class="ln">128  </span></a>      <span class="s3">this</span><span class="s1">.</span><span class="s2">useDecorators </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
<a name="l129"><span class="ln">129  </span></a>
<a name="l130"><span class="ln">130  </span></a>      <span class="s3">this</span><span class="s1">.</span><span class="s2">decorators</span><span class="s1">.</span><span class="s2">prepend</span><span class="s1">([</span><span class="s0">'var decorators = container.decorators, '</span><span class="s1">, </span><span class="s3">this</span><span class="s1">.</span><span class="s2">lookupPropertyFunctionVarDeclaration</span><span class="s1">(), </span><span class="s0">';</span><span class="s3">\n</span><span class="s0">'</span><span class="s1">]);</span>
<a name="l131"><span class="ln">131  </span></a>      <span class="s3">this</span><span class="s1">.</span><span class="s2">decorators</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s0">'return fn;'</span><span class="s1">);</span>
<a name="l132"><span class="ln">132  </span></a>
<a name="l133"><span class="ln">133  </span></a>      <span class="s3">if </span><span class="s1">(</span><span class="s2">asObject</span><span class="s1">) {</span>
<a name="l134"><span class="ln">134  </span></a>        <span class="s3">this</span><span class="s1">.</span><span class="s2">decorators </span><span class="s1">= </span><span class="s2">Function</span><span class="s1">.</span><span class="s2">apply</span><span class="s1">(</span><span class="s3">this</span><span class="s1">, [</span><span class="s0">'fn'</span><span class="s1">, </span><span class="s0">'props'</span><span class="s1">, </span><span class="s0">'container'</span><span class="s1">, </span><span class="s0">'depth0'</span><span class="s1">, </span><span class="s0">'data'</span><span class="s1">, </span><span class="s0">'blockParams'</span><span class="s1">, </span><span class="s0">'depths'</span><span class="s1">, </span><span class="s3">this</span><span class="s1">.</span><span class="s2">decorators</span><span class="s1">.</span><span class="s2">merge</span><span class="s1">()]);</span>
<a name="l135"><span class="ln">135  </span></a>      <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
<a name="l136"><span class="ln">136  </span></a>        <span class="s3">this</span><span class="s1">.</span><span class="s2">decorators</span><span class="s1">.</span><span class="s2">prepend</span><span class="s1">(</span><span class="s0">'function(fn, props, container, depth0, data, blockParams, depths) {</span><span class="s3">\n</span><span class="s0">'</span><span class="s1">);</span>
<a name="l137"><span class="ln">137  </span></a>        <span class="s3">this</span><span class="s1">.</span><span class="s2">decorators</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s0">'}</span><span class="s3">\n</span><span class="s0">'</span><span class="s1">);</span>
<a name="l138"><span class="ln">138  </span></a>        <span class="s3">this</span><span class="s1">.</span><span class="s2">decorators </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">decorators</span><span class="s1">.</span><span class="s2">merge</span><span class="s1">();</span>
<a name="l139"><span class="ln">139  </span></a>      <span class="s1">}</span>
<a name="l140"><span class="ln">140  </span></a>    <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
<a name="l141"><span class="ln">141  </span></a>      <span class="s3">this</span><span class="s1">.</span><span class="s2">decorators </span><span class="s1">= </span><span class="s2">undefined</span><span class="s1">;</span>
<a name="l142"><span class="ln">142  </span></a>    <span class="s1">}</span>
<a name="l143"><span class="ln">143  </span></a>
<a name="l144"><span class="ln">144  </span></a>    <span class="s3">var </span><span class="s2">fn </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">createFunctionContext</span><span class="s1">(</span><span class="s2">asObject</span><span class="s1">);</span>
<a name="l145"><span class="ln">145  </span></a>    <span class="s3">if </span><span class="s1">(!</span><span class="s3">this</span><span class="s1">.</span><span class="s2">isChild</span><span class="s1">) {</span>
<a name="l146"><span class="ln">146  </span></a>      <span class="s3">var </span><span class="s2">ret </span><span class="s1">= {</span>
<a name="l147"><span class="ln">147  </span></a>        <span class="s2">compiler</span><span class="s1">: </span><span class="s3">this</span><span class="s1">.</span><span class="s2">compilerInfo</span><span class="s1">(),</span>
<a name="l148"><span class="ln">148  </span></a>        <span class="s2">main</span><span class="s1">: </span><span class="s2">fn</span>
<a name="l149"><span class="ln">149  </span></a>      <span class="s1">};</span>
<a name="l150"><span class="ln">150  </span></a>
<a name="l151"><span class="ln">151  </span></a>      <span class="s3">if </span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">decorators</span><span class="s1">) {</span>
<a name="l152"><span class="ln">152  </span></a>        <span class="s2">ret</span><span class="s1">.</span><span class="s2">main_d </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">decorators</span><span class="s1">; </span><span class="s4">// eslint-disable-line camelcase</span>
<a name="l153"><span class="ln">153  </span></a>        <span class="s2">ret</span><span class="s1">.</span><span class="s2">useDecorators </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
<a name="l154"><span class="ln">154  </span></a>      <span class="s1">}</span>
<a name="l155"><span class="ln">155  </span></a>
<a name="l156"><span class="ln">156  </span></a>      <span class="s3">var </span><span class="s2">_context </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">context</span><span class="s1">;</span>
<a name="l157"><span class="ln">157  </span></a>      <span class="s3">var </span><span class="s2">programs </span><span class="s1">= </span><span class="s2">_context</span><span class="s1">.</span><span class="s2">programs</span><span class="s1">;</span>
<a name="l158"><span class="ln">158  </span></a>      <span class="s3">var </span><span class="s2">decorators </span><span class="s1">= </span><span class="s2">_context</span><span class="s1">.</span><span class="s2">decorators</span><span class="s1">;</span>
<a name="l159"><span class="ln">159  </span></a>
<a name="l160"><span class="ln">160  </span></a>      <span class="s3">for </span><span class="s1">(</span><span class="s2">i </span><span class="s1">= </span><span class="s5">0</span><span class="s1">, </span><span class="s2">l </span><span class="s1">= </span><span class="s2">programs</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">l</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
<a name="l161"><span class="ln">161  </span></a>        <span class="s3">if </span><span class="s1">(</span><span class="s2">programs</span><span class="s1">[</span><span class="s2">i</span><span class="s1">]) {</span>
<a name="l162"><span class="ln">162  </span></a>          <span class="s2">ret</span><span class="s1">[</span><span class="s2">i</span><span class="s1">] = </span><span class="s2">programs</span><span class="s1">[</span><span class="s2">i</span><span class="s1">];</span>
<a name="l163"><span class="ln">163  </span></a>          <span class="s3">if </span><span class="s1">(</span><span class="s2">decorators</span><span class="s1">[</span><span class="s2">i</span><span class="s1">]) {</span>
<a name="l164"><span class="ln">164  </span></a>            <span class="s2">ret</span><span class="s1">[</span><span class="s2">i </span><span class="s1">+ </span><span class="s0">'_d'</span><span class="s1">] = </span><span class="s2">decorators</span><span class="s1">[</span><span class="s2">i</span><span class="s1">];</span>
<a name="l165"><span class="ln">165  </span></a>            <span class="s2">ret</span><span class="s1">.</span><span class="s2">useDecorators </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
<a name="l166"><span class="ln">166  </span></a>          <span class="s1">}</span>
<a name="l167"><span class="ln">167  </span></a>        <span class="s1">}</span>
<a name="l168"><span class="ln">168  </span></a>      <span class="s1">}</span>
<a name="l169"><span class="ln">169  </span></a>
<a name="l170"><span class="ln">170  </span></a>      <span class="s3">if </span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">environment</span><span class="s1">.</span><span class="s2">usePartial</span><span class="s1">) {</span>
<a name="l171"><span class="ln">171  </span></a>        <span class="s2">ret</span><span class="s1">.</span><span class="s2">usePartial </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
<a name="l172"><span class="ln">172  </span></a>      <span class="s1">}</span>
<a name="l173"><span class="ln">173  </span></a>      <span class="s3">if </span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">data</span><span class="s1">) {</span>
<a name="l174"><span class="ln">174  </span></a>        <span class="s2">ret</span><span class="s1">.</span><span class="s2">useData </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
<a name="l175"><span class="ln">175  </span></a>      <span class="s1">}</span>
<a name="l176"><span class="ln">176  </span></a>      <span class="s3">if </span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">useDepths</span><span class="s1">) {</span>
<a name="l177"><span class="ln">177  </span></a>        <span class="s2">ret</span><span class="s1">.</span><span class="s2">useDepths </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
<a name="l178"><span class="ln">178  </span></a>      <span class="s1">}</span>
<a name="l179"><span class="ln">179  </span></a>      <span class="s3">if </span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">useBlockParams</span><span class="s1">) {</span>
<a name="l180"><span class="ln">180  </span></a>        <span class="s2">ret</span><span class="s1">.</span><span class="s2">useBlockParams </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
<a name="l181"><span class="ln">181  </span></a>      <span class="s1">}</span>
<a name="l182"><span class="ln">182  </span></a>      <span class="s3">if </span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">compat</span><span class="s1">) {</span>
<a name="l183"><span class="ln">183  </span></a>        <span class="s2">ret</span><span class="s1">.</span><span class="s2">compat </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
<a name="l184"><span class="ln">184  </span></a>      <span class="s1">}</span>
<a name="l185"><span class="ln">185  </span></a>
<a name="l186"><span class="ln">186  </span></a>      <span class="s3">if </span><span class="s1">(!</span><span class="s2">asObject</span><span class="s1">) {</span>
<a name="l187"><span class="ln">187  </span></a>        <span class="s2">ret</span><span class="s1">.</span><span class="s2">compiler </span><span class="s1">= </span><span class="s2">JSON</span><span class="s1">.</span><span class="s2">stringify</span><span class="s1">(</span><span class="s2">ret</span><span class="s1">.</span><span class="s2">compiler</span><span class="s1">);</span>
<a name="l188"><span class="ln">188  </span></a>
<a name="l189"><span class="ln">189  </span></a>        <span class="s3">this</span><span class="s1">.</span><span class="s2">source</span><span class="s1">.</span><span class="s2">currentLocation </span><span class="s1">= { </span><span class="s2">start</span><span class="s1">: { </span><span class="s2">line</span><span class="s1">: </span><span class="s5">1</span><span class="s1">, </span><span class="s2">column</span><span class="s1">: </span><span class="s5">0 </span><span class="s1">} };</span>
<a name="l190"><span class="ln">190  </span></a>        <span class="s2">ret </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">objectLiteral</span><span class="s1">(</span><span class="s2">ret</span><span class="s1">);</span>
<a name="l191"><span class="ln">191  </span></a>
<a name="l192"><span class="ln">192  </span></a>        <span class="s3">if </span><span class="s1">(</span><span class="s2">options</span><span class="s1">.</span><span class="s2">srcName</span><span class="s1">) {</span>
<a name="l193"><span class="ln">193  </span></a>          <span class="s2">ret </span><span class="s1">= </span><span class="s2">ret</span><span class="s1">.</span><span class="s2">toStringWithSourceMap</span><span class="s1">({ </span><span class="s2">file</span><span class="s1">: </span><span class="s2">options</span><span class="s1">.</span><span class="s2">destName </span><span class="s1">});</span>
<a name="l194"><span class="ln">194  </span></a>          <span class="s2">ret</span><span class="s1">.</span><span class="s2">map </span><span class="s1">= </span><span class="s2">ret</span><span class="s1">.</span><span class="s2">map </span><span class="s1">&amp;&amp; </span><span class="s2">ret</span><span class="s1">.</span><span class="s2">map</span><span class="s1">.</span><span class="s2">toString</span><span class="s1">();</span>
<a name="l195"><span class="ln">195  </span></a>        <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
<a name="l196"><span class="ln">196  </span></a>          <span class="s2">ret </span><span class="s1">= </span><span class="s2">ret</span><span class="s1">.</span><span class="s2">toString</span><span class="s1">();</span>
<a name="l197"><span class="ln">197  </span></a>        <span class="s1">}</span>
<a name="l198"><span class="ln">198  </span></a>      <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
<a name="l199"><span class="ln">199  </span></a>        <span class="s2">ret</span><span class="s1">.</span><span class="s2">compilerOptions </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">;</span>
<a name="l200"><span class="ln">200  </span></a>      <span class="s1">}</span>
<a name="l201"><span class="ln">201  </span></a>
<a name="l202"><span class="ln">202  </span></a>      <span class="s3">return </span><span class="s2">ret</span><span class="s1">;</span>
<a name="l203"><span class="ln">203  </span></a>    <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
<a name="l204"><span class="ln">204  </span></a>      <span class="s3">return </span><span class="s2">fn</span><span class="s1">;</span>
<a name="l205"><span class="ln">205  </span></a>    <span class="s1">}</span>
<a name="l206"><span class="ln">206  </span></a>  <span class="s1">},</span>
<a name="l207"><span class="ln">207  </span></a>
<a name="l208"><span class="ln">208  </span></a>  <span class="s2">preamble</span><span class="s1">: </span><span class="s3">function </span><span class="s2">preamble</span><span class="s1">() {</span>
<a name="l209"><span class="ln">209  </span></a>    <span class="s4">// track the last context pushed into place to allow skipping the</span>
<a name="l210"><span class="ln">210  </span></a>    <span class="s4">// getContext opcode when it would be a noop</span>
<a name="l211"><span class="ln">211  </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">lastContext </span><span class="s1">= </span><span class="s5">0</span><span class="s1">;</span>
<a name="l212"><span class="ln">212  </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">source </span><span class="s1">= </span><span class="s3">new </span><span class="s2">_codeGen2</span><span class="s1">[</span><span class="s0">'default'</span><span class="s1">](</span><span class="s3">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">srcName</span><span class="s1">);</span>
<a name="l213"><span class="ln">213  </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">decorators </span><span class="s1">= </span><span class="s3">new </span><span class="s2">_codeGen2</span><span class="s1">[</span><span class="s0">'default'</span><span class="s1">](</span><span class="s3">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">srcName</span><span class="s1">);</span>
<a name="l214"><span class="ln">214  </span></a>  <span class="s1">},</span>
<a name="l215"><span class="ln">215  </span></a>
<a name="l216"><span class="ln">216  </span></a>  <span class="s2">createFunctionContext</span><span class="s1">: </span><span class="s3">function </span><span class="s2">createFunctionContext</span><span class="s1">(</span><span class="s2">asObject</span><span class="s1">) {</span>
<a name="l217"><span class="ln">217  </span></a>    <span class="s4">// istanbul ignore next</span>
<a name="l218"><span class="ln">218  </span></a>
<a name="l219"><span class="ln">219  </span></a>    <span class="s3">var </span><span class="s2">_this </span><span class="s1">= </span><span class="s3">this</span><span class="s1">;</span>
<a name="l220"><span class="ln">220  </span></a>
<a name="l221"><span class="ln">221  </span></a>    <span class="s3">var </span><span class="s2">varDeclarations </span><span class="s1">= </span><span class="s0">''</span><span class="s1">;</span>
<a name="l222"><span class="ln">222  </span></a>
<a name="l223"><span class="ln">223  </span></a>    <span class="s3">var </span><span class="s2">locals </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">stackVars</span><span class="s1">.</span><span class="s2">concat</span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">registers</span><span class="s1">.</span><span class="s2">list</span><span class="s1">);</span>
<a name="l224"><span class="ln">224  </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s2">locals</span><span class="s1">.</span><span class="s2">length </span><span class="s1">&gt; </span><span class="s5">0</span><span class="s1">) {</span>
<a name="l225"><span class="ln">225  </span></a>      <span class="s2">varDeclarations </span><span class="s1">+= </span><span class="s0">', ' </span><span class="s1">+ </span><span class="s2">locals</span><span class="s1">.</span><span class="s2">join</span><span class="s1">(</span><span class="s0">', '</span><span class="s1">);</span>
<a name="l226"><span class="ln">226  </span></a>    <span class="s1">}</span>
<a name="l227"><span class="ln">227  </span></a>
<a name="l228"><span class="ln">228  </span></a>    <span class="s4">// Generate minimizer alias mappings</span>
<a name="l229"><span class="ln">229  </span></a>    <span class="s4">//</span>
<a name="l230"><span class="ln">230  </span></a>    <span class="s4">// When using true SourceNodes, this will update all references to the given alias</span>
<a name="l231"><span class="ln">231  </span></a>    <span class="s4">// as the source nodes are reused in situ. For the non-source node compilation mode,</span>
<a name="l232"><span class="ln">232  </span></a>    <span class="s4">// aliases will not be used, but this case is already being run on the client and</span>
<a name="l233"><span class="ln">233  </span></a>    <span class="s4">// we aren't concern about minimizing the template size.</span>
<a name="l234"><span class="ln">234  </span></a>    <span class="s3">var </span><span class="s2">aliasCount </span><span class="s1">= </span><span class="s5">0</span><span class="s1">;</span>
<a name="l235"><span class="ln">235  </span></a>    <span class="s2">Object</span><span class="s1">.</span><span class="s2">keys</span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">aliases</span><span class="s1">).</span><span class="s2">forEach</span><span class="s1">(</span><span class="s3">function </span><span class="s1">(</span><span class="s2">alias</span><span class="s1">) {</span>
<a name="l236"><span class="ln">236  </span></a>      <span class="s3">var </span><span class="s2">node </span><span class="s1">= </span><span class="s2">_this</span><span class="s1">.</span><span class="s2">aliases</span><span class="s1">[</span><span class="s2">alias</span><span class="s1">];</span>
<a name="l237"><span class="ln">237  </span></a>      <span class="s3">if </span><span class="s1">(</span><span class="s2">node</span><span class="s1">.</span><span class="s2">children </span><span class="s1">&amp;&amp; </span><span class="s2">node</span><span class="s1">.</span><span class="s2">referenceCount </span><span class="s1">&gt; </span><span class="s5">1</span><span class="s1">) {</span>
<a name="l238"><span class="ln">238  </span></a>        <span class="s2">varDeclarations </span><span class="s1">+= </span><span class="s0">', alias' </span><span class="s1">+ ++</span><span class="s2">aliasCount </span><span class="s1">+ </span><span class="s0">'=' </span><span class="s1">+ </span><span class="s2">alias</span><span class="s1">;</span>
<a name="l239"><span class="ln">239  </span></a>        <span class="s2">node</span><span class="s1">.</span><span class="s2">children</span><span class="s1">[</span><span class="s5">0</span><span class="s1">] = </span><span class="s0">'alias' </span><span class="s1">+ </span><span class="s2">aliasCount</span><span class="s1">;</span>
<a name="l240"><span class="ln">240  </span></a>      <span class="s1">}</span>
<a name="l241"><span class="ln">241  </span></a>    <span class="s1">});</span>
<a name="l242"><span class="ln">242  </span></a>
<a name="l243"><span class="ln">243  </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">lookupPropertyFunctionIsUsed</span><span class="s1">) {</span>
<a name="l244"><span class="ln">244  </span></a>      <span class="s2">varDeclarations </span><span class="s1">+= </span><span class="s0">', ' </span><span class="s1">+ </span><span class="s3">this</span><span class="s1">.</span><span class="s2">lookupPropertyFunctionVarDeclaration</span><span class="s1">();</span>
<a name="l245"><span class="ln">245  </span></a>    <span class="s1">}</span>
<a name="l246"><span class="ln">246  </span></a>
<a name="l247"><span class="ln">247  </span></a>    <span class="s3">var </span><span class="s2">params </span><span class="s1">= [</span><span class="s0">'container'</span><span class="s1">, </span><span class="s0">'depth0'</span><span class="s1">, </span><span class="s0">'helpers'</span><span class="s1">, </span><span class="s0">'partials'</span><span class="s1">, </span><span class="s0">'data'</span><span class="s1">];</span>
<a name="l248"><span class="ln">248  </span></a>
<a name="l249"><span class="ln">249  </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">useBlockParams </span><span class="s1">|| </span><span class="s3">this</span><span class="s1">.</span><span class="s2">useDepths</span><span class="s1">) {</span>
<a name="l250"><span class="ln">250  </span></a>      <span class="s2">params</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s0">'blockParams'</span><span class="s1">);</span>
<a name="l251"><span class="ln">251  </span></a>    <span class="s1">}</span>
<a name="l252"><span class="ln">252  </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">useDepths</span><span class="s1">) {</span>
<a name="l253"><span class="ln">253  </span></a>      <span class="s2">params</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s0">'depths'</span><span class="s1">);</span>
<a name="l254"><span class="ln">254  </span></a>    <span class="s1">}</span>
<a name="l255"><span class="ln">255  </span></a>
<a name="l256"><span class="ln">256  </span></a>    <span class="s4">// Perform a second pass over the output to merge content when possible</span>
<a name="l257"><span class="ln">257  </span></a>    <span class="s3">var </span><span class="s2">source </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">mergeSource</span><span class="s1">(</span><span class="s2">varDeclarations</span><span class="s1">);</span>
<a name="l258"><span class="ln">258  </span></a>
<a name="l259"><span class="ln">259  </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s2">asObject</span><span class="s1">) {</span>
<a name="l260"><span class="ln">260  </span></a>      <span class="s2">params</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">source</span><span class="s1">);</span>
<a name="l261"><span class="ln">261  </span></a>
<a name="l262"><span class="ln">262  </span></a>      <span class="s3">return </span><span class="s2">Function</span><span class="s1">.</span><span class="s2">apply</span><span class="s1">(</span><span class="s3">this</span><span class="s1">, </span><span class="s2">params</span><span class="s1">);</span>
<a name="l263"><span class="ln">263  </span></a>    <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
<a name="l264"><span class="ln">264  </span></a>      <span class="s3">return this</span><span class="s1">.</span><span class="s2">source</span><span class="s1">.</span><span class="s2">wrap</span><span class="s1">([</span><span class="s0">'function('</span><span class="s1">, </span><span class="s2">params</span><span class="s1">.</span><span class="s2">join</span><span class="s1">(</span><span class="s0">','</span><span class="s1">), </span><span class="s0">') {</span><span class="s3">\n  </span><span class="s0">'</span><span class="s1">, </span><span class="s2">source</span><span class="s1">, </span><span class="s0">'}'</span><span class="s1">]);</span>
<a name="l265"><span class="ln">265  </span></a>    <span class="s1">}</span>
<a name="l266"><span class="ln">266  </span></a>  <span class="s1">},</span>
<a name="l267"><span class="ln">267  </span></a>  <span class="s2">mergeSource</span><span class="s1">: </span><span class="s3">function </span><span class="s2">mergeSource</span><span class="s1">(</span><span class="s2">varDeclarations</span><span class="s1">) {</span>
<a name="l268"><span class="ln">268  </span></a>    <span class="s3">var </span><span class="s2">isSimple </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">environment</span><span class="s1">.</span><span class="s2">isSimple</span><span class="s1">,</span>
<a name="l269"><span class="ln">269  </span></a>        <span class="s2">appendOnly </span><span class="s1">= !</span><span class="s3">this</span><span class="s1">.</span><span class="s2">forceBuffer</span><span class="s1">,</span>
<a name="l270"><span class="ln">270  </span></a>        <span class="s2">appendFirst </span><span class="s1">= </span><span class="s2">undefined</span><span class="s1">,</span>
<a name="l271"><span class="ln">271  </span></a>        <span class="s2">sourceSeen </span><span class="s1">= </span><span class="s2">undefined</span><span class="s1">,</span>
<a name="l272"><span class="ln">272  </span></a>        <span class="s2">bufferStart </span><span class="s1">= </span><span class="s2">undefined</span><span class="s1">,</span>
<a name="l273"><span class="ln">273  </span></a>        <span class="s2">bufferEnd </span><span class="s1">= </span><span class="s2">undefined</span><span class="s1">;</span>
<a name="l274"><span class="ln">274  </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">source</span><span class="s1">.</span><span class="s2">each</span><span class="s1">(</span><span class="s3">function </span><span class="s1">(</span><span class="s2">line</span><span class="s1">) {</span>
<a name="l275"><span class="ln">275  </span></a>      <span class="s3">if </span><span class="s1">(</span><span class="s2">line</span><span class="s1">.</span><span class="s2">appendToBuffer</span><span class="s1">) {</span>
<a name="l276"><span class="ln">276  </span></a>        <span class="s3">if </span><span class="s1">(</span><span class="s2">bufferStart</span><span class="s1">) {</span>
<a name="l277"><span class="ln">277  </span></a>          <span class="s2">line</span><span class="s1">.</span><span class="s2">prepend</span><span class="s1">(</span><span class="s0">'  + '</span><span class="s1">);</span>
<a name="l278"><span class="ln">278  </span></a>        <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
<a name="l279"><span class="ln">279  </span></a>          <span class="s2">bufferStart </span><span class="s1">= </span><span class="s2">line</span><span class="s1">;</span>
<a name="l280"><span class="ln">280  </span></a>        <span class="s1">}</span>
<a name="l281"><span class="ln">281  </span></a>        <span class="s2">bufferEnd </span><span class="s1">= </span><span class="s2">line</span><span class="s1">;</span>
<a name="l282"><span class="ln">282  </span></a>      <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
<a name="l283"><span class="ln">283  </span></a>        <span class="s3">if </span><span class="s1">(</span><span class="s2">bufferStart</span><span class="s1">) {</span>
<a name="l284"><span class="ln">284  </span></a>          <span class="s3">if </span><span class="s1">(!</span><span class="s2">sourceSeen</span><span class="s1">) {</span>
<a name="l285"><span class="ln">285  </span></a>            <span class="s2">appendFirst </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
<a name="l286"><span class="ln">286  </span></a>          <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
<a name="l287"><span class="ln">287  </span></a>            <span class="s2">bufferStart</span><span class="s1">.</span><span class="s2">prepend</span><span class="s1">(</span><span class="s0">'buffer += '</span><span class="s1">);</span>
<a name="l288"><span class="ln">288  </span></a>          <span class="s1">}</span>
<a name="l289"><span class="ln">289  </span></a>          <span class="s2">bufferEnd</span><span class="s1">.</span><span class="s2">add</span><span class="s1">(</span><span class="s0">';'</span><span class="s1">);</span>
<a name="l290"><span class="ln">290  </span></a>          <span class="s2">bufferStart </span><span class="s1">= </span><span class="s2">bufferEnd </span><span class="s1">= </span><span class="s2">undefined</span><span class="s1">;</span>
<a name="l291"><span class="ln">291  </span></a>        <span class="s1">}</span>
<a name="l292"><span class="ln">292  </span></a>
<a name="l293"><span class="ln">293  </span></a>        <span class="s2">sourceSeen </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
<a name="l294"><span class="ln">294  </span></a>        <span class="s3">if </span><span class="s1">(!</span><span class="s2">isSimple</span><span class="s1">) {</span>
<a name="l295"><span class="ln">295  </span></a>          <span class="s2">appendOnly </span><span class="s1">= </span><span class="s3">false</span><span class="s1">;</span>
<a name="l296"><span class="ln">296  </span></a>        <span class="s1">}</span>
<a name="l297"><span class="ln">297  </span></a>      <span class="s1">}</span>
<a name="l298"><span class="ln">298  </span></a>    <span class="s1">});</span>
<a name="l299"><span class="ln">299  </span></a>
<a name="l300"><span class="ln">300  </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s2">appendOnly</span><span class="s1">) {</span>
<a name="l301"><span class="ln">301  </span></a>      <span class="s3">if </span><span class="s1">(</span><span class="s2">bufferStart</span><span class="s1">) {</span>
<a name="l302"><span class="ln">302  </span></a>        <span class="s2">bufferStart</span><span class="s1">.</span><span class="s2">prepend</span><span class="s1">(</span><span class="s0">'return '</span><span class="s1">);</span>
<a name="l303"><span class="ln">303  </span></a>        <span class="s2">bufferEnd</span><span class="s1">.</span><span class="s2">add</span><span class="s1">(</span><span class="s0">';'</span><span class="s1">);</span>
<a name="l304"><span class="ln">304  </span></a>      <span class="s1">} </span><span class="s3">else if </span><span class="s1">(!</span><span class="s2">sourceSeen</span><span class="s1">) {</span>
<a name="l305"><span class="ln">305  </span></a>        <span class="s3">this</span><span class="s1">.</span><span class="s2">source</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s0">'return &quot;&quot;;'</span><span class="s1">);</span>
<a name="l306"><span class="ln">306  </span></a>      <span class="s1">}</span>
<a name="l307"><span class="ln">307  </span></a>    <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
<a name="l308"><span class="ln">308  </span></a>      <span class="s2">varDeclarations </span><span class="s1">+= </span><span class="s0">', buffer = ' </span><span class="s1">+ (</span><span class="s2">appendFirst </span><span class="s1">? </span><span class="s0">'' </span><span class="s1">: </span><span class="s3">this</span><span class="s1">.</span><span class="s2">initializeBuffer</span><span class="s1">());</span>
<a name="l309"><span class="ln">309  </span></a>
<a name="l310"><span class="ln">310  </span></a>      <span class="s3">if </span><span class="s1">(</span><span class="s2">bufferStart</span><span class="s1">) {</span>
<a name="l311"><span class="ln">311  </span></a>        <span class="s2">bufferStart</span><span class="s1">.</span><span class="s2">prepend</span><span class="s1">(</span><span class="s0">'return buffer + '</span><span class="s1">);</span>
<a name="l312"><span class="ln">312  </span></a>        <span class="s2">bufferEnd</span><span class="s1">.</span><span class="s2">add</span><span class="s1">(</span><span class="s0">';'</span><span class="s1">);</span>
<a name="l313"><span class="ln">313  </span></a>      <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
<a name="l314"><span class="ln">314  </span></a>        <span class="s3">this</span><span class="s1">.</span><span class="s2">source</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s0">'return buffer;'</span><span class="s1">);</span>
<a name="l315"><span class="ln">315  </span></a>      <span class="s1">}</span>
<a name="l316"><span class="ln">316  </span></a>    <span class="s1">}</span>
<a name="l317"><span class="ln">317  </span></a>
<a name="l318"><span class="ln">318  </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s2">varDeclarations</span><span class="s1">) {</span>
<a name="l319"><span class="ln">319  </span></a>      <span class="s3">this</span><span class="s1">.</span><span class="s2">source</span><span class="s1">.</span><span class="s2">prepend</span><span class="s1">(</span><span class="s0">'var ' </span><span class="s1">+ </span><span class="s2">varDeclarations</span><span class="s1">.</span><span class="s2">substring</span><span class="s1">(</span><span class="s5">2</span><span class="s1">) + (</span><span class="s2">appendFirst </span><span class="s1">? </span><span class="s0">'' </span><span class="s1">: </span><span class="s0">';</span><span class="s3">\n</span><span class="s0">'</span><span class="s1">));</span>
<a name="l320"><span class="ln">320  </span></a>    <span class="s1">}</span>
<a name="l321"><span class="ln">321  </span></a>
<a name="l322"><span class="ln">322  </span></a>    <span class="s3">return this</span><span class="s1">.</span><span class="s2">source</span><span class="s1">.</span><span class="s2">merge</span><span class="s1">();</span>
<a name="l323"><span class="ln">323  </span></a>  <span class="s1">},</span>
<a name="l324"><span class="ln">324  </span></a>
<a name="l325"><span class="ln">325  </span></a>  <span class="s2">lookupPropertyFunctionVarDeclaration</span><span class="s1">: </span><span class="s3">function </span><span class="s2">lookupPropertyFunctionVarDeclaration</span><span class="s1">() {</span>
<a name="l326"><span class="ln">326  </span></a>    <span class="s3">return </span><span class="s0">'</span><span class="s3">\n      </span><span class="s0">lookupProperty = container.lookupProperty || function(parent, propertyName) {</span><span class="s3">\n        </span><span class="s0">if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {</span><span class="s3">\n          </span><span class="s0">return parent[propertyName];</span><span class="s3">\n        </span><span class="s0">}</span><span class="s3">\n        </span><span class="s0">return undefined</span><span class="s3">\n    </span><span class="s0">}</span><span class="s3">\n    </span><span class="s0">'</span><span class="s1">.</span><span class="s2">trim</span><span class="s1">();</span>
<a name="l327"><span class="ln">327  </span></a>  <span class="s1">},</span>
<a name="l328"><span class="ln">328  </span></a>
<a name="l329"><span class="ln">329  </span></a>  <span class="s4">// [blockValue]</span>
<a name="l330"><span class="ln">330  </span></a>  <span class="s4">//</span>
<a name="l331"><span class="ln">331  </span></a>  <span class="s4">// On stack, before: hash, inverse, program, value</span>
<a name="l332"><span class="ln">332  </span></a>  <span class="s4">// On stack, after: return value of blockHelperMissing</span>
<a name="l333"><span class="ln">333  </span></a>  <span class="s4">//</span>
<a name="l334"><span class="ln">334  </span></a>  <span class="s4">// The purpose of this opcode is to take a block of the form</span>
<a name="l335"><span class="ln">335  </span></a>  <span class="s4">// `{{#this.foo}}...{{/this.foo}}`, resolve the value of `foo`, and</span>
<a name="l336"><span class="ln">336  </span></a>  <span class="s4">// replace it on the stack with the result of properly</span>
<a name="l337"><span class="ln">337  </span></a>  <span class="s4">// invoking blockHelperMissing.</span>
<a name="l338"><span class="ln">338  </span></a>  <span class="s2">blockValue</span><span class="s1">: </span><span class="s3">function </span><span class="s2">blockValue</span><span class="s1">(</span><span class="s2">name</span><span class="s1">) {</span>
<a name="l339"><span class="ln">339  </span></a>    <span class="s3">var </span><span class="s2">blockHelperMissing </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">aliasable</span><span class="s1">(</span><span class="s0">'container.hooks.blockHelperMissing'</span><span class="s1">),</span>
<a name="l340"><span class="ln">340  </span></a>        <span class="s2">params </span><span class="s1">= [</span><span class="s3">this</span><span class="s1">.</span><span class="s2">contextName</span><span class="s1">(</span><span class="s5">0</span><span class="s1">)];</span>
<a name="l341"><span class="ln">341  </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">setupHelperArgs</span><span class="s1">(</span><span class="s2">name</span><span class="s1">, </span><span class="s5">0</span><span class="s1">, </span><span class="s2">params</span><span class="s1">);</span>
<a name="l342"><span class="ln">342  </span></a>
<a name="l343"><span class="ln">343  </span></a>    <span class="s3">var </span><span class="s2">blockName </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">popStack</span><span class="s1">();</span>
<a name="l344"><span class="ln">344  </span></a>    <span class="s2">params</span><span class="s1">.</span><span class="s2">splice</span><span class="s1">(</span><span class="s5">1</span><span class="s1">, </span><span class="s5">0</span><span class="s1">, </span><span class="s2">blockName</span><span class="s1">);</span>
<a name="l345"><span class="ln">345  </span></a>
<a name="l346"><span class="ln">346  </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">source</span><span class="s1">.</span><span class="s2">functionCall</span><span class="s1">(</span><span class="s2">blockHelperMissing</span><span class="s1">, </span><span class="s0">'call'</span><span class="s1">, </span><span class="s2">params</span><span class="s1">));</span>
<a name="l347"><span class="ln">347  </span></a>  <span class="s1">},</span>
<a name="l348"><span class="ln">348  </span></a>
<a name="l349"><span class="ln">349  </span></a>  <span class="s4">// [ambiguousBlockValue]</span>
<a name="l350"><span class="ln">350  </span></a>  <span class="s4">//</span>
<a name="l351"><span class="ln">351  </span></a>  <span class="s4">// On stack, before: hash, inverse, program, value</span>
<a name="l352"><span class="ln">352  </span></a>  <span class="s4">// Compiler value, before: lastHelper=value of last found helper, if any</span>
<a name="l353"><span class="ln">353  </span></a>  <span class="s4">// On stack, after, if no lastHelper: same as [blockValue]</span>
<a name="l354"><span class="ln">354  </span></a>  <span class="s4">// On stack, after, if lastHelper: value</span>
<a name="l355"><span class="ln">355  </span></a>  <span class="s2">ambiguousBlockValue</span><span class="s1">: </span><span class="s3">function </span><span class="s2">ambiguousBlockValue</span><span class="s1">() {</span>
<a name="l356"><span class="ln">356  </span></a>    <span class="s4">// We're being a bit cheeky and reusing the options value from the prior exec</span>
<a name="l357"><span class="ln">357  </span></a>    <span class="s3">var </span><span class="s2">blockHelperMissing </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">aliasable</span><span class="s1">(</span><span class="s0">'container.hooks.blockHelperMissing'</span><span class="s1">),</span>
<a name="l358"><span class="ln">358  </span></a>        <span class="s2">params </span><span class="s1">= [</span><span class="s3">this</span><span class="s1">.</span><span class="s2">contextName</span><span class="s1">(</span><span class="s5">0</span><span class="s1">)];</span>
<a name="l359"><span class="ln">359  </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">setupHelperArgs</span><span class="s1">(</span><span class="s0">''</span><span class="s1">, </span><span class="s5">0</span><span class="s1">, </span><span class="s2">params</span><span class="s1">, </span><span class="s3">true</span><span class="s1">);</span>
<a name="l360"><span class="ln">360  </span></a>
<a name="l361"><span class="ln">361  </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">flushInline</span><span class="s1">();</span>
<a name="l362"><span class="ln">362  </span></a>
<a name="l363"><span class="ln">363  </span></a>    <span class="s3">var </span><span class="s2">current </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">topStack</span><span class="s1">();</span>
<a name="l364"><span class="ln">364  </span></a>    <span class="s2">params</span><span class="s1">.</span><span class="s2">splice</span><span class="s1">(</span><span class="s5">1</span><span class="s1">, </span><span class="s5">0</span><span class="s1">, </span><span class="s2">current</span><span class="s1">);</span>
<a name="l365"><span class="ln">365  </span></a>
<a name="l366"><span class="ln">366  </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">pushSource</span><span class="s1">([</span><span class="s0">'if (!'</span><span class="s1">, </span><span class="s3">this</span><span class="s1">.</span><span class="s2">lastHelper</span><span class="s1">, </span><span class="s0">') { '</span><span class="s1">, </span><span class="s2">current</span><span class="s1">, </span><span class="s0">' = '</span><span class="s1">, </span><span class="s3">this</span><span class="s1">.</span><span class="s2">source</span><span class="s1">.</span><span class="s2">functionCall</span><span class="s1">(</span><span class="s2">blockHelperMissing</span><span class="s1">, </span><span class="s0">'call'</span><span class="s1">, </span><span class="s2">params</span><span class="s1">), </span><span class="s0">'}'</span><span class="s1">]);</span>
<a name="l367"><span class="ln">367  </span></a>  <span class="s1">},</span>
<a name="l368"><span class="ln">368  </span></a>
<a name="l369"><span class="ln">369  </span></a>  <span class="s4">// [appendContent]</span>
<a name="l370"><span class="ln">370  </span></a>  <span class="s4">//</span>
<a name="l371"><span class="ln">371  </span></a>  <span class="s4">// On stack, before: ...</span>
<a name="l372"><span class="ln">372  </span></a>  <span class="s4">// On stack, after: ...</span>
<a name="l373"><span class="ln">373  </span></a>  <span class="s4">//</span>
<a name="l374"><span class="ln">374  </span></a>  <span class="s4">// Appends the string value of `content` to the current buffer</span>
<a name="l375"><span class="ln">375  </span></a>  <span class="s2">appendContent</span><span class="s1">: </span><span class="s3">function </span><span class="s2">appendContent</span><span class="s1">(</span><span class="s2">content</span><span class="s1">) {</span>
<a name="l376"><span class="ln">376  </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">pendingContent</span><span class="s1">) {</span>
<a name="l377"><span class="ln">377  </span></a>      <span class="s2">content </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">pendingContent </span><span class="s1">+ </span><span class="s2">content</span><span class="s1">;</span>
<a name="l378"><span class="ln">378  </span></a>    <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
<a name="l379"><span class="ln">379  </span></a>      <span class="s3">this</span><span class="s1">.</span><span class="s2">pendingLocation </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">source</span><span class="s1">.</span><span class="s2">currentLocation</span><span class="s1">;</span>
<a name="l380"><span class="ln">380  </span></a>    <span class="s1">}</span>
<a name="l381"><span class="ln">381  </span></a>
<a name="l382"><span class="ln">382  </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">pendingContent </span><span class="s1">= </span><span class="s2">content</span><span class="s1">;</span>
<a name="l383"><span class="ln">383  </span></a>  <span class="s1">},</span>
<a name="l384"><span class="ln">384  </span></a>
<a name="l385"><span class="ln">385  </span></a>  <span class="s4">// [append]</span>
<a name="l386"><span class="ln">386  </span></a>  <span class="s4">//</span>
<a name="l387"><span class="ln">387  </span></a>  <span class="s4">// On stack, before: value, ...</span>
<a name="l388"><span class="ln">388  </span></a>  <span class="s4">// On stack, after: ...</span>
<a name="l389"><span class="ln">389  </span></a>  <span class="s4">//</span>
<a name="l390"><span class="ln">390  </span></a>  <span class="s4">// Coerces `value` to a String and appends it to the current buffer.</span>
<a name="l391"><span class="ln">391  </span></a>  <span class="s4">//</span>
<a name="l392"><span class="ln">392  </span></a>  <span class="s4">// If `value` is truthy, or 0, it is coerced into a string and appended</span>
<a name="l393"><span class="ln">393  </span></a>  <span class="s4">// Otherwise, the empty string is appended</span>
<a name="l394"><span class="ln">394  </span></a>  <span class="s2">append</span><span class="s1">: </span><span class="s3">function </span><span class="s2">append</span><span class="s1">() {</span>
<a name="l395"><span class="ln">395  </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">isInline</span><span class="s1">()) {</span>
<a name="l396"><span class="ln">396  </span></a>      <span class="s3">this</span><span class="s1">.</span><span class="s2">replaceStack</span><span class="s1">(</span><span class="s3">function </span><span class="s1">(</span><span class="s2">current</span><span class="s1">) {</span>
<a name="l397"><span class="ln">397  </span></a>        <span class="s3">return </span><span class="s1">[</span><span class="s0">' != null ? '</span><span class="s1">, </span><span class="s2">current</span><span class="s1">, </span><span class="s0">' : &quot;&quot;'</span><span class="s1">];</span>
<a name="l398"><span class="ln">398  </span></a>      <span class="s1">});</span>
<a name="l399"><span class="ln">399  </span></a>
<a name="l400"><span class="ln">400  </span></a>      <span class="s3">this</span><span class="s1">.</span><span class="s2">pushSource</span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">appendToBuffer</span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">popStack</span><span class="s1">()));</span>
<a name="l401"><span class="ln">401  </span></a>    <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
<a name="l402"><span class="ln">402  </span></a>      <span class="s3">var </span><span class="s2">local </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">popStack</span><span class="s1">();</span>
<a name="l403"><span class="ln">403  </span></a>      <span class="s3">this</span><span class="s1">.</span><span class="s2">pushSource</span><span class="s1">([</span><span class="s0">'if ('</span><span class="s1">, </span><span class="s2">local</span><span class="s1">, </span><span class="s0">' != null) { '</span><span class="s1">, </span><span class="s3">this</span><span class="s1">.</span><span class="s2">appendToBuffer</span><span class="s1">(</span><span class="s2">local</span><span class="s1">, </span><span class="s2">undefined</span><span class="s1">, </span><span class="s3">true</span><span class="s1">), </span><span class="s0">' }'</span><span class="s1">]);</span>
<a name="l404"><span class="ln">404  </span></a>      <span class="s3">if </span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">environment</span><span class="s1">.</span><span class="s2">isSimple</span><span class="s1">) {</span>
<a name="l405"><span class="ln">405  </span></a>        <span class="s3">this</span><span class="s1">.</span><span class="s2">pushSource</span><span class="s1">([</span><span class="s0">'else { '</span><span class="s1">, </span><span class="s3">this</span><span class="s1">.</span><span class="s2">appendToBuffer</span><span class="s1">(</span><span class="s0">&quot;''&quot;</span><span class="s1">, </span><span class="s2">undefined</span><span class="s1">, </span><span class="s3">true</span><span class="s1">), </span><span class="s0">' }'</span><span class="s1">]);</span>
<a name="l406"><span class="ln">406  </span></a>      <span class="s1">}</span>
<a name="l407"><span class="ln">407  </span></a>    <span class="s1">}</span>
<a name="l408"><span class="ln">408  </span></a>  <span class="s1">},</span>
<a name="l409"><span class="ln">409  </span></a>
<a name="l410"><span class="ln">410  </span></a>  <span class="s4">// [appendEscaped]</span>
<a name="l411"><span class="ln">411  </span></a>  <span class="s4">//</span>
<a name="l412"><span class="ln">412  </span></a>  <span class="s4">// On stack, before: value, ...</span>
<a name="l413"><span class="ln">413  </span></a>  <span class="s4">// On stack, after: ...</span>
<a name="l414"><span class="ln">414  </span></a>  <span class="s4">//</span>
<a name="l415"><span class="ln">415  </span></a>  <span class="s4">// Escape `value` and append it to the buffer</span>
<a name="l416"><span class="ln">416  </span></a>  <span class="s2">appendEscaped</span><span class="s1">: </span><span class="s3">function </span><span class="s2">appendEscaped</span><span class="s1">() {</span>
<a name="l417"><span class="ln">417  </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">pushSource</span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">appendToBuffer</span><span class="s1">([</span><span class="s3">this</span><span class="s1">.</span><span class="s2">aliasable</span><span class="s1">(</span><span class="s0">'container.escapeExpression'</span><span class="s1">), </span><span class="s0">'('</span><span class="s1">, </span><span class="s3">this</span><span class="s1">.</span><span class="s2">popStack</span><span class="s1">(), </span><span class="s0">')'</span><span class="s1">]));</span>
<a name="l418"><span class="ln">418  </span></a>  <span class="s1">},</span>
<a name="l419"><span class="ln">419  </span></a>
<a name="l420"><span class="ln">420  </span></a>  <span class="s4">// [getContext]</span>
<a name="l421"><span class="ln">421  </span></a>  <span class="s4">//</span>
<a name="l422"><span class="ln">422  </span></a>  <span class="s4">// On stack, before: ...</span>
<a name="l423"><span class="ln">423  </span></a>  <span class="s4">// On stack, after: ...</span>
<a name="l424"><span class="ln">424  </span></a>  <span class="s4">// Compiler value, after: lastContext=depth</span>
<a name="l425"><span class="ln">425  </span></a>  <span class="s4">//</span>
<a name="l426"><span class="ln">426  </span></a>  <span class="s4">// Set the value of the `lastContext` compiler value to the depth</span>
<a name="l427"><span class="ln">427  </span></a>  <span class="s2">getContext</span><span class="s1">: </span><span class="s3">function </span><span class="s2">getContext</span><span class="s1">(</span><span class="s2">depth</span><span class="s1">) {</span>
<a name="l428"><span class="ln">428  </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">lastContext </span><span class="s1">= </span><span class="s2">depth</span><span class="s1">;</span>
<a name="l429"><span class="ln">429  </span></a>  <span class="s1">},</span>
<a name="l430"><span class="ln">430  </span></a>
<a name="l431"><span class="ln">431  </span></a>  <span class="s4">// [pushContext]</span>
<a name="l432"><span class="ln">432  </span></a>  <span class="s4">//</span>
<a name="l433"><span class="ln">433  </span></a>  <span class="s4">// On stack, before: ...</span>
<a name="l434"><span class="ln">434  </span></a>  <span class="s4">// On stack, after: currentContext, ...</span>
<a name="l435"><span class="ln">435  </span></a>  <span class="s4">//</span>
<a name="l436"><span class="ln">436  </span></a>  <span class="s4">// Pushes the value of the current context onto the stack.</span>
<a name="l437"><span class="ln">437  </span></a>  <span class="s2">pushContext</span><span class="s1">: </span><span class="s3">function </span><span class="s2">pushContext</span><span class="s1">() {</span>
<a name="l438"><span class="ln">438  </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">pushStackLiteral</span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">contextName</span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">lastContext</span><span class="s1">));</span>
<a name="l439"><span class="ln">439  </span></a>  <span class="s1">},</span>
<a name="l440"><span class="ln">440  </span></a>
<a name="l441"><span class="ln">441  </span></a>  <span class="s4">// [lookupOnContext]</span>
<a name="l442"><span class="ln">442  </span></a>  <span class="s4">//</span>
<a name="l443"><span class="ln">443  </span></a>  <span class="s4">// On stack, before: ...</span>
<a name="l444"><span class="ln">444  </span></a>  <span class="s4">// On stack, after: currentContext[name], ...</span>
<a name="l445"><span class="ln">445  </span></a>  <span class="s4">//</span>
<a name="l446"><span class="ln">446  </span></a>  <span class="s4">// Looks up the value of `name` on the current context and pushes</span>
<a name="l447"><span class="ln">447  </span></a>  <span class="s4">// it onto the stack.</span>
<a name="l448"><span class="ln">448  </span></a>  <span class="s2">lookupOnContext</span><span class="s1">: </span><span class="s3">function </span><span class="s2">lookupOnContext</span><span class="s1">(</span><span class="s2">parts</span><span class="s1">, </span><span class="s2">falsy</span><span class="s1">, </span><span class="s2">strict</span><span class="s1">, </span><span class="s2">scoped</span><span class="s1">) {</span>
<a name="l449"><span class="ln">449  </span></a>    <span class="s3">var </span><span class="s2">i </span><span class="s1">= </span><span class="s5">0</span><span class="s1">;</span>
<a name="l450"><span class="ln">450  </span></a>
<a name="l451"><span class="ln">451  </span></a>    <span class="s3">if </span><span class="s1">(!</span><span class="s2">scoped </span><span class="s1">&amp;&amp; </span><span class="s3">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">compat </span><span class="s1">&amp;&amp; !</span><span class="s3">this</span><span class="s1">.</span><span class="s2">lastContext</span><span class="s1">) {</span>
<a name="l452"><span class="ln">452  </span></a>      <span class="s4">// The depthed query is expected to handle the undefined logic for the root level that</span>
<a name="l453"><span class="ln">453  </span></a>      <span class="s4">// is implemented below, so we evaluate that directly in compat mode</span>
<a name="l454"><span class="ln">454  </span></a>      <span class="s3">this</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">depthedLookup</span><span class="s1">(</span><span class="s2">parts</span><span class="s1">[</span><span class="s2">i</span><span class="s1">++]));</span>
<a name="l455"><span class="ln">455  </span></a>    <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
<a name="l456"><span class="ln">456  </span></a>      <span class="s3">this</span><span class="s1">.</span><span class="s2">pushContext</span><span class="s1">();</span>
<a name="l457"><span class="ln">457  </span></a>    <span class="s1">}</span>
<a name="l458"><span class="ln">458  </span></a>
<a name="l459"><span class="ln">459  </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">resolvePath</span><span class="s1">(</span><span class="s0">'context'</span><span class="s1">, </span><span class="s2">parts</span><span class="s1">, </span><span class="s2">i</span><span class="s1">, </span><span class="s2">falsy</span><span class="s1">, </span><span class="s2">strict</span><span class="s1">);</span>
<a name="l460"><span class="ln">460  </span></a>  <span class="s1">},</span>
<a name="l461"><span class="ln">461  </span></a>
<a name="l462"><span class="ln">462  </span></a>  <span class="s4">// [lookupBlockParam]</span>
<a name="l463"><span class="ln">463  </span></a>  <span class="s4">//</span>
<a name="l464"><span class="ln">464  </span></a>  <span class="s4">// On stack, before: ...</span>
<a name="l465"><span class="ln">465  </span></a>  <span class="s4">// On stack, after: blockParam[name], ...</span>
<a name="l466"><span class="ln">466  </span></a>  <span class="s4">//</span>
<a name="l467"><span class="ln">467  </span></a>  <span class="s4">// Looks up the value of `parts` on the given block param and pushes</span>
<a name="l468"><span class="ln">468  </span></a>  <span class="s4">// it onto the stack.</span>
<a name="l469"><span class="ln">469  </span></a>  <span class="s2">lookupBlockParam</span><span class="s1">: </span><span class="s3">function </span><span class="s2">lookupBlockParam</span><span class="s1">(</span><span class="s2">blockParamId</span><span class="s1">, </span><span class="s2">parts</span><span class="s1">) {</span>
<a name="l470"><span class="ln">470  </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">useBlockParams </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
<a name="l471"><span class="ln">471  </span></a>
<a name="l472"><span class="ln">472  </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">push</span><span class="s1">([</span><span class="s0">'blockParams['</span><span class="s1">, </span><span class="s2">blockParamId</span><span class="s1">[</span><span class="s5">0</span><span class="s1">], </span><span class="s0">']['</span><span class="s1">, </span><span class="s2">blockParamId</span><span class="s1">[</span><span class="s5">1</span><span class="s1">], </span><span class="s0">']'</span><span class="s1">]);</span>
<a name="l473"><span class="ln">473  </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">resolvePath</span><span class="s1">(</span><span class="s0">'context'</span><span class="s1">, </span><span class="s2">parts</span><span class="s1">, </span><span class="s5">1</span><span class="s1">);</span>
<a name="l474"><span class="ln">474  </span></a>  <span class="s1">},</span>
<a name="l475"><span class="ln">475  </span></a>
<a name="l476"><span class="ln">476  </span></a>  <span class="s4">// [lookupData]</span>
<a name="l477"><span class="ln">477  </span></a>  <span class="s4">//</span>
<a name="l478"><span class="ln">478  </span></a>  <span class="s4">// On stack, before: ...</span>
<a name="l479"><span class="ln">479  </span></a>  <span class="s4">// On stack, after: data, ...</span>
<a name="l480"><span class="ln">480  </span></a>  <span class="s4">//</span>
<a name="l481"><span class="ln">481  </span></a>  <span class="s4">// Push the data lookup operator</span>
<a name="l482"><span class="ln">482  </span></a>  <span class="s2">lookupData</span><span class="s1">: </span><span class="s3">function </span><span class="s2">lookupData</span><span class="s1">(</span><span class="s2">depth</span><span class="s1">, </span><span class="s2">parts</span><span class="s1">, </span><span class="s2">strict</span><span class="s1">) {</span>
<a name="l483"><span class="ln">483  </span></a>    <span class="s3">if </span><span class="s1">(!</span><span class="s2">depth</span><span class="s1">) {</span>
<a name="l484"><span class="ln">484  </span></a>      <span class="s3">this</span><span class="s1">.</span><span class="s2">pushStackLiteral</span><span class="s1">(</span><span class="s0">'data'</span><span class="s1">);</span>
<a name="l485"><span class="ln">485  </span></a>    <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
<a name="l486"><span class="ln">486  </span></a>      <span class="s3">this</span><span class="s1">.</span><span class="s2">pushStackLiteral</span><span class="s1">(</span><span class="s0">'container.data(data, ' </span><span class="s1">+ </span><span class="s2">depth </span><span class="s1">+ </span><span class="s0">')'</span><span class="s1">);</span>
<a name="l487"><span class="ln">487  </span></a>    <span class="s1">}</span>
<a name="l488"><span class="ln">488  </span></a>
<a name="l489"><span class="ln">489  </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">resolvePath</span><span class="s1">(</span><span class="s0">'data'</span><span class="s1">, </span><span class="s2">parts</span><span class="s1">, </span><span class="s5">0</span><span class="s1">, </span><span class="s3">true</span><span class="s1">, </span><span class="s2">strict</span><span class="s1">);</span>
<a name="l490"><span class="ln">490  </span></a>  <span class="s1">},</span>
<a name="l491"><span class="ln">491  </span></a>
<a name="l492"><span class="ln">492  </span></a>  <span class="s2">resolvePath</span><span class="s1">: </span><span class="s3">function </span><span class="s2">resolvePath</span><span class="s1">(</span><span class="s2">type</span><span class="s1">, </span><span class="s2">parts</span><span class="s1">, </span><span class="s2">i</span><span class="s1">, </span><span class="s2">falsy</span><span class="s1">, </span><span class="s2">strict</span><span class="s1">) {</span>
<a name="l493"><span class="ln">493  </span></a>    <span class="s4">// istanbul ignore next</span>
<a name="l494"><span class="ln">494  </span></a>
<a name="l495"><span class="ln">495  </span></a>    <span class="s3">var </span><span class="s2">_this2 </span><span class="s1">= </span><span class="s3">this</span><span class="s1">;</span>
<a name="l496"><span class="ln">496  </span></a>
<a name="l497"><span class="ln">497  </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">strict </span><span class="s1">|| </span><span class="s3">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">assumeObjects</span><span class="s1">) {</span>
<a name="l498"><span class="ln">498  </span></a>      <span class="s3">this</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">strictLookup</span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">strict </span><span class="s1">&amp;&amp; </span><span class="s2">strict</span><span class="s1">, </span><span class="s3">this</span><span class="s1">, </span><span class="s2">parts</span><span class="s1">, </span><span class="s2">i</span><span class="s1">, </span><span class="s2">type</span><span class="s1">));</span>
<a name="l499"><span class="ln">499  </span></a>      <span class="s3">return</span><span class="s1">;</span>
<a name="l500"><span class="ln">500  </span></a>    <span class="s1">}</span>
<a name="l501"><span class="ln">501  </span></a>
<a name="l502"><span class="ln">502  </span></a>    <span class="s3">var </span><span class="s2">len </span><span class="s1">= </span><span class="s2">parts</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span>
<a name="l503"><span class="ln">503  </span></a>    <span class="s3">for </span><span class="s1">(; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">len</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
<a name="l504"><span class="ln">504  </span></a>      <span class="s4">/* eslint-disable no-loop-func */</span>
<a name="l505"><span class="ln">505  </span></a>      <span class="s3">this</span><span class="s1">.</span><span class="s2">replaceStack</span><span class="s1">(</span><span class="s3">function </span><span class="s1">(</span><span class="s2">current</span><span class="s1">) {</span>
<a name="l506"><span class="ln">506  </span></a>        <span class="s3">var </span><span class="s2">lookup </span><span class="s1">= </span><span class="s2">_this2</span><span class="s1">.</span><span class="s2">nameLookup</span><span class="s1">(</span><span class="s2">current</span><span class="s1">, </span><span class="s2">parts</span><span class="s1">[</span><span class="s2">i</span><span class="s1">], </span><span class="s2">type</span><span class="s1">);</span>
<a name="l507"><span class="ln">507  </span></a>        <span class="s4">// We want to ensure that zero and false are handled properly if the context (falsy flag)</span>
<a name="l508"><span class="ln">508  </span></a>        <span class="s4">// needs to have the special handling for these values.</span>
<a name="l509"><span class="ln">509  </span></a>        <span class="s3">if </span><span class="s1">(!</span><span class="s2">falsy</span><span class="s1">) {</span>
<a name="l510"><span class="ln">510  </span></a>          <span class="s3">return </span><span class="s1">[</span><span class="s0">' != null ? '</span><span class="s1">, </span><span class="s2">lookup</span><span class="s1">, </span><span class="s0">' : '</span><span class="s1">, </span><span class="s2">current</span><span class="s1">];</span>
<a name="l511"><span class="ln">511  </span></a>        <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
<a name="l512"><span class="ln">512  </span></a>          <span class="s4">// Otherwise we can use generic falsy handling</span>
<a name="l513"><span class="ln">513  </span></a>          <span class="s3">return </span><span class="s1">[</span><span class="s0">' &amp;&amp; '</span><span class="s1">, </span><span class="s2">lookup</span><span class="s1">];</span>
<a name="l514"><span class="ln">514  </span></a>        <span class="s1">}</span>
<a name="l515"><span class="ln">515  </span></a>      <span class="s1">});</span>
<a name="l516"><span class="ln">516  </span></a>      <span class="s4">/* eslint-enable no-loop-func */</span>
<a name="l517"><span class="ln">517  </span></a>    <span class="s1">}</span>
<a name="l518"><span class="ln">518  </span></a>  <span class="s1">},</span>
<a name="l519"><span class="ln">519  </span></a>
<a name="l520"><span class="ln">520  </span></a>  <span class="s4">// [resolvePossibleLambda]</span>
<a name="l521"><span class="ln">521  </span></a>  <span class="s4">//</span>
<a name="l522"><span class="ln">522  </span></a>  <span class="s4">// On stack, before: value, ...</span>
<a name="l523"><span class="ln">523  </span></a>  <span class="s4">// On stack, after: resolved value, ...</span>
<a name="l524"><span class="ln">524  </span></a>  <span class="s4">//</span>
<a name="l525"><span class="ln">525  </span></a>  <span class="s4">// If the `value` is a lambda, replace it on the stack by</span>
<a name="l526"><span class="ln">526  </span></a>  <span class="s4">// the return value of the lambda</span>
<a name="l527"><span class="ln">527  </span></a>  <span class="s2">resolvePossibleLambda</span><span class="s1">: </span><span class="s3">function </span><span class="s2">resolvePossibleLambda</span><span class="s1">() {</span>
<a name="l528"><span class="ln">528  </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">push</span><span class="s1">([</span><span class="s3">this</span><span class="s1">.</span><span class="s2">aliasable</span><span class="s1">(</span><span class="s0">'container.lambda'</span><span class="s1">), </span><span class="s0">'('</span><span class="s1">, </span><span class="s3">this</span><span class="s1">.</span><span class="s2">popStack</span><span class="s1">(), </span><span class="s0">', '</span><span class="s1">, </span><span class="s3">this</span><span class="s1">.</span><span class="s2">contextName</span><span class="s1">(</span><span class="s5">0</span><span class="s1">), </span><span class="s0">')'</span><span class="s1">]);</span>
<a name="l529"><span class="ln">529  </span></a>  <span class="s1">},</span>
<a name="l530"><span class="ln">530  </span></a>
<a name="l531"><span class="ln">531  </span></a>  <span class="s4">// [pushStringParam]</span>
<a name="l532"><span class="ln">532  </span></a>  <span class="s4">//</span>
<a name="l533"><span class="ln">533  </span></a>  <span class="s4">// On stack, before: ...</span>
<a name="l534"><span class="ln">534  </span></a>  <span class="s4">// On stack, after: string, currentContext, ...</span>
<a name="l535"><span class="ln">535  </span></a>  <span class="s4">//</span>
<a name="l536"><span class="ln">536  </span></a>  <span class="s4">// This opcode is designed for use in string mode, which</span>
<a name="l537"><span class="ln">537  </span></a>  <span class="s4">// provides the string value of a parameter along with its</span>
<a name="l538"><span class="ln">538  </span></a>  <span class="s4">// depth rather than resolving it immediately.</span>
<a name="l539"><span class="ln">539  </span></a>  <span class="s2">pushStringParam</span><span class="s1">: </span><span class="s3">function </span><span class="s2">pushStringParam</span><span class="s1">(</span><span class="s2">string</span><span class="s1">, </span><span class="s2">type</span><span class="s1">) {</span>
<a name="l540"><span class="ln">540  </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">pushContext</span><span class="s1">();</span>
<a name="l541"><span class="ln">541  </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">pushString</span><span class="s1">(</span><span class="s2">type</span><span class="s1">);</span>
<a name="l542"><span class="ln">542  </span></a>
<a name="l543"><span class="ln">543  </span></a>    <span class="s4">// If it's a subexpression, the string result</span>
<a name="l544"><span class="ln">544  </span></a>    <span class="s4">// will be pushed after this opcode.</span>
<a name="l545"><span class="ln">545  </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s2">type </span><span class="s1">!== </span><span class="s0">'SubExpression'</span><span class="s1">) {</span>
<a name="l546"><span class="ln">546  </span></a>      <span class="s3">if </span><span class="s1">(</span><span class="s3">typeof </span><span class="s2">string </span><span class="s1">=== </span><span class="s0">'string'</span><span class="s1">) {</span>
<a name="l547"><span class="ln">547  </span></a>        <span class="s3">this</span><span class="s1">.</span><span class="s2">pushString</span><span class="s1">(</span><span class="s2">string</span><span class="s1">);</span>
<a name="l548"><span class="ln">548  </span></a>      <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
<a name="l549"><span class="ln">549  </span></a>        <span class="s3">this</span><span class="s1">.</span><span class="s2">pushStackLiteral</span><span class="s1">(</span><span class="s2">string</span><span class="s1">);</span>
<a name="l550"><span class="ln">550  </span></a>      <span class="s1">}</span>
<a name="l551"><span class="ln">551  </span></a>    <span class="s1">}</span>
<a name="l552"><span class="ln">552  </span></a>  <span class="s1">},</span>
<a name="l553"><span class="ln">553  </span></a>
<a name="l554"><span class="ln">554  </span></a>  <span class="s2">emptyHash</span><span class="s1">: </span><span class="s3">function </span><span class="s2">emptyHash</span><span class="s1">(</span><span class="s2">omitEmpty</span><span class="s1">) {</span>
<a name="l555"><span class="ln">555  </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">trackIds</span><span class="s1">) {</span>
<a name="l556"><span class="ln">556  </span></a>      <span class="s3">this</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s0">'{}'</span><span class="s1">); </span><span class="s4">// hashIds</span>
<a name="l557"><span class="ln">557  </span></a>    <span class="s1">}</span>
<a name="l558"><span class="ln">558  </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">stringParams</span><span class="s1">) {</span>
<a name="l559"><span class="ln">559  </span></a>      <span class="s3">this</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s0">'{}'</span><span class="s1">); </span><span class="s4">// hashContexts</span>
<a name="l560"><span class="ln">560  </span></a>      <span class="s3">this</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s0">'{}'</span><span class="s1">); </span><span class="s4">// hashTypes</span>
<a name="l561"><span class="ln">561  </span></a>    <span class="s1">}</span>
<a name="l562"><span class="ln">562  </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">pushStackLiteral</span><span class="s1">(</span><span class="s2">omitEmpty </span><span class="s1">? </span><span class="s0">'undefined' </span><span class="s1">: </span><span class="s0">'{}'</span><span class="s1">);</span>
<a name="l563"><span class="ln">563  </span></a>  <span class="s1">},</span>
<a name="l564"><span class="ln">564  </span></a>  <span class="s2">pushHash</span><span class="s1">: </span><span class="s3">function </span><span class="s2">pushHash</span><span class="s1">() {</span>
<a name="l565"><span class="ln">565  </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">hash</span><span class="s1">) {</span>
<a name="l566"><span class="ln">566  </span></a>      <span class="s3">this</span><span class="s1">.</span><span class="s2">hashes</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">hash</span><span class="s1">);</span>
<a name="l567"><span class="ln">567  </span></a>    <span class="s1">}</span>
<a name="l568"><span class="ln">568  </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">hash </span><span class="s1">= { </span><span class="s2">values</span><span class="s1">: {}, </span><span class="s2">types</span><span class="s1">: [], </span><span class="s2">contexts</span><span class="s1">: [], </span><span class="s2">ids</span><span class="s1">: [] };</span>
<a name="l569"><span class="ln">569  </span></a>  <span class="s1">},</span>
<a name="l570"><span class="ln">570  </span></a>  <span class="s2">popHash</span><span class="s1">: </span><span class="s3">function </span><span class="s2">popHash</span><span class="s1">() {</span>
<a name="l571"><span class="ln">571  </span></a>    <span class="s3">var </span><span class="s2">hash </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">hash</span><span class="s1">;</span>
<a name="l572"><span class="ln">572  </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">hash </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">hashes</span><span class="s1">.</span><span class="s2">pop</span><span class="s1">();</span>
<a name="l573"><span class="ln">573  </span></a>
<a name="l574"><span class="ln">574  </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">trackIds</span><span class="s1">) {</span>
<a name="l575"><span class="ln">575  </span></a>      <span class="s3">this</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">objectLiteral</span><span class="s1">(</span><span class="s2">hash</span><span class="s1">.</span><span class="s2">ids</span><span class="s1">));</span>
<a name="l576"><span class="ln">576  </span></a>    <span class="s1">}</span>
<a name="l577"><span class="ln">577  </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">stringParams</span><span class="s1">) {</span>
<a name="l578"><span class="ln">578  </span></a>      <span class="s3">this</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">objectLiteral</span><span class="s1">(</span><span class="s2">hash</span><span class="s1">.</span><span class="s2">contexts</span><span class="s1">));</span>
<a name="l579"><span class="ln">579  </span></a>      <span class="s3">this</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">objectLiteral</span><span class="s1">(</span><span class="s2">hash</span><span class="s1">.</span><span class="s2">types</span><span class="s1">));</span>
<a name="l580"><span class="ln">580  </span></a>    <span class="s1">}</span>
<a name="l581"><span class="ln">581  </span></a>
<a name="l582"><span class="ln">582  </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">objectLiteral</span><span class="s1">(</span><span class="s2">hash</span><span class="s1">.</span><span class="s2">values</span><span class="s1">));</span>
<a name="l583"><span class="ln">583  </span></a>  <span class="s1">},</span>
<a name="l584"><span class="ln">584  </span></a>
<a name="l585"><span class="ln">585  </span></a>  <span class="s4">// [pushString]</span>
<a name="l586"><span class="ln">586  </span></a>  <span class="s4">//</span>
<a name="l587"><span class="ln">587  </span></a>  <span class="s4">// On stack, before: ...</span>
<a name="l588"><span class="ln">588  </span></a>  <span class="s4">// On stack, after: quotedString(string), ...</span>
<a name="l589"><span class="ln">589  </span></a>  <span class="s4">//</span>
<a name="l590"><span class="ln">590  </span></a>  <span class="s4">// Push a quoted version of `string` onto the stack</span>
<a name="l591"><span class="ln">591  </span></a>  <span class="s2">pushString</span><span class="s1">: </span><span class="s3">function </span><span class="s2">pushString</span><span class="s1">(</span><span class="s2">string</span><span class="s1">) {</span>
<a name="l592"><span class="ln">592  </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">pushStackLiteral</span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">quotedString</span><span class="s1">(</span><span class="s2">string</span><span class="s1">));</span>
<a name="l593"><span class="ln">593  </span></a>  <span class="s1">},</span>
<a name="l594"><span class="ln">594  </span></a>
<a name="l595"><span class="ln">595  </span></a>  <span class="s4">// [pushLiteral]</span>
<a name="l596"><span class="ln">596  </span></a>  <span class="s4">//</span>
<a name="l597"><span class="ln">597  </span></a>  <span class="s4">// On stack, before: ...</span>
<a name="l598"><span class="ln">598  </span></a>  <span class="s4">// On stack, after: value, ...</span>
<a name="l599"><span class="ln">599  </span></a>  <span class="s4">//</span>
<a name="l600"><span class="ln">600  </span></a>  <span class="s4">// Pushes a value onto the stack. This operation prevents</span>
<a name="l601"><span class="ln">601  </span></a>  <span class="s4">// the compiler from creating a temporary variable to hold</span>
<a name="l602"><span class="ln">602  </span></a>  <span class="s4">// it.</span>
<a name="l603"><span class="ln">603  </span></a>  <span class="s2">pushLiteral</span><span class="s1">: </span><span class="s3">function </span><span class="s2">pushLiteral</span><span class="s1">(</span><span class="s2">value</span><span class="s1">) {</span>
<a name="l604"><span class="ln">604  </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">pushStackLiteral</span><span class="s1">(</span><span class="s2">value</span><span class="s1">);</span>
<a name="l605"><span class="ln">605  </span></a>  <span class="s1">},</span>
<a name="l606"><span class="ln">606  </span></a>
<a name="l607"><span class="ln">607  </span></a>  <span class="s4">// [pushProgram]</span>
<a name="l608"><span class="ln">608  </span></a>  <span class="s4">//</span>
<a name="l609"><span class="ln">609  </span></a>  <span class="s4">// On stack, before: ...</span>
<a name="l610"><span class="ln">610  </span></a>  <span class="s4">// On stack, after: program(guid), ...</span>
<a name="l611"><span class="ln">611  </span></a>  <span class="s4">//</span>
<a name="l612"><span class="ln">612  </span></a>  <span class="s4">// Push a program expression onto the stack. This takes</span>
<a name="l613"><span class="ln">613  </span></a>  <span class="s4">// a compile-time guid and converts it into a runtime-accessible</span>
<a name="l614"><span class="ln">614  </span></a>  <span class="s4">// expression.</span>
<a name="l615"><span class="ln">615  </span></a>  <span class="s2">pushProgram</span><span class="s1">: </span><span class="s3">function </span><span class="s2">pushProgram</span><span class="s1">(</span><span class="s2">guid</span><span class="s1">) {</span>
<a name="l616"><span class="ln">616  </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s2">guid </span><span class="s1">!= </span><span class="s3">null</span><span class="s1">) {</span>
<a name="l617"><span class="ln">617  </span></a>      <span class="s3">this</span><span class="s1">.</span><span class="s2">pushStackLiteral</span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">programExpression</span><span class="s1">(</span><span class="s2">guid</span><span class="s1">));</span>
<a name="l618"><span class="ln">618  </span></a>    <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
<a name="l619"><span class="ln">619  </span></a>      <span class="s3">this</span><span class="s1">.</span><span class="s2">pushStackLiteral</span><span class="s1">(</span><span class="s3">null</span><span class="s1">);</span>
<a name="l620"><span class="ln">620  </span></a>    <span class="s1">}</span>
<a name="l621"><span class="ln">621  </span></a>  <span class="s1">},</span>
<a name="l622"><span class="ln">622  </span></a>
<a name="l623"><span class="ln">623  </span></a>  <span class="s4">// [registerDecorator]</span>
<a name="l624"><span class="ln">624  </span></a>  <span class="s4">//</span>
<a name="l625"><span class="ln">625  </span></a>  <span class="s4">// On stack, before: hash, program, params..., ...</span>
<a name="l626"><span class="ln">626  </span></a>  <span class="s4">// On stack, after: ...</span>
<a name="l627"><span class="ln">627  </span></a>  <span class="s4">//</span>
<a name="l628"><span class="ln">628  </span></a>  <span class="s4">// Pops off the decorator's parameters, invokes the decorator,</span>
<a name="l629"><span class="ln">629  </span></a>  <span class="s4">// and inserts the decorator into the decorators list.</span>
<a name="l630"><span class="ln">630  </span></a>  <span class="s2">registerDecorator</span><span class="s1">: </span><span class="s3">function </span><span class="s2">registerDecorator</span><span class="s1">(</span><span class="s2">paramSize</span><span class="s1">, </span><span class="s2">name</span><span class="s1">) {</span>
<a name="l631"><span class="ln">631  </span></a>    <span class="s3">var </span><span class="s2">foundDecorator </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">nameLookup</span><span class="s1">(</span><span class="s0">'decorators'</span><span class="s1">, </span><span class="s2">name</span><span class="s1">, </span><span class="s0">'decorator'</span><span class="s1">),</span>
<a name="l632"><span class="ln">632  </span></a>        <span class="s2">options </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">setupHelperArgs</span><span class="s1">(</span><span class="s2">name</span><span class="s1">, </span><span class="s2">paramSize</span><span class="s1">);</span>
<a name="l633"><span class="ln">633  </span></a>
<a name="l634"><span class="ln">634  </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">decorators</span><span class="s1">.</span><span class="s2">push</span><span class="s1">([</span><span class="s0">'fn = '</span><span class="s1">, </span><span class="s3">this</span><span class="s1">.</span><span class="s2">decorators</span><span class="s1">.</span><span class="s2">functionCall</span><span class="s1">(</span><span class="s2">foundDecorator</span><span class="s1">, </span><span class="s0">''</span><span class="s1">, [</span><span class="s0">'fn'</span><span class="s1">, </span><span class="s0">'props'</span><span class="s1">, </span><span class="s0">'container'</span><span class="s1">, </span><span class="s2">options</span><span class="s1">]), </span><span class="s0">' || fn;'</span><span class="s1">]);</span>
<a name="l635"><span class="ln">635  </span></a>  <span class="s1">},</span>
<a name="l636"><span class="ln">636  </span></a>
<a name="l637"><span class="ln">637  </span></a>  <span class="s4">// [invokeHelper]</span>
<a name="l638"><span class="ln">638  </span></a>  <span class="s4">//</span>
<a name="l639"><span class="ln">639  </span></a>  <span class="s4">// On stack, before: hash, inverse, program, params..., ...</span>
<a name="l640"><span class="ln">640  </span></a>  <span class="s4">// On stack, after: result of helper invocation</span>
<a name="l641"><span class="ln">641  </span></a>  <span class="s4">//</span>
<a name="l642"><span class="ln">642  </span></a>  <span class="s4">// Pops off the helper's parameters, invokes the helper,</span>
<a name="l643"><span class="ln">643  </span></a>  <span class="s4">// and pushes the helper's return value onto the stack.</span>
<a name="l644"><span class="ln">644  </span></a>  <span class="s4">//</span>
<a name="l645"><span class="ln">645  </span></a>  <span class="s4">// If the helper is not found, `helperMissing` is called.</span>
<a name="l646"><span class="ln">646  </span></a>  <span class="s2">invokeHelper</span><span class="s1">: </span><span class="s3">function </span><span class="s2">invokeHelper</span><span class="s1">(</span><span class="s2">paramSize</span><span class="s1">, </span><span class="s2">name</span><span class="s1">, </span><span class="s2">isSimple</span><span class="s1">) {</span>
<a name="l647"><span class="ln">647  </span></a>    <span class="s3">var </span><span class="s2">nonHelper </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">popStack</span><span class="s1">(),</span>
<a name="l648"><span class="ln">648  </span></a>        <span class="s2">helper </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">setupHelper</span><span class="s1">(</span><span class="s2">paramSize</span><span class="s1">, </span><span class="s2">name</span><span class="s1">);</span>
<a name="l649"><span class="ln">649  </span></a>
<a name="l650"><span class="ln">650  </span></a>    <span class="s3">var </span><span class="s2">possibleFunctionCalls </span><span class="s1">= [];</span>
<a name="l651"><span class="ln">651  </span></a>
<a name="l652"><span class="ln">652  </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s2">isSimple</span><span class="s1">) {</span>
<a name="l653"><span class="ln">653  </span></a>      <span class="s4">// direct call to helper</span>
<a name="l654"><span class="ln">654  </span></a>      <span class="s2">possibleFunctionCalls</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">helper</span><span class="s1">.</span><span class="s2">name</span><span class="s1">);</span>
<a name="l655"><span class="ln">655  </span></a>    <span class="s1">}</span>
<a name="l656"><span class="ln">656  </span></a>    <span class="s4">// call a function from the input object</span>
<a name="l657"><span class="ln">657  </span></a>    <span class="s2">possibleFunctionCalls</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">nonHelper</span><span class="s1">);</span>
<a name="l658"><span class="ln">658  </span></a>    <span class="s3">if </span><span class="s1">(!</span><span class="s3">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">strict</span><span class="s1">) {</span>
<a name="l659"><span class="ln">659  </span></a>      <span class="s2">possibleFunctionCalls</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">aliasable</span><span class="s1">(</span><span class="s0">'container.hooks.helperMissing'</span><span class="s1">));</span>
<a name="l660"><span class="ln">660  </span></a>    <span class="s1">}</span>
<a name="l661"><span class="ln">661  </span></a>
<a name="l662"><span class="ln">662  </span></a>    <span class="s3">var </span><span class="s2">functionLookupCode </span><span class="s1">= [</span><span class="s0">'('</span><span class="s1">, </span><span class="s3">this</span><span class="s1">.</span><span class="s2">itemsSeparatedBy</span><span class="s1">(</span><span class="s2">possibleFunctionCalls</span><span class="s1">, </span><span class="s0">'||'</span><span class="s1">), </span><span class="s0">')'</span><span class="s1">];</span>
<a name="l663"><span class="ln">663  </span></a>    <span class="s3">var </span><span class="s2">functionCall </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">source</span><span class="s1">.</span><span class="s2">functionCall</span><span class="s1">(</span><span class="s2">functionLookupCode</span><span class="s1">, </span><span class="s0">'call'</span><span class="s1">, </span><span class="s2">helper</span><span class="s1">.</span><span class="s2">callParams</span><span class="s1">);</span>
<a name="l664"><span class="ln">664  </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">functionCall</span><span class="s1">);</span>
<a name="l665"><span class="ln">665  </span></a>  <span class="s1">},</span>
<a name="l666"><span class="ln">666  </span></a>
<a name="l667"><span class="ln">667  </span></a>  <span class="s2">itemsSeparatedBy</span><span class="s1">: </span><span class="s3">function </span><span class="s2">itemsSeparatedBy</span><span class="s1">(</span><span class="s2">items</span><span class="s1">, </span><span class="s2">separator</span><span class="s1">) {</span>
<a name="l668"><span class="ln">668  </span></a>    <span class="s3">var </span><span class="s2">result </span><span class="s1">= [];</span>
<a name="l669"><span class="ln">669  </span></a>    <span class="s2">result</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">items</span><span class="s1">[</span><span class="s5">0</span><span class="s1">]);</span>
<a name="l670"><span class="ln">670  </span></a>    <span class="s3">for </span><span class="s1">(</span><span class="s3">var </span><span class="s2">i </span><span class="s1">= </span><span class="s5">1</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">items</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
<a name="l671"><span class="ln">671  </span></a>      <span class="s2">result</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">separator</span><span class="s1">, </span><span class="s2">items</span><span class="s1">[</span><span class="s2">i</span><span class="s1">]);</span>
<a name="l672"><span class="ln">672  </span></a>    <span class="s1">}</span>
<a name="l673"><span class="ln">673  </span></a>    <span class="s3">return </span><span class="s2">result</span><span class="s1">;</span>
<a name="l674"><span class="ln">674  </span></a>  <span class="s1">},</span>
<a name="l675"><span class="ln">675  </span></a>  <span class="s4">// [invokeKnownHelper]</span>
<a name="l676"><span class="ln">676  </span></a>  <span class="s4">//</span>
<a name="l677"><span class="ln">677  </span></a>  <span class="s4">// On stack, before: hash, inverse, program, params..., ...</span>
<a name="l678"><span class="ln">678  </span></a>  <span class="s4">// On stack, after: result of helper invocation</span>
<a name="l679"><span class="ln">679  </span></a>  <span class="s4">//</span>
<a name="l680"><span class="ln">680  </span></a>  <span class="s4">// This operation is used when the helper is known to exist,</span>
<a name="l681"><span class="ln">681  </span></a>  <span class="s4">// so a `helperMissing` fallback is not required.</span>
<a name="l682"><span class="ln">682  </span></a>  <span class="s2">invokeKnownHelper</span><span class="s1">: </span><span class="s3">function </span><span class="s2">invokeKnownHelper</span><span class="s1">(</span><span class="s2">paramSize</span><span class="s1">, </span><span class="s2">name</span><span class="s1">) {</span>
<a name="l683"><span class="ln">683  </span></a>    <span class="s3">var </span><span class="s2">helper </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">setupHelper</span><span class="s1">(</span><span class="s2">paramSize</span><span class="s1">, </span><span class="s2">name</span><span class="s1">);</span>
<a name="l684"><span class="ln">684  </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">source</span><span class="s1">.</span><span class="s2">functionCall</span><span class="s1">(</span><span class="s2">helper</span><span class="s1">.</span><span class="s2">name</span><span class="s1">, </span><span class="s0">'call'</span><span class="s1">, </span><span class="s2">helper</span><span class="s1">.</span><span class="s2">callParams</span><span class="s1">));</span>
<a name="l685"><span class="ln">685  </span></a>  <span class="s1">},</span>
<a name="l686"><span class="ln">686  </span></a>
<a name="l687"><span class="ln">687  </span></a>  <span class="s4">// [invokeAmbiguous]</span>
<a name="l688"><span class="ln">688  </span></a>  <span class="s4">//</span>
<a name="l689"><span class="ln">689  </span></a>  <span class="s4">// On stack, before: hash, inverse, program, params..., ...</span>
<a name="l690"><span class="ln">690  </span></a>  <span class="s4">// On stack, after: result of disambiguation</span>
<a name="l691"><span class="ln">691  </span></a>  <span class="s4">//</span>
<a name="l692"><span class="ln">692  </span></a>  <span class="s4">// This operation is used when an expression like `{{foo}}`</span>
<a name="l693"><span class="ln">693  </span></a>  <span class="s4">// is provided, but we don't know at compile-time whether it</span>
<a name="l694"><span class="ln">694  </span></a>  <span class="s4">// is a helper or a path.</span>
<a name="l695"><span class="ln">695  </span></a>  <span class="s4">//</span>
<a name="l696"><span class="ln">696  </span></a>  <span class="s4">// This operation emits more code than the other options,</span>
<a name="l697"><span class="ln">697  </span></a>  <span class="s4">// and can be avoided by passing the `knownHelpers` and</span>
<a name="l698"><span class="ln">698  </span></a>  <span class="s4">// `knownHelpersOnly` flags at compile-time.</span>
<a name="l699"><span class="ln">699  </span></a>  <span class="s2">invokeAmbiguous</span><span class="s1">: </span><span class="s3">function </span><span class="s2">invokeAmbiguous</span><span class="s1">(</span><span class="s2">name</span><span class="s1">, </span><span class="s2">helperCall</span><span class="s1">) {</span>
<a name="l700"><span class="ln">700  </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">useRegister</span><span class="s1">(</span><span class="s0">'helper'</span><span class="s1">);</span>
<a name="l701"><span class="ln">701  </span></a>
<a name="l702"><span class="ln">702  </span></a>    <span class="s3">var </span><span class="s2">nonHelper </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">popStack</span><span class="s1">();</span>
<a name="l703"><span class="ln">703  </span></a>
<a name="l704"><span class="ln">704  </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">emptyHash</span><span class="s1">();</span>
<a name="l705"><span class="ln">705  </span></a>    <span class="s3">var </span><span class="s2">helper </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">setupHelper</span><span class="s1">(</span><span class="s5">0</span><span class="s1">, </span><span class="s2">name</span><span class="s1">, </span><span class="s2">helperCall</span><span class="s1">);</span>
<a name="l706"><span class="ln">706  </span></a>
<a name="l707"><span class="ln">707  </span></a>    <span class="s3">var </span><span class="s2">helperName </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">lastHelper </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">nameLookup</span><span class="s1">(</span><span class="s0">'helpers'</span><span class="s1">, </span><span class="s2">name</span><span class="s1">, </span><span class="s0">'helper'</span><span class="s1">);</span>
<a name="l708"><span class="ln">708  </span></a>
<a name="l709"><span class="ln">709  </span></a>    <span class="s3">var </span><span class="s2">lookup </span><span class="s1">= [</span><span class="s0">'('</span><span class="s1">, </span><span class="s0">'(helper = '</span><span class="s1">, </span><span class="s2">helperName</span><span class="s1">, </span><span class="s0">' || '</span><span class="s1">, </span><span class="s2">nonHelper</span><span class="s1">, </span><span class="s0">')'</span><span class="s1">];</span>
<a name="l710"><span class="ln">710  </span></a>    <span class="s3">if </span><span class="s1">(!</span><span class="s3">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">strict</span><span class="s1">) {</span>
<a name="l711"><span class="ln">711  </span></a>      <span class="s2">lookup</span><span class="s1">[</span><span class="s5">0</span><span class="s1">] = </span><span class="s0">'(helper = '</span><span class="s1">;</span>
<a name="l712"><span class="ln">712  </span></a>      <span class="s2">lookup</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s0">' != null ? helper : '</span><span class="s1">, </span><span class="s3">this</span><span class="s1">.</span><span class="s2">aliasable</span><span class="s1">(</span><span class="s0">'container.hooks.helperMissing'</span><span class="s1">));</span>
<a name="l713"><span class="ln">713  </span></a>    <span class="s1">}</span>
<a name="l714"><span class="ln">714  </span></a>
<a name="l715"><span class="ln">715  </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">push</span><span class="s1">([</span><span class="s0">'('</span><span class="s1">, </span><span class="s2">lookup</span><span class="s1">, </span><span class="s2">helper</span><span class="s1">.</span><span class="s2">paramsInit </span><span class="s1">? [</span><span class="s0">'),('</span><span class="s1">, </span><span class="s2">helper</span><span class="s1">.</span><span class="s2">paramsInit</span><span class="s1">] : [], </span><span class="s0">'),'</span><span class="s1">, </span><span class="s0">'(typeof helper === '</span><span class="s1">, </span><span class="s3">this</span><span class="s1">.</span><span class="s2">aliasable</span><span class="s1">(</span><span class="s0">'&quot;function&quot;'</span><span class="s1">), </span><span class="s0">' ? '</span><span class="s1">, </span><span class="s3">this</span><span class="s1">.</span><span class="s2">source</span><span class="s1">.</span><span class="s2">functionCall</span><span class="s1">(</span><span class="s0">'helper'</span><span class="s1">, </span><span class="s0">'call'</span><span class="s1">, </span><span class="s2">helper</span><span class="s1">.</span><span class="s2">callParams</span><span class="s1">), </span><span class="s0">' : helper))'</span><span class="s1">]);</span>
<a name="l716"><span class="ln">716  </span></a>  <span class="s1">},</span>
<a name="l717"><span class="ln">717  </span></a>
<a name="l718"><span class="ln">718  </span></a>  <span class="s4">// [invokePartial]</span>
<a name="l719"><span class="ln">719  </span></a>  <span class="s4">//</span>
<a name="l720"><span class="ln">720  </span></a>  <span class="s4">// On stack, before: context, ...</span>
<a name="l721"><span class="ln">721  </span></a>  <span class="s4">// On stack after: result of partial invocation</span>
<a name="l722"><span class="ln">722  </span></a>  <span class="s4">//</span>
<a name="l723"><span class="ln">723  </span></a>  <span class="s4">// This operation pops off a context, invokes a partial with that context,</span>
<a name="l724"><span class="ln">724  </span></a>  <span class="s4">// and pushes the result of the invocation back.</span>
<a name="l725"><span class="ln">725  </span></a>  <span class="s2">invokePartial</span><span class="s1">: </span><span class="s3">function </span><span class="s2">invokePartial</span><span class="s1">(</span><span class="s2">isDynamic</span><span class="s1">, </span><span class="s2">name</span><span class="s1">, </span><span class="s2">indent</span><span class="s1">) {</span>
<a name="l726"><span class="ln">726  </span></a>    <span class="s3">var </span><span class="s2">params </span><span class="s1">= [],</span>
<a name="l727"><span class="ln">727  </span></a>        <span class="s2">options </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">setupParams</span><span class="s1">(</span><span class="s2">name</span><span class="s1">, </span><span class="s5">1</span><span class="s1">, </span><span class="s2">params</span><span class="s1">);</span>
<a name="l728"><span class="ln">728  </span></a>
<a name="l729"><span class="ln">729  </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s2">isDynamic</span><span class="s1">) {</span>
<a name="l730"><span class="ln">730  </span></a>      <span class="s2">name </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">popStack</span><span class="s1">();</span>
<a name="l731"><span class="ln">731  </span></a>      <span class="s3">delete </span><span class="s2">options</span><span class="s1">.</span><span class="s2">name</span><span class="s1">;</span>
<a name="l732"><span class="ln">732  </span></a>    <span class="s1">}</span>
<a name="l733"><span class="ln">733  </span></a>
<a name="l734"><span class="ln">734  </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s2">indent</span><span class="s1">) {</span>
<a name="l735"><span class="ln">735  </span></a>      <span class="s2">options</span><span class="s1">.</span><span class="s2">indent </span><span class="s1">= </span><span class="s2">JSON</span><span class="s1">.</span><span class="s2">stringify</span><span class="s1">(</span><span class="s2">indent</span><span class="s1">);</span>
<a name="l736"><span class="ln">736  </span></a>    <span class="s1">}</span>
<a name="l737"><span class="ln">737  </span></a>    <span class="s2">options</span><span class="s1">.</span><span class="s2">helpers </span><span class="s1">= </span><span class="s0">'helpers'</span><span class="s1">;</span>
<a name="l738"><span class="ln">738  </span></a>    <span class="s2">options</span><span class="s1">.</span><span class="s2">partials </span><span class="s1">= </span><span class="s0">'partials'</span><span class="s1">;</span>
<a name="l739"><span class="ln">739  </span></a>    <span class="s2">options</span><span class="s1">.</span><span class="s2">decorators </span><span class="s1">= </span><span class="s0">'container.decorators'</span><span class="s1">;</span>
<a name="l740"><span class="ln">740  </span></a>
<a name="l741"><span class="ln">741  </span></a>    <span class="s3">if </span><span class="s1">(!</span><span class="s2">isDynamic</span><span class="s1">) {</span>
<a name="l742"><span class="ln">742  </span></a>      <span class="s2">params</span><span class="s1">.</span><span class="s2">unshift</span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">nameLookup</span><span class="s1">(</span><span class="s0">'partials'</span><span class="s1">, </span><span class="s2">name</span><span class="s1">, </span><span class="s0">'partial'</span><span class="s1">));</span>
<a name="l743"><span class="ln">743  </span></a>    <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
<a name="l744"><span class="ln">744  </span></a>      <span class="s2">params</span><span class="s1">.</span><span class="s2">unshift</span><span class="s1">(</span><span class="s2">name</span><span class="s1">);</span>
<a name="l745"><span class="ln">745  </span></a>    <span class="s1">}</span>
<a name="l746"><span class="ln">746  </span></a>
<a name="l747"><span class="ln">747  </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">compat</span><span class="s1">) {</span>
<a name="l748"><span class="ln">748  </span></a>      <span class="s2">options</span><span class="s1">.</span><span class="s2">depths </span><span class="s1">= </span><span class="s0">'depths'</span><span class="s1">;</span>
<a name="l749"><span class="ln">749  </span></a>    <span class="s1">}</span>
<a name="l750"><span class="ln">750  </span></a>    <span class="s2">options </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">objectLiteral</span><span class="s1">(</span><span class="s2">options</span><span class="s1">);</span>
<a name="l751"><span class="ln">751  </span></a>    <span class="s2">params</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">options</span><span class="s1">);</span>
<a name="l752"><span class="ln">752  </span></a>
<a name="l753"><span class="ln">753  </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">source</span><span class="s1">.</span><span class="s2">functionCall</span><span class="s1">(</span><span class="s0">'container.invokePartial'</span><span class="s1">, </span><span class="s0">''</span><span class="s1">, </span><span class="s2">params</span><span class="s1">));</span>
<a name="l754"><span class="ln">754  </span></a>  <span class="s1">},</span>
<a name="l755"><span class="ln">755  </span></a>
<a name="l756"><span class="ln">756  </span></a>  <span class="s4">// [assignToHash]</span>
<a name="l757"><span class="ln">757  </span></a>  <span class="s4">//</span>
<a name="l758"><span class="ln">758  </span></a>  <span class="s4">// On stack, before: value, ..., hash, ...</span>
<a name="l759"><span class="ln">759  </span></a>  <span class="s4">// On stack, after: ..., hash, ...</span>
<a name="l760"><span class="ln">760  </span></a>  <span class="s4">//</span>
<a name="l761"><span class="ln">761  </span></a>  <span class="s4">// Pops a value off the stack and assigns it to the current hash</span>
<a name="l762"><span class="ln">762  </span></a>  <span class="s2">assignToHash</span><span class="s1">: </span><span class="s3">function </span><span class="s2">assignToHash</span><span class="s1">(</span><span class="s2">key</span><span class="s1">) {</span>
<a name="l763"><span class="ln">763  </span></a>    <span class="s3">var </span><span class="s2">value </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">popStack</span><span class="s1">(),</span>
<a name="l764"><span class="ln">764  </span></a>        <span class="s2">context </span><span class="s1">= </span><span class="s2">undefined</span><span class="s1">,</span>
<a name="l765"><span class="ln">765  </span></a>        <span class="s2">type </span><span class="s1">= </span><span class="s2">undefined</span><span class="s1">,</span>
<a name="l766"><span class="ln">766  </span></a>        <span class="s2">id </span><span class="s1">= </span><span class="s2">undefined</span><span class="s1">;</span>
<a name="l767"><span class="ln">767  </span></a>
<a name="l768"><span class="ln">768  </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">trackIds</span><span class="s1">) {</span>
<a name="l769"><span class="ln">769  </span></a>      <span class="s2">id </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">popStack</span><span class="s1">();</span>
<a name="l770"><span class="ln">770  </span></a>    <span class="s1">}</span>
<a name="l771"><span class="ln">771  </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">stringParams</span><span class="s1">) {</span>
<a name="l772"><span class="ln">772  </span></a>      <span class="s2">type </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">popStack</span><span class="s1">();</span>
<a name="l773"><span class="ln">773  </span></a>      <span class="s2">context </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">popStack</span><span class="s1">();</span>
<a name="l774"><span class="ln">774  </span></a>    <span class="s1">}</span>
<a name="l775"><span class="ln">775  </span></a>
<a name="l776"><span class="ln">776  </span></a>    <span class="s3">var </span><span class="s2">hash </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">hash</span><span class="s1">;</span>
<a name="l777"><span class="ln">777  </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s2">context</span><span class="s1">) {</span>
<a name="l778"><span class="ln">778  </span></a>      <span class="s2">hash</span><span class="s1">.</span><span class="s2">contexts</span><span class="s1">[</span><span class="s2">key</span><span class="s1">] = </span><span class="s2">context</span><span class="s1">;</span>
<a name="l779"><span class="ln">779  </span></a>    <span class="s1">}</span>
<a name="l780"><span class="ln">780  </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s2">type</span><span class="s1">) {</span>
<a name="l781"><span class="ln">781  </span></a>      <span class="s2">hash</span><span class="s1">.</span><span class="s2">types</span><span class="s1">[</span><span class="s2">key</span><span class="s1">] = </span><span class="s2">type</span><span class="s1">;</span>
<a name="l782"><span class="ln">782  </span></a>    <span class="s1">}</span>
<a name="l783"><span class="ln">783  </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s2">id</span><span class="s1">) {</span>
<a name="l784"><span class="ln">784  </span></a>      <span class="s2">hash</span><span class="s1">.</span><span class="s2">ids</span><span class="s1">[</span><span class="s2">key</span><span class="s1">] = </span><span class="s2">id</span><span class="s1">;</span>
<a name="l785"><span class="ln">785  </span></a>    <span class="s1">}</span>
<a name="l786"><span class="ln">786  </span></a>    <span class="s2">hash</span><span class="s1">.</span><span class="s2">values</span><span class="s1">[</span><span class="s2">key</span><span class="s1">] = </span><span class="s2">value</span><span class="s1">;</span>
<a name="l787"><span class="ln">787  </span></a>  <span class="s1">},</span>
<a name="l788"><span class="ln">788  </span></a>
<a name="l789"><span class="ln">789  </span></a>  <span class="s2">pushId</span><span class="s1">: </span><span class="s3">function </span><span class="s2">pushId</span><span class="s1">(</span><span class="s2">type</span><span class="s1">, </span><span class="s2">name</span><span class="s1">, </span><span class="s2">child</span><span class="s1">) {</span>
<a name="l790"><span class="ln">790  </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s2">type </span><span class="s1">=== </span><span class="s0">'BlockParam'</span><span class="s1">) {</span>
<a name="l791"><span class="ln">791  </span></a>      <span class="s3">this</span><span class="s1">.</span><span class="s2">pushStackLiteral</span><span class="s1">(</span><span class="s0">'blockParams[' </span><span class="s1">+ </span><span class="s2">name</span><span class="s1">[</span><span class="s5">0</span><span class="s1">] + </span><span class="s0">'].path[' </span><span class="s1">+ </span><span class="s2">name</span><span class="s1">[</span><span class="s5">1</span><span class="s1">] + </span><span class="s0">']' </span><span class="s1">+ (</span><span class="s2">child </span><span class="s1">? </span><span class="s0">' + ' </span><span class="s1">+ </span><span class="s2">JSON</span><span class="s1">.</span><span class="s2">stringify</span><span class="s1">(</span><span class="s0">'.' </span><span class="s1">+ </span><span class="s2">child</span><span class="s1">) : </span><span class="s0">''</span><span class="s1">));</span>
<a name="l792"><span class="ln">792  </span></a>    <span class="s1">} </span><span class="s3">else if </span><span class="s1">(</span><span class="s2">type </span><span class="s1">=== </span><span class="s0">'PathExpression'</span><span class="s1">) {</span>
<a name="l793"><span class="ln">793  </span></a>      <span class="s3">this</span><span class="s1">.</span><span class="s2">pushString</span><span class="s1">(</span><span class="s2">name</span><span class="s1">);</span>
<a name="l794"><span class="ln">794  </span></a>    <span class="s1">} </span><span class="s3">else if </span><span class="s1">(</span><span class="s2">type </span><span class="s1">=== </span><span class="s0">'SubExpression'</span><span class="s1">) {</span>
<a name="l795"><span class="ln">795  </span></a>      <span class="s3">this</span><span class="s1">.</span><span class="s2">pushStackLiteral</span><span class="s1">(</span><span class="s0">'true'</span><span class="s1">);</span>
<a name="l796"><span class="ln">796  </span></a>    <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
<a name="l797"><span class="ln">797  </span></a>      <span class="s3">this</span><span class="s1">.</span><span class="s2">pushStackLiteral</span><span class="s1">(</span><span class="s0">'null'</span><span class="s1">);</span>
<a name="l798"><span class="ln">798  </span></a>    <span class="s1">}</span>
<a name="l799"><span class="ln">799  </span></a>  <span class="s1">},</span>
<a name="l800"><span class="ln">800  </span></a>
<a name="l801"><span class="ln">801  </span></a>  <span class="s4">// HELPERS</span>
<a name="l802"><span class="ln">802  </span></a>
<a name="l803"><span class="ln">803  </span></a>  <span class="s2">compiler</span><span class="s1">: </span><span class="s2">JavaScriptCompiler</span><span class="s1">,</span>
<a name="l804"><span class="ln">804  </span></a>
<a name="l805"><span class="ln">805  </span></a>  <span class="s2">compileChildren</span><span class="s1">: </span><span class="s3">function </span><span class="s2">compileChildren</span><span class="s1">(</span><span class="s2">environment</span><span class="s1">, </span><span class="s2">options</span><span class="s1">) {</span>
<a name="l806"><span class="ln">806  </span></a>    <span class="s3">var </span><span class="s2">children </span><span class="s1">= </span><span class="s2">environment</span><span class="s1">.</span><span class="s2">children</span><span class="s1">,</span>
<a name="l807"><span class="ln">807  </span></a>        <span class="s2">child </span><span class="s1">= </span><span class="s2">undefined</span><span class="s1">,</span>
<a name="l808"><span class="ln">808  </span></a>        <span class="s2">compiler </span><span class="s1">= </span><span class="s2">undefined</span><span class="s1">;</span>
<a name="l809"><span class="ln">809  </span></a>
<a name="l810"><span class="ln">810  </span></a>    <span class="s3">for </span><span class="s1">(</span><span class="s3">var </span><span class="s2">i </span><span class="s1">= </span><span class="s5">0</span><span class="s1">, </span><span class="s2">l </span><span class="s1">= </span><span class="s2">children</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">l</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
<a name="l811"><span class="ln">811  </span></a>      <span class="s2">child </span><span class="s1">= </span><span class="s2">children</span><span class="s1">[</span><span class="s2">i</span><span class="s1">];</span>
<a name="l812"><span class="ln">812  </span></a>      <span class="s2">compiler </span><span class="s1">= </span><span class="s3">new this</span><span class="s1">.</span><span class="s2">compiler</span><span class="s1">(); </span><span class="s4">// eslint-disable-line new-cap</span>
<a name="l813"><span class="ln">813  </span></a>
<a name="l814"><span class="ln">814  </span></a>      <span class="s3">var </span><span class="s2">existing </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">matchExistingProgram</span><span class="s1">(</span><span class="s2">child</span><span class="s1">);</span>
<a name="l815"><span class="ln">815  </span></a>
<a name="l816"><span class="ln">816  </span></a>      <span class="s3">if </span><span class="s1">(</span><span class="s2">existing </span><span class="s1">== </span><span class="s3">null</span><span class="s1">) {</span>
<a name="l817"><span class="ln">817  </span></a>        <span class="s3">this</span><span class="s1">.</span><span class="s2">context</span><span class="s1">.</span><span class="s2">programs</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s0">''</span><span class="s1">); </span><span class="s4">// Placeholder to prevent name conflicts for nested children</span>
<a name="l818"><span class="ln">818  </span></a>        <span class="s3">var </span><span class="s2">index </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">context</span><span class="s1">.</span><span class="s2">programs</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span>
<a name="l819"><span class="ln">819  </span></a>        <span class="s2">child</span><span class="s1">.</span><span class="s2">index </span><span class="s1">= </span><span class="s2">index</span><span class="s1">;</span>
<a name="l820"><span class="ln">820  </span></a>        <span class="s2">child</span><span class="s1">.</span><span class="s2">name </span><span class="s1">= </span><span class="s0">'program' </span><span class="s1">+ </span><span class="s2">index</span><span class="s1">;</span>
<a name="l821"><span class="ln">821  </span></a>        <span class="s3">this</span><span class="s1">.</span><span class="s2">context</span><span class="s1">.</span><span class="s2">programs</span><span class="s1">[</span><span class="s2">index</span><span class="s1">] = </span><span class="s2">compiler</span><span class="s1">.</span><span class="s2">compile</span><span class="s1">(</span><span class="s2">child</span><span class="s1">, </span><span class="s2">options</span><span class="s1">, </span><span class="s3">this</span><span class="s1">.</span><span class="s2">context</span><span class="s1">, !</span><span class="s3">this</span><span class="s1">.</span><span class="s2">precompile</span><span class="s1">);</span>
<a name="l822"><span class="ln">822  </span></a>        <span class="s3">this</span><span class="s1">.</span><span class="s2">context</span><span class="s1">.</span><span class="s2">decorators</span><span class="s1">[</span><span class="s2">index</span><span class="s1">] = </span><span class="s2">compiler</span><span class="s1">.</span><span class="s2">decorators</span><span class="s1">;</span>
<a name="l823"><span class="ln">823  </span></a>        <span class="s3">this</span><span class="s1">.</span><span class="s2">context</span><span class="s1">.</span><span class="s2">environments</span><span class="s1">[</span><span class="s2">index</span><span class="s1">] = </span><span class="s2">child</span><span class="s1">;</span>
<a name="l824"><span class="ln">824  </span></a>
<a name="l825"><span class="ln">825  </span></a>        <span class="s3">this</span><span class="s1">.</span><span class="s2">useDepths </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">useDepths </span><span class="s1">|| </span><span class="s2">compiler</span><span class="s1">.</span><span class="s2">useDepths</span><span class="s1">;</span>
<a name="l826"><span class="ln">826  </span></a>        <span class="s3">this</span><span class="s1">.</span><span class="s2">useBlockParams </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">useBlockParams </span><span class="s1">|| </span><span class="s2">compiler</span><span class="s1">.</span><span class="s2">useBlockParams</span><span class="s1">;</span>
<a name="l827"><span class="ln">827  </span></a>        <span class="s2">child</span><span class="s1">.</span><span class="s2">useDepths </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">useDepths</span><span class="s1">;</span>
<a name="l828"><span class="ln">828  </span></a>        <span class="s2">child</span><span class="s1">.</span><span class="s2">useBlockParams </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">useBlockParams</span><span class="s1">;</span>
<a name="l829"><span class="ln">829  </span></a>      <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
<a name="l830"><span class="ln">830  </span></a>        <span class="s2">child</span><span class="s1">.</span><span class="s2">index </span><span class="s1">= </span><span class="s2">existing</span><span class="s1">.</span><span class="s2">index</span><span class="s1">;</span>
<a name="l831"><span class="ln">831  </span></a>        <span class="s2">child</span><span class="s1">.</span><span class="s2">name </span><span class="s1">= </span><span class="s0">'program' </span><span class="s1">+ </span><span class="s2">existing</span><span class="s1">.</span><span class="s2">index</span><span class="s1">;</span>
<a name="l832"><span class="ln">832  </span></a>
<a name="l833"><span class="ln">833  </span></a>        <span class="s3">this</span><span class="s1">.</span><span class="s2">useDepths </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">useDepths </span><span class="s1">|| </span><span class="s2">existing</span><span class="s1">.</span><span class="s2">useDepths</span><span class="s1">;</span>
<a name="l834"><span class="ln">834  </span></a>        <span class="s3">this</span><span class="s1">.</span><span class="s2">useBlockParams </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">useBlockParams </span><span class="s1">|| </span><span class="s2">existing</span><span class="s1">.</span><span class="s2">useBlockParams</span><span class="s1">;</span>
<a name="l835"><span class="ln">835  </span></a>      <span class="s1">}</span>
<a name="l836"><span class="ln">836  </span></a>    <span class="s1">}</span>
<a name="l837"><span class="ln">837  </span></a>  <span class="s1">},</span>
<a name="l838"><span class="ln">838  </span></a>  <span class="s2">matchExistingProgram</span><span class="s1">: </span><span class="s3">function </span><span class="s2">matchExistingProgram</span><span class="s1">(</span><span class="s2">child</span><span class="s1">) {</span>
<a name="l839"><span class="ln">839  </span></a>    <span class="s3">for </span><span class="s1">(</span><span class="s3">var </span><span class="s2">i </span><span class="s1">= </span><span class="s5">0</span><span class="s1">, </span><span class="s2">len </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">context</span><span class="s1">.</span><span class="s2">environments</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">len</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
<a name="l840"><span class="ln">840  </span></a>      <span class="s3">var </span><span class="s2">environment </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">context</span><span class="s1">.</span><span class="s2">environments</span><span class="s1">[</span><span class="s2">i</span><span class="s1">];</span>
<a name="l841"><span class="ln">841  </span></a>      <span class="s3">if </span><span class="s1">(</span><span class="s2">environment </span><span class="s1">&amp;&amp; </span><span class="s2">environment</span><span class="s1">.</span><span class="s2">equals</span><span class="s1">(</span><span class="s2">child</span><span class="s1">)) {</span>
<a name="l842"><span class="ln">842  </span></a>        <span class="s3">return </span><span class="s2">environment</span><span class="s1">;</span>
<a name="l843"><span class="ln">843  </span></a>      <span class="s1">}</span>
<a name="l844"><span class="ln">844  </span></a>    <span class="s1">}</span>
<a name="l845"><span class="ln">845  </span></a>  <span class="s1">},</span>
<a name="l846"><span class="ln">846  </span></a>
<a name="l847"><span class="ln">847  </span></a>  <span class="s2">programExpression</span><span class="s1">: </span><span class="s3">function </span><span class="s2">programExpression</span><span class="s1">(</span><span class="s2">guid</span><span class="s1">) {</span>
<a name="l848"><span class="ln">848  </span></a>    <span class="s3">var </span><span class="s2">child </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">environment</span><span class="s1">.</span><span class="s2">children</span><span class="s1">[</span><span class="s2">guid</span><span class="s1">],</span>
<a name="l849"><span class="ln">849  </span></a>        <span class="s2">programParams </span><span class="s1">= [</span><span class="s2">child</span><span class="s1">.</span><span class="s2">index</span><span class="s1">, </span><span class="s0">'data'</span><span class="s1">, </span><span class="s2">child</span><span class="s1">.</span><span class="s2">blockParams</span><span class="s1">];</span>
<a name="l850"><span class="ln">850  </span></a>
<a name="l851"><span class="ln">851  </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">useBlockParams </span><span class="s1">|| </span><span class="s3">this</span><span class="s1">.</span><span class="s2">useDepths</span><span class="s1">) {</span>
<a name="l852"><span class="ln">852  </span></a>      <span class="s2">programParams</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s0">'blockParams'</span><span class="s1">);</span>
<a name="l853"><span class="ln">853  </span></a>    <span class="s1">}</span>
<a name="l854"><span class="ln">854  </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">useDepths</span><span class="s1">) {</span>
<a name="l855"><span class="ln">855  </span></a>      <span class="s2">programParams</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s0">'depths'</span><span class="s1">);</span>
<a name="l856"><span class="ln">856  </span></a>    <span class="s1">}</span>
<a name="l857"><span class="ln">857  </span></a>
<a name="l858"><span class="ln">858  </span></a>    <span class="s3">return </span><span class="s0">'container.program(' </span><span class="s1">+ </span><span class="s2">programParams</span><span class="s1">.</span><span class="s2">join</span><span class="s1">(</span><span class="s0">', '</span><span class="s1">) + </span><span class="s0">')'</span><span class="s1">;</span>
<a name="l859"><span class="ln">859  </span></a>  <span class="s1">},</span>
<a name="l860"><span class="ln">860  </span></a>
<a name="l861"><span class="ln">861  </span></a>  <span class="s2">useRegister</span><span class="s1">: </span><span class="s3">function </span><span class="s2">useRegister</span><span class="s1">(</span><span class="s2">name</span><span class="s1">) {</span>
<a name="l862"><span class="ln">862  </span></a>    <span class="s3">if </span><span class="s1">(!</span><span class="s3">this</span><span class="s1">.</span><span class="s2">registers</span><span class="s1">[</span><span class="s2">name</span><span class="s1">]) {</span>
<a name="l863"><span class="ln">863  </span></a>      <span class="s3">this</span><span class="s1">.</span><span class="s2">registers</span><span class="s1">[</span><span class="s2">name</span><span class="s1">] = </span><span class="s3">true</span><span class="s1">;</span>
<a name="l864"><span class="ln">864  </span></a>      <span class="s3">this</span><span class="s1">.</span><span class="s2">registers</span><span class="s1">.</span><span class="s2">list</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">name</span><span class="s1">);</span>
<a name="l865"><span class="ln">865  </span></a>    <span class="s1">}</span>
<a name="l866"><span class="ln">866  </span></a>  <span class="s1">},</span>
<a name="l867"><span class="ln">867  </span></a>
<a name="l868"><span class="ln">868  </span></a>  <span class="s2">push</span><span class="s1">: </span><span class="s3">function </span><span class="s2">push</span><span class="s1">(</span><span class="s2">expr</span><span class="s1">) {</span>
<a name="l869"><span class="ln">869  </span></a>    <span class="s3">if </span><span class="s1">(!(</span><span class="s2">expr </span><span class="s3">instanceof </span><span class="s2">Literal</span><span class="s1">)) {</span>
<a name="l870"><span class="ln">870  </span></a>      <span class="s2">expr </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">source</span><span class="s1">.</span><span class="s2">wrap</span><span class="s1">(</span><span class="s2">expr</span><span class="s1">);</span>
<a name="l871"><span class="ln">871  </span></a>    <span class="s1">}</span>
<a name="l872"><span class="ln">872  </span></a>
<a name="l873"><span class="ln">873  </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">inlineStack</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">expr</span><span class="s1">);</span>
<a name="l874"><span class="ln">874  </span></a>    <span class="s3">return </span><span class="s2">expr</span><span class="s1">;</span>
<a name="l875"><span class="ln">875  </span></a>  <span class="s1">},</span>
<a name="l876"><span class="ln">876  </span></a>
<a name="l877"><span class="ln">877  </span></a>  <span class="s2">pushStackLiteral</span><span class="s1">: </span><span class="s3">function </span><span class="s2">pushStackLiteral</span><span class="s1">(</span><span class="s2">item</span><span class="s1">) {</span>
<a name="l878"><span class="ln">878  </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s3">new </span><span class="s2">Literal</span><span class="s1">(</span><span class="s2">item</span><span class="s1">));</span>
<a name="l879"><span class="ln">879  </span></a>  <span class="s1">},</span>
<a name="l880"><span class="ln">880  </span></a>
<a name="l881"><span class="ln">881  </span></a>  <span class="s2">pushSource</span><span class="s1">: </span><span class="s3">function </span><span class="s2">pushSource</span><span class="s1">(</span><span class="s2">source</span><span class="s1">) {</span>
<a name="l882"><span class="ln">882  </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">pendingContent</span><span class="s1">) {</span>
<a name="l883"><span class="ln">883  </span></a>      <span class="s3">this</span><span class="s1">.</span><span class="s2">source</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">appendToBuffer</span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">source</span><span class="s1">.</span><span class="s2">quotedString</span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">pendingContent</span><span class="s1">), </span><span class="s3">this</span><span class="s1">.</span><span class="s2">pendingLocation</span><span class="s1">));</span>
<a name="l884"><span class="ln">884  </span></a>      <span class="s3">this</span><span class="s1">.</span><span class="s2">pendingContent </span><span class="s1">= </span><span class="s2">undefined</span><span class="s1">;</span>
<a name="l885"><span class="ln">885  </span></a>    <span class="s1">}</span>
<a name="l886"><span class="ln">886  </span></a>
<a name="l887"><span class="ln">887  </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s2">source</span><span class="s1">) {</span>
<a name="l888"><span class="ln">888  </span></a>      <span class="s3">this</span><span class="s1">.</span><span class="s2">source</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">source</span><span class="s1">);</span>
<a name="l889"><span class="ln">889  </span></a>    <span class="s1">}</span>
<a name="l890"><span class="ln">890  </span></a>  <span class="s1">},</span>
<a name="l891"><span class="ln">891  </span></a>
<a name="l892"><span class="ln">892  </span></a>  <span class="s2">replaceStack</span><span class="s1">: </span><span class="s3">function </span><span class="s2">replaceStack</span><span class="s1">(</span><span class="s2">callback</span><span class="s1">) {</span>
<a name="l893"><span class="ln">893  </span></a>    <span class="s3">var </span><span class="s2">prefix </span><span class="s1">= [</span><span class="s0">'('</span><span class="s1">],</span>
<a name="l894"><span class="ln">894  </span></a>        <span class="s2">stack </span><span class="s1">= </span><span class="s2">undefined</span><span class="s1">,</span>
<a name="l895"><span class="ln">895  </span></a>        <span class="s2">createdStack </span><span class="s1">= </span><span class="s2">undefined</span><span class="s1">,</span>
<a name="l896"><span class="ln">896  </span></a>        <span class="s2">usedLiteral </span><span class="s1">= </span><span class="s2">undefined</span><span class="s1">;</span>
<a name="l897"><span class="ln">897  </span></a>
<a name="l898"><span class="ln">898  </span></a>    <span class="s4">/* istanbul ignore next */</span>
<a name="l899"><span class="ln">899  </span></a>    <span class="s3">if </span><span class="s1">(!</span><span class="s3">this</span><span class="s1">.</span><span class="s2">isInline</span><span class="s1">()) {</span>
<a name="l900"><span class="ln">900  </span></a>      <span class="s3">throw new </span><span class="s2">_exception2</span><span class="s1">[</span><span class="s0">'default'</span><span class="s1">](</span><span class="s0">'replaceStack on non-inline'</span><span class="s1">);</span>
<a name="l901"><span class="ln">901  </span></a>    <span class="s1">}</span>
<a name="l902"><span class="ln">902  </span></a>
<a name="l903"><span class="ln">903  </span></a>    <span class="s4">// We want to merge the inline statement into the replacement statement via ','</span>
<a name="l904"><span class="ln">904  </span></a>    <span class="s3">var </span><span class="s2">top </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">popStack</span><span class="s1">(</span><span class="s3">true</span><span class="s1">);</span>
<a name="l905"><span class="ln">905  </span></a>
<a name="l906"><span class="ln">906  </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s2">top </span><span class="s3">instanceof </span><span class="s2">Literal</span><span class="s1">) {</span>
<a name="l907"><span class="ln">907  </span></a>      <span class="s4">// Literals do not need to be inlined</span>
<a name="l908"><span class="ln">908  </span></a>      <span class="s2">stack </span><span class="s1">= [</span><span class="s2">top</span><span class="s1">.</span><span class="s2">value</span><span class="s1">];</span>
<a name="l909"><span class="ln">909  </span></a>      <span class="s2">prefix </span><span class="s1">= [</span><span class="s0">'('</span><span class="s1">, </span><span class="s2">stack</span><span class="s1">];</span>
<a name="l910"><span class="ln">910  </span></a>      <span class="s2">usedLiteral </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
<a name="l911"><span class="ln">911  </span></a>    <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
<a name="l912"><span class="ln">912  </span></a>      <span class="s4">// Get or create the current stack name for use by the inline</span>
<a name="l913"><span class="ln">913  </span></a>      <span class="s2">createdStack </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
<a name="l914"><span class="ln">914  </span></a>      <span class="s3">var </span><span class="s2">_name </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">incrStack</span><span class="s1">();</span>
<a name="l915"><span class="ln">915  </span></a>
<a name="l916"><span class="ln">916  </span></a>      <span class="s2">prefix </span><span class="s1">= [</span><span class="s0">'(('</span><span class="s1">, </span><span class="s3">this</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">_name</span><span class="s1">), </span><span class="s0">' = '</span><span class="s1">, </span><span class="s2">top</span><span class="s1">, </span><span class="s0">')'</span><span class="s1">];</span>
<a name="l917"><span class="ln">917  </span></a>      <span class="s2">stack </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">topStack</span><span class="s1">();</span>
<a name="l918"><span class="ln">918  </span></a>    <span class="s1">}</span>
<a name="l919"><span class="ln">919  </span></a>
<a name="l920"><span class="ln">920  </span></a>    <span class="s3">var </span><span class="s2">item </span><span class="s1">= </span><span class="s2">callback</span><span class="s1">.</span><span class="s2">call</span><span class="s1">(</span><span class="s3">this</span><span class="s1">, </span><span class="s2">stack</span><span class="s1">);</span>
<a name="l921"><span class="ln">921  </span></a>
<a name="l922"><span class="ln">922  </span></a>    <span class="s3">if </span><span class="s1">(!</span><span class="s2">usedLiteral</span><span class="s1">) {</span>
<a name="l923"><span class="ln">923  </span></a>      <span class="s3">this</span><span class="s1">.</span><span class="s2">popStack</span><span class="s1">();</span>
<a name="l924"><span class="ln">924  </span></a>    <span class="s1">}</span>
<a name="l925"><span class="ln">925  </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s2">createdStack</span><span class="s1">) {</span>
<a name="l926"><span class="ln">926  </span></a>      <span class="s3">this</span><span class="s1">.</span><span class="s2">stackSlot</span><span class="s1">--;</span>
<a name="l927"><span class="ln">927  </span></a>    <span class="s1">}</span>
<a name="l928"><span class="ln">928  </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">prefix</span><span class="s1">.</span><span class="s2">concat</span><span class="s1">(</span><span class="s2">item</span><span class="s1">, </span><span class="s0">')'</span><span class="s1">));</span>
<a name="l929"><span class="ln">929  </span></a>  <span class="s1">},</span>
<a name="l930"><span class="ln">930  </span></a>
<a name="l931"><span class="ln">931  </span></a>  <span class="s2">incrStack</span><span class="s1">: </span><span class="s3">function </span><span class="s2">incrStack</span><span class="s1">() {</span>
<a name="l932"><span class="ln">932  </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">stackSlot</span><span class="s1">++;</span>
<a name="l933"><span class="ln">933  </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">stackSlot </span><span class="s1">&gt; </span><span class="s3">this</span><span class="s1">.</span><span class="s2">stackVars</span><span class="s1">.</span><span class="s2">length</span><span class="s1">) {</span>
<a name="l934"><span class="ln">934  </span></a>      <span class="s3">this</span><span class="s1">.</span><span class="s2">stackVars</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s0">'stack' </span><span class="s1">+ </span><span class="s3">this</span><span class="s1">.</span><span class="s2">stackSlot</span><span class="s1">);</span>
<a name="l935"><span class="ln">935  </span></a>    <span class="s1">}</span>
<a name="l936"><span class="ln">936  </span></a>    <span class="s3">return this</span><span class="s1">.</span><span class="s2">topStackName</span><span class="s1">();</span>
<a name="l937"><span class="ln">937  </span></a>  <span class="s1">},</span>
<a name="l938"><span class="ln">938  </span></a>  <span class="s2">topStackName</span><span class="s1">: </span><span class="s3">function </span><span class="s2">topStackName</span><span class="s1">() {</span>
<a name="l939"><span class="ln">939  </span></a>    <span class="s3">return </span><span class="s0">'stack' </span><span class="s1">+ </span><span class="s3">this</span><span class="s1">.</span><span class="s2">stackSlot</span><span class="s1">;</span>
<a name="l940"><span class="ln">940  </span></a>  <span class="s1">},</span>
<a name="l941"><span class="ln">941  </span></a>  <span class="s2">flushInline</span><span class="s1">: </span><span class="s3">function </span><span class="s2">flushInline</span><span class="s1">() {</span>
<a name="l942"><span class="ln">942  </span></a>    <span class="s3">var </span><span class="s2">inlineStack </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">inlineStack</span><span class="s1">;</span>
<a name="l943"><span class="ln">943  </span></a>    <span class="s3">this</span><span class="s1">.</span><span class="s2">inlineStack </span><span class="s1">= [];</span>
<a name="l944"><span class="ln">944  </span></a>    <span class="s3">for </span><span class="s1">(</span><span class="s3">var </span><span class="s2">i </span><span class="s1">= </span><span class="s5">0</span><span class="s1">, </span><span class="s2">len </span><span class="s1">= </span><span class="s2">inlineStack</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">len</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
<a name="l945"><span class="ln">945  </span></a>      <span class="s3">var </span><span class="s2">entry </span><span class="s1">= </span><span class="s2">inlineStack</span><span class="s1">[</span><span class="s2">i</span><span class="s1">];</span>
<a name="l946"><span class="ln">946  </span></a>      <span class="s4">/* istanbul ignore if */</span>
<a name="l947"><span class="ln">947  </span></a>      <span class="s3">if </span><span class="s1">(</span><span class="s2">entry </span><span class="s3">instanceof </span><span class="s2">Literal</span><span class="s1">) {</span>
<a name="l948"><span class="ln">948  </span></a>        <span class="s3">this</span><span class="s1">.</span><span class="s2">compileStack</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">entry</span><span class="s1">);</span>
<a name="l949"><span class="ln">949  </span></a>      <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
<a name="l950"><span class="ln">950  </span></a>        <span class="s3">var </span><span class="s2">stack </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">incrStack</span><span class="s1">();</span>
<a name="l951"><span class="ln">951  </span></a>        <span class="s3">this</span><span class="s1">.</span><span class="s2">pushSource</span><span class="s1">([</span><span class="s2">stack</span><span class="s1">, </span><span class="s0">' = '</span><span class="s1">, </span><span class="s2">entry</span><span class="s1">, </span><span class="s0">';'</span><span class="s1">]);</span>
<a name="l952"><span class="ln">952  </span></a>        <span class="s3">this</span><span class="s1">.</span><span class="s2">compileStack</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">stack</span><span class="s1">);</span>
<a name="l953"><span class="ln">953  </span></a>      <span class="s1">}</span>
<a name="l954"><span class="ln">954  </span></a>    <span class="s1">}</span>
<a name="l955"><span class="ln">955  </span></a>  <span class="s1">},</span>
<a name="l956"><span class="ln">956  </span></a>  <span class="s2">isInline</span><span class="s1">: </span><span class="s3">function </span><span class="s2">isInline</span><span class="s1">() {</span>
<a name="l957"><span class="ln">957  </span></a>    <span class="s3">return this</span><span class="s1">.</span><span class="s2">inlineStack</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span>
<a name="l958"><span class="ln">958  </span></a>  <span class="s1">},</span>
<a name="l959"><span class="ln">959  </span></a>
<a name="l960"><span class="ln">960  </span></a>  <span class="s2">popStack</span><span class="s1">: </span><span class="s3">function </span><span class="s2">popStack</span><span class="s1">(</span><span class="s2">wrapped</span><span class="s1">) {</span>
<a name="l961"><span class="ln">961  </span></a>    <span class="s3">var </span><span class="s2">inline </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">isInline</span><span class="s1">(),</span>
<a name="l962"><span class="ln">962  </span></a>        <span class="s2">item </span><span class="s1">= (</span><span class="s2">inline </span><span class="s1">? </span><span class="s3">this</span><span class="s1">.</span><span class="s2">inlineStack </span><span class="s1">: </span><span class="s3">this</span><span class="s1">.</span><span class="s2">compileStack</span><span class="s1">).</span><span class="s2">pop</span><span class="s1">();</span>
<a name="l963"><span class="ln">963  </span></a>
<a name="l964"><span class="ln">964  </span></a>    <span class="s3">if </span><span class="s1">(!</span><span class="s2">wrapped </span><span class="s1">&amp;&amp; </span><span class="s2">item </span><span class="s3">instanceof </span><span class="s2">Literal</span><span class="s1">) {</span>
<a name="l965"><span class="ln">965  </span></a>      <span class="s3">return </span><span class="s2">item</span><span class="s1">.</span><span class="s2">value</span><span class="s1">;</span>
<a name="l966"><span class="ln">966  </span></a>    <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
<a name="l967"><span class="ln">967  </span></a>      <span class="s3">if </span><span class="s1">(!</span><span class="s2">inline</span><span class="s1">) {</span>
<a name="l968"><span class="ln">968  </span></a>        <span class="s4">/* istanbul ignore next */</span>
<a name="l969"><span class="ln">969  </span></a>        <span class="s3">if </span><span class="s1">(!</span><span class="s3">this</span><span class="s1">.</span><span class="s2">stackSlot</span><span class="s1">) {</span>
<a name="l970"><span class="ln">970  </span></a>          <span class="s3">throw new </span><span class="s2">_exception2</span><span class="s1">[</span><span class="s0">'default'</span><span class="s1">](</span><span class="s0">'Invalid stack pop'</span><span class="s1">);</span>
<a name="l971"><span class="ln">971  </span></a>        <span class="s1">}</span>
<a name="l972"><span class="ln">972  </span></a>        <span class="s3">this</span><span class="s1">.</span><span class="s2">stackSlot</span><span class="s1">--;</span>
<a name="l973"><span class="ln">973  </span></a>      <span class="s1">}</span>
<a name="l974"><span class="ln">974  </span></a>      <span class="s3">return </span><span class="s2">item</span><span class="s1">;</span>
<a name="l975"><span class="ln">975  </span></a>    <span class="s1">}</span>
<a name="l976"><span class="ln">976  </span></a>  <span class="s1">},</span>
<a name="l977"><span class="ln">977  </span></a>
<a name="l978"><span class="ln">978  </span></a>  <span class="s2">topStack</span><span class="s1">: </span><span class="s3">function </span><span class="s2">topStack</span><span class="s1">() {</span>
<a name="l979"><span class="ln">979  </span></a>    <span class="s3">var </span><span class="s2">stack </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">isInline</span><span class="s1">() ? </span><span class="s3">this</span><span class="s1">.</span><span class="s2">inlineStack </span><span class="s1">: </span><span class="s3">this</span><span class="s1">.</span><span class="s2">compileStack</span><span class="s1">,</span>
<a name="l980"><span class="ln">980  </span></a>        <span class="s2">item </span><span class="s1">= </span><span class="s2">stack</span><span class="s1">[</span><span class="s2">stack</span><span class="s1">.</span><span class="s2">length </span><span class="s1">- </span><span class="s5">1</span><span class="s1">];</span>
<a name="l981"><span class="ln">981  </span></a>
<a name="l982"><span class="ln">982  </span></a>    <span class="s4">/* istanbul ignore if */</span>
<a name="l983"><span class="ln">983  </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s2">item </span><span class="s3">instanceof </span><span class="s2">Literal</span><span class="s1">) {</span>
<a name="l984"><span class="ln">984  </span></a>      <span class="s3">return </span><span class="s2">item</span><span class="s1">.</span><span class="s2">value</span><span class="s1">;</span>
<a name="l985"><span class="ln">985  </span></a>    <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
<a name="l986"><span class="ln">986  </span></a>      <span class="s3">return </span><span class="s2">item</span><span class="s1">;</span>
<a name="l987"><span class="ln">987  </span></a>    <span class="s1">}</span>
<a name="l988"><span class="ln">988  </span></a>  <span class="s1">},</span>
<a name="l989"><span class="ln">989  </span></a>
<a name="l990"><span class="ln">990  </span></a>  <span class="s2">contextName</span><span class="s1">: </span><span class="s3">function </span><span class="s2">contextName</span><span class="s1">(</span><span class="s2">context</span><span class="s1">) {</span>
<a name="l991"><span class="ln">991  </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">useDepths </span><span class="s1">&amp;&amp; </span><span class="s2">context</span><span class="s1">) {</span>
<a name="l992"><span class="ln">992  </span></a>      <span class="s3">return </span><span class="s0">'depths[' </span><span class="s1">+ </span><span class="s2">context </span><span class="s1">+ </span><span class="s0">']'</span><span class="s1">;</span>
<a name="l993"><span class="ln">993  </span></a>    <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
<a name="l994"><span class="ln">994  </span></a>      <span class="s3">return </span><span class="s0">'depth' </span><span class="s1">+ </span><span class="s2">context</span><span class="s1">;</span>
<a name="l995"><span class="ln">995  </span></a>    <span class="s1">}</span>
<a name="l996"><span class="ln">996  </span></a>  <span class="s1">},</span>
<a name="l997"><span class="ln">997  </span></a>
<a name="l998"><span class="ln">998  </span></a>  <span class="s2">quotedString</span><span class="s1">: </span><span class="s3">function </span><span class="s2">quotedString</span><span class="s1">(</span><span class="s2">str</span><span class="s1">) {</span>
<a name="l999"><span class="ln">999  </span></a>    <span class="s3">return this</span><span class="s1">.</span><span class="s2">source</span><span class="s1">.</span><span class="s2">quotedString</span><span class="s1">(</span><span class="s2">str</span><span class="s1">);</span>
<a name="l1000"><span class="ln">1000 </span></a>  <span class="s1">},</span>
<a name="l1001"><span class="ln">1001 </span></a>
<a name="l1002"><span class="ln">1002 </span></a>  <span class="s2">objectLiteral</span><span class="s1">: </span><span class="s3">function </span><span class="s2">objectLiteral</span><span class="s1">(</span><span class="s2">obj</span><span class="s1">) {</span>
<a name="l1003"><span class="ln">1003 </span></a>    <span class="s3">return this</span><span class="s1">.</span><span class="s2">source</span><span class="s1">.</span><span class="s2">objectLiteral</span><span class="s1">(</span><span class="s2">obj</span><span class="s1">);</span>
<a name="l1004"><span class="ln">1004 </span></a>  <span class="s1">},</span>
<a name="l1005"><span class="ln">1005 </span></a>
<a name="l1006"><span class="ln">1006 </span></a>  <span class="s2">aliasable</span><span class="s1">: </span><span class="s3">function </span><span class="s2">aliasable</span><span class="s1">(</span><span class="s2">name</span><span class="s1">) {</span>
<a name="l1007"><span class="ln">1007 </span></a>    <span class="s3">var </span><span class="s2">ret </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">aliases</span><span class="s1">[</span><span class="s2">name</span><span class="s1">];</span>
<a name="l1008"><span class="ln">1008 </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s2">ret</span><span class="s1">) {</span>
<a name="l1009"><span class="ln">1009 </span></a>      <span class="s2">ret</span><span class="s1">.</span><span class="s2">referenceCount</span><span class="s1">++;</span>
<a name="l1010"><span class="ln">1010 </span></a>      <span class="s3">return </span><span class="s2">ret</span><span class="s1">;</span>
<a name="l1011"><span class="ln">1011 </span></a>    <span class="s1">}</span>
<a name="l1012"><span class="ln">1012 </span></a>
<a name="l1013"><span class="ln">1013 </span></a>    <span class="s2">ret </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">aliases</span><span class="s1">[</span><span class="s2">name</span><span class="s1">] = </span><span class="s3">this</span><span class="s1">.</span><span class="s2">source</span><span class="s1">.</span><span class="s2">wrap</span><span class="s1">(</span><span class="s2">name</span><span class="s1">);</span>
<a name="l1014"><span class="ln">1014 </span></a>    <span class="s2">ret</span><span class="s1">.</span><span class="s2">aliasable </span><span class="s1">= </span><span class="s3">true</span><span class="s1">;</span>
<a name="l1015"><span class="ln">1015 </span></a>    <span class="s2">ret</span><span class="s1">.</span><span class="s2">referenceCount </span><span class="s1">= </span><span class="s5">1</span><span class="s1">;</span>
<a name="l1016"><span class="ln">1016 </span></a>
<a name="l1017"><span class="ln">1017 </span></a>    <span class="s3">return </span><span class="s2">ret</span><span class="s1">;</span>
<a name="l1018"><span class="ln">1018 </span></a>  <span class="s1">},</span>
<a name="l1019"><span class="ln">1019 </span></a>
<a name="l1020"><span class="ln">1020 </span></a>  <span class="s2">setupHelper</span><span class="s1">: </span><span class="s3">function </span><span class="s2">setupHelper</span><span class="s1">(</span><span class="s2">paramSize</span><span class="s1">, </span><span class="s2">name</span><span class="s1">, </span><span class="s2">blockHelper</span><span class="s1">) {</span>
<a name="l1021"><span class="ln">1021 </span></a>    <span class="s3">var </span><span class="s2">params </span><span class="s1">= [],</span>
<a name="l1022"><span class="ln">1022 </span></a>        <span class="s2">paramsInit </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">setupHelperArgs</span><span class="s1">(</span><span class="s2">name</span><span class="s1">, </span><span class="s2">paramSize</span><span class="s1">, </span><span class="s2">params</span><span class="s1">, </span><span class="s2">blockHelper</span><span class="s1">);</span>
<a name="l1023"><span class="ln">1023 </span></a>    <span class="s3">var </span><span class="s2">foundHelper </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">nameLookup</span><span class="s1">(</span><span class="s0">'helpers'</span><span class="s1">, </span><span class="s2">name</span><span class="s1">, </span><span class="s0">'helper'</span><span class="s1">),</span>
<a name="l1024"><span class="ln">1024 </span></a>        <span class="s2">callContext </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">aliasable</span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">contextName</span><span class="s1">(</span><span class="s5">0</span><span class="s1">) + </span><span class="s0">' != null ? ' </span><span class="s1">+ </span><span class="s3">this</span><span class="s1">.</span><span class="s2">contextName</span><span class="s1">(</span><span class="s5">0</span><span class="s1">) + </span><span class="s0">' : (container.nullContext || {})'</span><span class="s1">);</span>
<a name="l1025"><span class="ln">1025 </span></a>
<a name="l1026"><span class="ln">1026 </span></a>    <span class="s3">return </span><span class="s1">{</span>
<a name="l1027"><span class="ln">1027 </span></a>      <span class="s2">params</span><span class="s1">: </span><span class="s2">params</span><span class="s1">,</span>
<a name="l1028"><span class="ln">1028 </span></a>      <span class="s2">paramsInit</span><span class="s1">: </span><span class="s2">paramsInit</span><span class="s1">,</span>
<a name="l1029"><span class="ln">1029 </span></a>      <span class="s2">name</span><span class="s1">: </span><span class="s2">foundHelper</span><span class="s1">,</span>
<a name="l1030"><span class="ln">1030 </span></a>      <span class="s2">callParams</span><span class="s1">: [</span><span class="s2">callContext</span><span class="s1">].</span><span class="s2">concat</span><span class="s1">(</span><span class="s2">params</span><span class="s1">)</span>
<a name="l1031"><span class="ln">1031 </span></a>    <span class="s1">};</span>
<a name="l1032"><span class="ln">1032 </span></a>  <span class="s1">},</span>
<a name="l1033"><span class="ln">1033 </span></a>
<a name="l1034"><span class="ln">1034 </span></a>  <span class="s2">setupParams</span><span class="s1">: </span><span class="s3">function </span><span class="s2">setupParams</span><span class="s1">(</span><span class="s2">helper</span><span class="s1">, </span><span class="s2">paramSize</span><span class="s1">, </span><span class="s2">params</span><span class="s1">) {</span>
<a name="l1035"><span class="ln">1035 </span></a>    <span class="s3">var </span><span class="s2">options </span><span class="s1">= {},</span>
<a name="l1036"><span class="ln">1036 </span></a>        <span class="s2">contexts </span><span class="s1">= [],</span>
<a name="l1037"><span class="ln">1037 </span></a>        <span class="s2">types </span><span class="s1">= [],</span>
<a name="l1038"><span class="ln">1038 </span></a>        <span class="s2">ids </span><span class="s1">= [],</span>
<a name="l1039"><span class="ln">1039 </span></a>        <span class="s2">objectArgs </span><span class="s1">= !</span><span class="s2">params</span><span class="s1">,</span>
<a name="l1040"><span class="ln">1040 </span></a>        <span class="s2">param </span><span class="s1">= </span><span class="s2">undefined</span><span class="s1">;</span>
<a name="l1041"><span class="ln">1041 </span></a>
<a name="l1042"><span class="ln">1042 </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s2">objectArgs</span><span class="s1">) {</span>
<a name="l1043"><span class="ln">1043 </span></a>      <span class="s2">params </span><span class="s1">= [];</span>
<a name="l1044"><span class="ln">1044 </span></a>    <span class="s1">}</span>
<a name="l1045"><span class="ln">1045 </span></a>
<a name="l1046"><span class="ln">1046 </span></a>    <span class="s2">options</span><span class="s1">.</span><span class="s2">name </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">quotedString</span><span class="s1">(</span><span class="s2">helper</span><span class="s1">);</span>
<a name="l1047"><span class="ln">1047 </span></a>    <span class="s2">options</span><span class="s1">.</span><span class="s2">hash </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">popStack</span><span class="s1">();</span>
<a name="l1048"><span class="ln">1048 </span></a>
<a name="l1049"><span class="ln">1049 </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">trackIds</span><span class="s1">) {</span>
<a name="l1050"><span class="ln">1050 </span></a>      <span class="s2">options</span><span class="s1">.</span><span class="s2">hashIds </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">popStack</span><span class="s1">();</span>
<a name="l1051"><span class="ln">1051 </span></a>    <span class="s1">}</span>
<a name="l1052"><span class="ln">1052 </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">stringParams</span><span class="s1">) {</span>
<a name="l1053"><span class="ln">1053 </span></a>      <span class="s2">options</span><span class="s1">.</span><span class="s2">hashTypes </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">popStack</span><span class="s1">();</span>
<a name="l1054"><span class="ln">1054 </span></a>      <span class="s2">options</span><span class="s1">.</span><span class="s2">hashContexts </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">popStack</span><span class="s1">();</span>
<a name="l1055"><span class="ln">1055 </span></a>    <span class="s1">}</span>
<a name="l1056"><span class="ln">1056 </span></a>
<a name="l1057"><span class="ln">1057 </span></a>    <span class="s3">var </span><span class="s2">inverse </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">popStack</span><span class="s1">(),</span>
<a name="l1058"><span class="ln">1058 </span></a>        <span class="s2">program </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">popStack</span><span class="s1">();</span>
<a name="l1059"><span class="ln">1059 </span></a>
<a name="l1060"><span class="ln">1060 </span></a>    <span class="s4">// Avoid setting fn and inverse if neither are set. This allows</span>
<a name="l1061"><span class="ln">1061 </span></a>    <span class="s4">// helpers to do a check for `if (options.fn)`</span>
<a name="l1062"><span class="ln">1062 </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s2">program </span><span class="s1">|| </span><span class="s2">inverse</span><span class="s1">) {</span>
<a name="l1063"><span class="ln">1063 </span></a>      <span class="s2">options</span><span class="s1">.</span><span class="s2">fn </span><span class="s1">= </span><span class="s2">program </span><span class="s1">|| </span><span class="s0">'container.noop'</span><span class="s1">;</span>
<a name="l1064"><span class="ln">1064 </span></a>      <span class="s2">options</span><span class="s1">.</span><span class="s2">inverse </span><span class="s1">= </span><span class="s2">inverse </span><span class="s1">|| </span><span class="s0">'container.noop'</span><span class="s1">;</span>
<a name="l1065"><span class="ln">1065 </span></a>    <span class="s1">}</span>
<a name="l1066"><span class="ln">1066 </span></a>
<a name="l1067"><span class="ln">1067 </span></a>    <span class="s4">// The parameters go on to the stack in order (making sure that they are evaluated in order)</span>
<a name="l1068"><span class="ln">1068 </span></a>    <span class="s4">// so we need to pop them off the stack in reverse order</span>
<a name="l1069"><span class="ln">1069 </span></a>    <span class="s3">var </span><span class="s2">i </span><span class="s1">= </span><span class="s2">paramSize</span><span class="s1">;</span>
<a name="l1070"><span class="ln">1070 </span></a>    <span class="s3">while </span><span class="s1">(</span><span class="s2">i</span><span class="s1">--) {</span>
<a name="l1071"><span class="ln">1071 </span></a>      <span class="s2">param </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">popStack</span><span class="s1">();</span>
<a name="l1072"><span class="ln">1072 </span></a>      <span class="s2">params</span><span class="s1">[</span><span class="s2">i</span><span class="s1">] = </span><span class="s2">param</span><span class="s1">;</span>
<a name="l1073"><span class="ln">1073 </span></a>
<a name="l1074"><span class="ln">1074 </span></a>      <span class="s3">if </span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">trackIds</span><span class="s1">) {</span>
<a name="l1075"><span class="ln">1075 </span></a>        <span class="s2">ids</span><span class="s1">[</span><span class="s2">i</span><span class="s1">] = </span><span class="s3">this</span><span class="s1">.</span><span class="s2">popStack</span><span class="s1">();</span>
<a name="l1076"><span class="ln">1076 </span></a>      <span class="s1">}</span>
<a name="l1077"><span class="ln">1077 </span></a>      <span class="s3">if </span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">stringParams</span><span class="s1">) {</span>
<a name="l1078"><span class="ln">1078 </span></a>        <span class="s2">types</span><span class="s1">[</span><span class="s2">i</span><span class="s1">] = </span><span class="s3">this</span><span class="s1">.</span><span class="s2">popStack</span><span class="s1">();</span>
<a name="l1079"><span class="ln">1079 </span></a>        <span class="s2">contexts</span><span class="s1">[</span><span class="s2">i</span><span class="s1">] = </span><span class="s3">this</span><span class="s1">.</span><span class="s2">popStack</span><span class="s1">();</span>
<a name="l1080"><span class="ln">1080 </span></a>      <span class="s1">}</span>
<a name="l1081"><span class="ln">1081 </span></a>    <span class="s1">}</span>
<a name="l1082"><span class="ln">1082 </span></a>
<a name="l1083"><span class="ln">1083 </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s2">objectArgs</span><span class="s1">) {</span>
<a name="l1084"><span class="ln">1084 </span></a>      <span class="s2">options</span><span class="s1">.</span><span class="s2">args </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">source</span><span class="s1">.</span><span class="s2">generateArray</span><span class="s1">(</span><span class="s2">params</span><span class="s1">);</span>
<a name="l1085"><span class="ln">1085 </span></a>    <span class="s1">}</span>
<a name="l1086"><span class="ln">1086 </span></a>
<a name="l1087"><span class="ln">1087 </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">trackIds</span><span class="s1">) {</span>
<a name="l1088"><span class="ln">1088 </span></a>      <span class="s2">options</span><span class="s1">.</span><span class="s2">ids </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">source</span><span class="s1">.</span><span class="s2">generateArray</span><span class="s1">(</span><span class="s2">ids</span><span class="s1">);</span>
<a name="l1089"><span class="ln">1089 </span></a>    <span class="s1">}</span>
<a name="l1090"><span class="ln">1090 </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">stringParams</span><span class="s1">) {</span>
<a name="l1091"><span class="ln">1091 </span></a>      <span class="s2">options</span><span class="s1">.</span><span class="s2">types </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">source</span><span class="s1">.</span><span class="s2">generateArray</span><span class="s1">(</span><span class="s2">types</span><span class="s1">);</span>
<a name="l1092"><span class="ln">1092 </span></a>      <span class="s2">options</span><span class="s1">.</span><span class="s2">contexts </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">source</span><span class="s1">.</span><span class="s2">generateArray</span><span class="s1">(</span><span class="s2">contexts</span><span class="s1">);</span>
<a name="l1093"><span class="ln">1093 </span></a>    <span class="s1">}</span>
<a name="l1094"><span class="ln">1094 </span></a>
<a name="l1095"><span class="ln">1095 </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">options</span><span class="s1">.</span><span class="s2">data</span><span class="s1">) {</span>
<a name="l1096"><span class="ln">1096 </span></a>      <span class="s2">options</span><span class="s1">.</span><span class="s2">data </span><span class="s1">= </span><span class="s0">'data'</span><span class="s1">;</span>
<a name="l1097"><span class="ln">1097 </span></a>    <span class="s1">}</span>
<a name="l1098"><span class="ln">1098 </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">useBlockParams</span><span class="s1">) {</span>
<a name="l1099"><span class="ln">1099 </span></a>      <span class="s2">options</span><span class="s1">.</span><span class="s2">blockParams </span><span class="s1">= </span><span class="s0">'blockParams'</span><span class="s1">;</span>
<a name="l1100"><span class="ln">1100 </span></a>    <span class="s1">}</span>
<a name="l1101"><span class="ln">1101 </span></a>    <span class="s3">return </span><span class="s2">options</span><span class="s1">;</span>
<a name="l1102"><span class="ln">1102 </span></a>  <span class="s1">},</span>
<a name="l1103"><span class="ln">1103 </span></a>
<a name="l1104"><span class="ln">1104 </span></a>  <span class="s2">setupHelperArgs</span><span class="s1">: </span><span class="s3">function </span><span class="s2">setupHelperArgs</span><span class="s1">(</span><span class="s2">helper</span><span class="s1">, </span><span class="s2">paramSize</span><span class="s1">, </span><span class="s2">params</span><span class="s1">, </span><span class="s2">useRegister</span><span class="s1">) {</span>
<a name="l1105"><span class="ln">1105 </span></a>    <span class="s3">var </span><span class="s2">options </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">setupParams</span><span class="s1">(</span><span class="s2">helper</span><span class="s1">, </span><span class="s2">paramSize</span><span class="s1">, </span><span class="s2">params</span><span class="s1">);</span>
<a name="l1106"><span class="ln">1106 </span></a>    <span class="s2">options</span><span class="s1">.</span><span class="s2">loc </span><span class="s1">= </span><span class="s2">JSON</span><span class="s1">.</span><span class="s2">stringify</span><span class="s1">(</span><span class="s3">this</span><span class="s1">.</span><span class="s2">source</span><span class="s1">.</span><span class="s2">currentLocation</span><span class="s1">);</span>
<a name="l1107"><span class="ln">1107 </span></a>    <span class="s2">options </span><span class="s1">= </span><span class="s3">this</span><span class="s1">.</span><span class="s2">objectLiteral</span><span class="s1">(</span><span class="s2">options</span><span class="s1">);</span>
<a name="l1108"><span class="ln">1108 </span></a>    <span class="s3">if </span><span class="s1">(</span><span class="s2">useRegister</span><span class="s1">) {</span>
<a name="l1109"><span class="ln">1109 </span></a>      <span class="s3">this</span><span class="s1">.</span><span class="s2">useRegister</span><span class="s1">(</span><span class="s0">'options'</span><span class="s1">);</span>
<a name="l1110"><span class="ln">1110 </span></a>      <span class="s2">params</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s0">'options'</span><span class="s1">);</span>
<a name="l1111"><span class="ln">1111 </span></a>      <span class="s3">return </span><span class="s1">[</span><span class="s0">'options='</span><span class="s1">, </span><span class="s2">options</span><span class="s1">];</span>
<a name="l1112"><span class="ln">1112 </span></a>    <span class="s1">} </span><span class="s3">else if </span><span class="s1">(</span><span class="s2">params</span><span class="s1">) {</span>
<a name="l1113"><span class="ln">1113 </span></a>      <span class="s2">params</span><span class="s1">.</span><span class="s2">push</span><span class="s1">(</span><span class="s2">options</span><span class="s1">);</span>
<a name="l1114"><span class="ln">1114 </span></a>      <span class="s3">return </span><span class="s0">''</span><span class="s1">;</span>
<a name="l1115"><span class="ln">1115 </span></a>    <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
<a name="l1116"><span class="ln">1116 </span></a>      <span class="s3">return </span><span class="s2">options</span><span class="s1">;</span>
<a name="l1117"><span class="ln">1117 </span></a>    <span class="s1">}</span>
<a name="l1118"><span class="ln">1118 </span></a>  <span class="s1">}</span>
<a name="l1119"><span class="ln">1119 </span></a><span class="s1">};</span>
<a name="l1120"><span class="ln">1120 </span></a>
<a name="l1121"><span class="ln">1121 </span></a><span class="s1">(</span><span class="s3">function </span><span class="s1">() {</span>
<a name="l1122"><span class="ln">1122 </span></a>  <span class="s3">var </span><span class="s2">reservedWords </span><span class="s1">= (</span><span class="s0">'break else new var' </span><span class="s1">+ </span><span class="s0">' case finally return void' </span><span class="s1">+ </span><span class="s0">' catch for switch while' </span><span class="s1">+ </span><span class="s0">' continue function this with' </span><span class="s1">+ </span><span class="s0">' default if throw' </span><span class="s1">+ </span><span class="s0">' delete in try' </span><span class="s1">+ </span><span class="s0">' do instanceof typeof' </span><span class="s1">+ </span><span class="s0">' abstract enum int short' </span><span class="s1">+ </span><span class="s0">' boolean export interface static' </span><span class="s1">+ </span><span class="s0">' byte extends long super' </span><span class="s1">+ </span><span class="s0">' char final native synchronized' </span><span class="s1">+ </span><span class="s0">' class float package throws' </span><span class="s1">+ </span><span class="s0">' const goto private transient' </span><span class="s1">+ </span><span class="s0">' debugger implements protected volatile' </span><span class="s1">+ </span><span class="s0">' double import public let yield await' </span><span class="s1">+ </span><span class="s0">' null true false'</span><span class="s1">).</span><span class="s2">split</span><span class="s1">(</span><span class="s0">' '</span><span class="s1">);</span>
<a name="l1123"><span class="ln">1123 </span></a>
<a name="l1124"><span class="ln">1124 </span></a>  <span class="s3">var </span><span class="s2">compilerWords </span><span class="s1">= </span><span class="s2">JavaScriptCompiler</span><span class="s1">.</span><span class="s2">RESERVED_WORDS </span><span class="s1">= {};</span>
<a name="l1125"><span class="ln">1125 </span></a>
<a name="l1126"><span class="ln">1126 </span></a>  <span class="s3">for </span><span class="s1">(</span><span class="s3">var </span><span class="s2">i </span><span class="s1">= </span><span class="s5">0</span><span class="s1">, </span><span class="s2">l </span><span class="s1">= </span><span class="s2">reservedWords</span><span class="s1">.</span><span class="s2">length</span><span class="s1">; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">l</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
<a name="l1127"><span class="ln">1127 </span></a>    <span class="s2">compilerWords</span><span class="s1">[</span><span class="s2">reservedWords</span><span class="s1">[</span><span class="s2">i</span><span class="s1">]] = </span><span class="s3">true</span><span class="s1">;</span>
<a name="l1128"><span class="ln">1128 </span></a>  <span class="s1">}</span>
<a name="l1129"><span class="ln">1129 </span></a><span class="s1">})();</span>
<a name="l1130"><span class="ln">1130 </span></a>
<a name="l1131"><span class="ln">1131 </span></a><span class="s6">/**</span>
<a name="l1132"><span class="ln">1132 </span></a> <span class="s6">* </span><span class="s7">@deprecated </span><span class="s6">May be removed in the next major version</span>
<a name="l1133"><span class="ln">1133 </span></a> <span class="s6">*/</span>
<a name="l1134"><span class="ln">1134 </span></a><span class="s2">JavaScriptCompiler</span><span class="s1">.</span><span class="s2">isValidJavaScriptVariableName </span><span class="s1">= </span><span class="s3">function </span><span class="s1">(</span><span class="s2">name</span><span class="s1">) {</span>
<a name="l1135"><span class="ln">1135 </span></a>  <span class="s3">return </span><span class="s1">!</span><span class="s2">JavaScriptCompiler</span><span class="s1">.</span><span class="s2">RESERVED_WORDS</span><span class="s1">[</span><span class="s2">name</span><span class="s1">] &amp;&amp; </span><span class="s8">/^[a-zA-Z_$][0-9a-zA-Z_$]*$/</span><span class="s1">.</span><span class="s2">test</span><span class="s1">(</span><span class="s2">name</span><span class="s1">);</span>
<a name="l1136"><span class="ln">1136 </span></a><span class="s1">};</span>
<a name="l1137"><span class="ln">1137 </span></a>
<a name="l1138"><span class="ln">1138 </span></a><span class="s3">function </span><span class="s2">strictLookup</span><span class="s1">(</span><span class="s2">requireTerminal</span><span class="s1">, </span><span class="s2">compiler</span><span class="s1">, </span><span class="s2">parts</span><span class="s1">, </span><span class="s2">i</span><span class="s1">, </span><span class="s2">type</span><span class="s1">) {</span>
<a name="l1139"><span class="ln">1139 </span></a>  <span class="s3">var </span><span class="s2">stack </span><span class="s1">= </span><span class="s2">compiler</span><span class="s1">.</span><span class="s2">popStack</span><span class="s1">(),</span>
<a name="l1140"><span class="ln">1140 </span></a>      <span class="s2">len </span><span class="s1">= </span><span class="s2">parts</span><span class="s1">.</span><span class="s2">length</span><span class="s1">;</span>
<a name="l1141"><span class="ln">1141 </span></a>  <span class="s3">if </span><span class="s1">(</span><span class="s2">requireTerminal</span><span class="s1">) {</span>
<a name="l1142"><span class="ln">1142 </span></a>    <span class="s2">len</span><span class="s1">--;</span>
<a name="l1143"><span class="ln">1143 </span></a>  <span class="s1">}</span>
<a name="l1144"><span class="ln">1144 </span></a>
<a name="l1145"><span class="ln">1145 </span></a>  <span class="s3">for </span><span class="s1">(; </span><span class="s2">i </span><span class="s1">&lt; </span><span class="s2">len</span><span class="s1">; </span><span class="s2">i</span><span class="s1">++) {</span>
<a name="l1146"><span class="ln">1146 </span></a>    <span class="s2">stack </span><span class="s1">= </span><span class="s2">compiler</span><span class="s1">.</span><span class="s2">nameLookup</span><span class="s1">(</span><span class="s2">stack</span><span class="s1">, </span><span class="s2">parts</span><span class="s1">[</span><span class="s2">i</span><span class="s1">], </span><span class="s2">type</span><span class="s1">);</span>
<a name="l1147"><span class="ln">1147 </span></a>  <span class="s1">}</span>
<a name="l1148"><span class="ln">1148 </span></a>
<a name="l1149"><span class="ln">1149 </span></a>  <span class="s3">if </span><span class="s1">(</span><span class="s2">requireTerminal</span><span class="s1">) {</span>
<a name="l1150"><span class="ln">1150 </span></a>    <span class="s3">return </span><span class="s1">[</span><span class="s2">compiler</span><span class="s1">.</span><span class="s2">aliasable</span><span class="s1">(</span><span class="s0">'container.strict'</span><span class="s1">), </span><span class="s0">'('</span><span class="s1">, </span><span class="s2">stack</span><span class="s1">, </span><span class="s0">', '</span><span class="s1">, </span><span class="s2">compiler</span><span class="s1">.</span><span class="s2">quotedString</span><span class="s1">(</span><span class="s2">parts</span><span class="s1">[</span><span class="s2">i</span><span class="s1">]), </span><span class="s0">', '</span><span class="s1">, </span><span class="s2">JSON</span><span class="s1">.</span><span class="s2">stringify</span><span class="s1">(</span><span class="s2">compiler</span><span class="s1">.</span><span class="s2">source</span><span class="s1">.</span><span class="s2">currentLocation</span><span class="s1">), </span><span class="s0">' )'</span><span class="s1">];</span>
<a name="l1151"><span class="ln">1151 </span></a>  <span class="s1">} </span><span class="s3">else </span><span class="s1">{</span>
<a name="l1152"><span class="ln">1152 </span></a>    <span class="s3">return </span><span class="s2">stack</span><span class="s1">;</span>
<a name="l1153"><span class="ln">1153 </span></a>  <span class="s1">}</span>
<a name="l1154"><span class="ln">1154 </span></a><span class="s1">}</span>
<a name="l1155"><span class="ln">1155 </span></a>
<a name="l1156"><span class="ln">1156 </span></a><span class="s2">exports</span><span class="s1">[</span><span class="s0">'default'</span><span class="s1">] = </span><span class="s2">JavaScriptCompiler</span><span class="s1">;</span>
<a name="l1157"><span class="ln">1157 </span></a><span class="s2">module</span><span class="s1">.</span><span class="s2">exports </span><span class="s1">= </span><span class="s2">exports</span><span class="s1">[</span><span class="s0">'default'</span><span class="s1">];</span>
<a name="l1158"><span class="ln">1158 </span></a><span class="s4">//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL2xpYi9oYW5kbGViYXJzL2NvbXBpbGVyL2phdmFzY3JpcHQtY29tcGlsZXIuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7OztvQkFBb0QsU0FBUzs7eUJBQ3ZDLGNBQWM7Ozs7cUJBQ1osVUFBVTs7dUJBQ2QsWUFBWTs7OztBQUVoQyxTQUFTLE9BQU8sQ0FBQyxLQUFLLEVBQUU7QUFDdEIsTUFBSSxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUM7Q0FDcEI7O0FBRUQsU0FBUyxrQkFBa0IsR0FBRyxFQUFFOztBQUVoQyxrQkFBa0IsQ0FBQyxTQUFTLEdBQUc7OztBQUc3QixZQUFVLEVBQUUsb0JBQVMsTUFBTSxFQUFFLElBQUksZUFBZTtBQUM5QyxXQUFPLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxNQUFNLEVBQUUsSUFBSSxDQUFDLENBQUM7R0FDOUM7QUFDRCxlQUFhLEVBQUUsdUJBQVMsSUFBSSxFQUFFO0FBQzVCLFdBQU8sQ0FDTCxJQUFJLENBQUMsU0FBUyxDQUFDLGtCQUFrQixDQUFDLEVBQ2xDLFdBQVcsRUFDWCxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxFQUNwQixHQUFHLENBQ0osQ0FBQztHQUNIOztBQUVELGNBQVksRUFBRSx3QkFBVztBQUN2QixRQUFNLFFBQVEsMEJBQW9CO1FBQ2hDLFFBQVEsR0FBRyx1QkFBaUIsUUFBUSxDQUFDLENBQUM7QUFDeEMsV0FBTyxDQUFDLFFBQVEsRUFBRSxRQUFRLENBQUMsQ0FBQztHQUM3Qjs7QUFFRCxnQkFBYyxFQUFFLHdCQUFTLE1BQU0sRUFBRSxRQUFRLEVBQUUsUUFBUSxFQUFFOztBQUVuRCxRQUFJLENBQUMsZUFBUSxNQUFNLENBQUMsRUFBRTtBQUNwQixZQUFNLEdBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQztLQUNuQjtBQUNELFVBQU0sR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsUUFBUSxDQUFDLENBQUM7O0FBRTVDLFFB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LEVBQUU7QUFDbkIsU0FBSyxHQUFHLFFBQVEsQ0FBQyxVQUFVLENBQUMsS0FBSyxFQUFFLEtBQUssQ0FBQyxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUMsQ0FBQztHQUNwRDs7QUFFRCxNQUFJLGVBQWUsRUFBRTtBQUNuQixXQUFPLENBQ0wsUUFBUSxDQUFDLFNBQVMsQ0FBQyxrQkFBa0IsQ0FBQyxFQUN0QyxHQUFHLEVBQ0gsS0FBSyxFQUNMLElBQUksRUFDSixRQUFRLENBQUMsWUFBWSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUMvQixJQUFJLEVBQ0osSUFBSSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLGVBQWUsQ0FBQyxFQUMvQyxJQUFJLENBQ0wsQ0FBQztHQUNILE1BQU07QUFDTCxXQUFPLEtBQUssQ0FBQztHQUNkO0NBQ0Y7O3FCQUVjLGtCQUFrQiIsImZpbGUiOiJqYXZhc2NyaXB0LWNvbXBpbGVyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ09NUElMRVJfUkVWSVNJT04sIFJFVklTSU9OX0NIQU5HRVMgfSBmcm9tICcuLi9iYXNlJztcbmltcG9ydCBFeGNlcHRpb24gZnJvbSAnLi4vZXhjZXB0aW9uJztcbmltcG9ydCB7IGlzQXJyYXkgfSBmcm9tICcuLi91dGlscyc7XG5pbXBvcnQgQ29kZUdlbiBmcm9tICcuL2NvZGUtZ2VuJztcblxuZnVuY3Rpb24gTGl0ZXJhbCh2YWx1ZSkge1xuICB0aGlzLnZhbHVlID0gdmFsdWU7XG59XG5cbmZ1bmN0aW9uIEphdmFTY3JpcHRDb21waWxlcigpIHt9XG5cbkphdmFTY3JpcHRDb21waWxlci5wcm90b3R5cGUgPSB7XG4gIC8vIFBVQkxJQyBBUEk6IFlvdSBjYW4gb3ZlcnJpZGUgdGhlc2UgbWV0aG9kcyBpbiBhIHN1YmNsYXNzIHRvIHByb3ZpZGVcbiAgLy8gYWx0ZXJuYXRpdmUgY29tcGlsZWQgZm9ybXMgZm9yIG5hbWUgbG9va3VwIGFuZCBidWZmZXJpbmcgc2VtYW50aWNzXG4gIG5hbWVMb29rdXA6IGZ1bmN0aW9uKHBhcmVudCwgbmFtZSAvKiwgIHR5cGUgKi8pIHtcbiAgICByZXR1cm4gdGhpcy5pbnRlcm5hbE5hbWVMb29rdXAocGFyZW50LCBuYW1lKTtcbiAgfSxcbiAgZGVwdGhlZExvb2t1cDogZnVuY3Rpb24obmFtZSkge1xuICAgIHJldHVybiBbXG4gICAgICB0aGlzLmFsaWFzYWJsZSgnY29udGFpbmVyLmxvb2t1cCcpLFxuICAgICAgJyhkZXB0aHMsICcsXG4gICAgICBKU09OLnN0cmluZ2lmeShuYW1lKSxcbiAgICAgICcpJ1xuICAgIF07XG4gIH0sXG5cbiAgY29tcGlsZXJJbmZvOiBmdW5jdGlvbigpIHtcbiAgICBjb25zdCByZXZpc2lvbiA9IENPTVBJTEVSX1JFVklTSU9OLFxuICAgICAgdmVyc2lvbnMgPSBSRVZJU0lPTl9DSEFOR0VTW3JldmlzaW9uXTtcbiAgICByZXR1cm4gW3JldmlzaW9uLCB2ZXJzaW9uc107XG4gIH0sXG5cbiAgYXBwZW5kVG9CdWZmZXI6IGZ1bmN0aW9uKHNvdXJjZSwgbG9jYXRpb24sIGV4cGxpY2l0KSB7XG4gICAgLy8gRm9yY2UgYSBzb3VyY2UgYXMgdGhpcyBzaW1wbGlmaWVzIHRoZSBtZXJnZSBsb2dpYy5cbiAgICBpZiAoIWlzQXJyYXkoc291cmNlKSkge1xuICAgICAgc291cmNlID0gW3NvdXJjZV07XG4gICAgfVxuICAgIHNvdXJjZSA9IHRoaXMuc291cmNlLndyYXAoc291cmNlLCBsb2NhdGlvbik7XG5cbiAgICBpZiAodGhpcy5lbnZpcm9ubWVudC5pc1NpbXBsZSkge1xuICAgICAgcmV0dXJuIFsncmV0dXJuICcsIHNvdXJjZSwgJzsnXTtcbiAgICB9IGVsc2UgaWYgKGV4cGxpY2l0KSB7XG4gICAgICAvLyBUaGlzIGlzIGEgY2FzZSB3aGVyZSB0aGUgYnVmZmVyIG9wZXJhdGlvbiBvY2N1cnMgYXMgYSBjaGlsZCBvZiBhbm90aGVyXG4gICAgICAvLyBjb25zdHJ1Y3QsIGdlbmVyYWxseSBicmFjZXMuIFdlIGhhdmUgdG8gZXhwbGljaXRseSBvdXRwdXQgdGhlc2UgYnVmZmVyXG4gICAgICAvLyBvcGVyYXRpb25zIHRvIGVuc3VyZSB0aGF0IHRoZSBlbWl0dGVkIGNvZGUgZ29lcyBpbiB0aGUgY29ycmVjdCBsb2NhdGlvbi5cbiAgICAgIHJldHVybiBbJ2J1ZmZlciArPSAnLCBzb3VyY2UsICc7J107XG4gICAgfSBlbHNlIHtcbiAgICAgIHNvdXJjZS5hcHBlbmRUb0J1ZmZlciA9IHRydWU7XG4gICAgICByZXR1cm4gc291cmNlO1xuICAgIH1cbiAgfSxcblxuICBpbml0aWFsaXplQnVmZmVyOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5xdW90ZWRTdHJpbmcoJycpO1xuICB9LFxuICAvLyBFTkQgUFVCTElDIEFQSVxuICBpbnRlcm5hbE5hbWVMb29rdXA6IGZ1bmN0aW9uKHBhcmVudCwgbmFtZSkge1xuICAgIHRoaXMubG9va3VwUHJvcGVydHlGdW5jdGlvbklzVXNlZCA9IHRydWU7XG4gICAgcmV0dXJuIFsnbG9va3VwUHJvcGVydHkoJywgcGFyZW50LCAnLCcsIEpTT04uc3RyaW5naWZ5KG5hbWUpLCAnKSddO1xuICB9LFxuXG4gIGxvb2t1cFByb3BlcnR5RnVuY3Rpb25Jc1VzZWQ6IGZhbHNlLFxuXG4gIGNvbXBpbGU6IGZ1bmN0aW9uKGVudmlyb25tZW50LCBvcHRpb25zLCBjb250ZXh0LCBhc09iamVjdCkge1xuICAgIHRoaXMuZW52aXJvbm1lbnQgPSBlbnZpcm9ubWVudDtcbiAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xuICAgIHRoaXMuc3RyaW5nUGFyYW1zID0gdGhpcy5vcHRpb25zLnN0cmluZ1BhcmFtcztcbiAgICB0aGlzLnRyYWNrSWRzID0gdGhpcy5vcHRpb25zLnRyYWNrSWRzO1xuICAgIHRoaXMucHJlY29tcGlsZSA9ICFhc09iamVjdDtcblxuICAgIHRoaXMubmFtZSA9IHRoaXMuZW52aXJvbm1lbnQubmFtZTtcbiAgICB0aGlzLmlzQ2hpbGQgPSAhIWNvbnRleHQ7XG4gICAgdGhpcy5jb250ZXh0ID0gY29udGV4dCB8fCB7XG4gICAgICBkZWNvcmF0b3JzOiBbXSxcbiAgICAgIHByb2dyYW1zOiBbXSxcbiAgICAgIGVudmlyb25tZW50czogW11cbiAgICB9O1xuXG4gICAgdGhpcy5wcmVhbWJsZSgpO1xuXG4gICAgdGhpcy5zdGFja1Nsb3QgPSAwO1xuICAgIHRoaXMuc3RhY2tWYXJzID0gW107XG4gICAgdGhpcy5hbGlhc2VzID0ge307XG4gICAgdGhpcy5yZWdpc3RlcnMgPSB7IGxpc3Q6IFtdIH07XG4gICAgdGhpcy5oYXNoZXMgPSBbXTtcbiAgICB0aGlzLmNvbXBpbGVTdGFjayA9IFtdO1xuICAgIHRoaXMuaW5saW5lU3RhY2sgPSBbXTtcbiAgICB0aGlzLmJsb2NrUGFyYW1zID0gW107XG5cbiAgICB0aGlzLmNvbXBpbGVDaGlsZHJlbihlbnZpcm9ubWVudCwgb3B0aW9ucyk7XG5cbiAgICB0aGlzLnVzZURlcHRocyA9XG4gICAgICB0aGlzLnVzZURlcHRocyB8fFxuICAgICAgZW52aXJvbm1lbnQudXNlRGVwdGhzIHx8XG4gICAgICBlbnZpcm9ubWVudC51c2VEZWNvcmF0b3JzIHx8XG4gICAgICB0aGlzLm9wdGlvbnMuY29tcGF0O1xuICAgIHRoaXMudXNlQmxvY2tQYXJhbXMgPSB0aGlzLnVzZUJsb2NrUGFyYW1zIHx8IGVudmlyb25tZW50LnVzZUJsb2NrUGFyYW1zO1xuXG4gICAgbGV0IG9wY29kZXMgPSBlbnZpcm9ubWVudC5vcGNvZGVzLFxuICAgICAgb3Bjb2RlLFxuICAgICAgZmlyc3RMb2MsXG4gICAgICBpLFxuICAgICAgbDtcblxuICAgIGZvciAoaSA9IDAsIGwgPSBvcGNvZGVzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgb3Bjb2RlID0gb3Bjb2Rlc1tpXTtcblxuICAgICAgdGhpcy5zb3VyY2UuY3VycmVudExvY2F0aW9uID0gb3Bjb2RlLmxvYztcbiAgICAgIGZpcnN0TG9jID0gZmlyc3RMb2MgfHwgb3Bjb2RlLmxvYztcbiAgICAgIHRoaXNbb3Bjb2RlLm9wY29kZV0uYXBwbHkodGhpcywgb3Bjb2RlLmFyZ3MpO1xuICAgIH1cblxuICAgIC8vIEZsdXNoIGFueSB0cmFpbGluZyBjb250ZW50IHRoYXQgbWlnaHQgYmUgcGVuZGluZy5cbiAgICB0aGlzLnNvdXJjZS5jdXJyZW50TG9jYXRpb24gPSBmaXJzdExvYztcbiAgICB0aGlzLnB1c2hTb3VyY2UoJycpO1xuXG4gICAgLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbiAgICBpZiAodGhpcy5zdGFja1Nsb3QgfHwgdGhpcy5pbmxpbmVTdGFjay5sZW5ndGggfHwgdGhpcy5jb21waWxlU3RhY2subGVuZ3RoKSB7XG4gICAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKCdDb21waWxlIGNvbXBsZXRlZCB3aXRoIGNvbnRlbnQgbGVmdCBvbiBzdGFjaycpO1xuICAgIH1cblxuICAgIGlmICghdGhpcy5kZWNvcmF0b3JzLmlzRW1wdHkoKSkge1xuICAgICAgdGhpcy51c2VEZWNvcmF0b3JzID0gdHJ1ZTtcblxuICAgICAgdGhpcy5kZWNvcmF0b3JzLnByZXBlbmQoW1xuICAgICAgICAndmFyIGRlY29yYXRvcnMgPSBjb250YWluZXIuZGVjb3JhdG9ycywgJyxcbiAgICAgICAgdGhpcy5sb29rdXBQcm9wZXJ0eUZ1bmN0aW9uVmFyRGVjbGFyYXRpb24oKSxcbiAgICAgICAgJztcXG4nXG4gICAgICBdKTtcbiAgICAgIHRoaXMuZGVjb3JhdG9ycy5wdXNoKCdyZXR1cm4gZm47Jyk7XG5cbiAgICAgIGlmIChhc09iamVjdCkge1xuICAgICAgICB0aGlzLmRlY29yYXRvcnMgPSBGdW5jdGlvbi5hcHBseSh0aGlzLCBbXG4gICAgICAgICAgJ2ZuJyxcbiAgICAgICAgICAncHJvcHMnLFxuICAgICAgICAgICdjb250YWluZXInLFxuICAgICAgICAgICdkZXB0aDAnLFxuICAgICAgICAgICdkYXRhJyxcbiAgICAgICAgICAnYmxvY2tQYXJhbXMnLFxuICAgICAgICAgICdkZXB0aHMnLFxuICAgICAgICAgIHRoaXMuZGVjb3JhdG9ycy5tZXJnZSgpXG4gICAgICAgIF0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5kZWNvcmF0b3JzLnByZXBlbmQoXG4gICAgICAgICAgJ2Z1bmN0aW9uKGZuLCBwcm9wcywgY29udGFpbmVyLCBkZXB0aDAsIGRhdGEsIGJsb2NrUGFyYW1zLCBkZXB0aHMpIHtcXG4nXG4gICAgICAgICk7XG4gICAgICAgIHRoaXMuZGVjb3JhdG9ycy5wdXNoKCd9XFxuJyk7XG4gICAgICAgIHRoaXMuZGVjb3JhdG9ycyA9IHRoaXMuZGVjb3JhdG9ycy5tZXJnZSgpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmRlY29yYXRvcnMgPSB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgbGV0IGZuID0gdGhpcy5jcmVhdGVGdW5jdGlvbkNvbnRleHQoYXNPYmplY3QpO1xuICAgIGlmICghdGhpcy5pc0NoaWxkKSB7XG4gICAgICBsZXQgcmV0ID0ge1xuICAgICAgICBjb21waWxlcjogdGhpcy5jb21waWxlckluZm8oKSxcbiAgICAgICAgbWFpbjogZm5cbiAgICAgIH07XG5cbiAgICAgIGlmICh0aGlzLmRlY29yYXRvcnMpIHtcbiAgICAgICAgcmV0Lm1haW5fZCA9IHRoaXMuZGVjb3JhdG9yczsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBjYW1lbGNhc2VcbiAgICAgICAgcmV0LnVzZURlY29yYXRvcnMgPSB0cnVlO1xuICAgICAgfVxuXG4gICAgICBsZXQgeyBwcm9ncmFtcywgZGVjb3JhdG9ycyB9ID0gdGhpcy5jb250ZXh0O1xuICAgICAgZm9yIChpID0gMCwgbCA9IHByb2dyYW1zLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICBpZiAocHJvZ3JhbXNbaV0pIHtcbiAgICAgICAgICByZXRbaV0gPSBwcm9ncmFtc1tpXTtcbiAgICAgICAgICBpZiAoZGVjb3JhdG9yc1tpXSkge1xuICAgICAgICAgICAgcmV0W2kgKyAnX2QnXSA9IGRlY29yYXRvcnNbaV07XG4gICAgICAgICAgICByZXQudXNlRGVjb3JhdG9ycyA9IHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLmVudmlyb25tZW50LnVzZVBhcnRpYWwpIHtcbiAgICAgICAgcmV0LnVzZVBhcnRpYWwgPSB0cnVlO1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMub3B0aW9ucy5kYXRhKSB7XG4gICAgICAgIHJldC51c2VEYXRhID0gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLnVzZURlcHRocykge1xuICAgICAgICByZXQudXNlRGVwdGhzID0gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLnVzZUJsb2NrUGFyYW1zKSB7XG4gICAgICAgIHJldC51c2VCbG9ja1BhcmFtcyA9IHRydWU7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5vcHRpb25zLmNvbXBhdCkge1xuICAgICAgICByZXQuY29tcGF0ID0gdHJ1ZTtcbiAgICAgIH1cblxuICAgICAgaWYgKCFhc09iamVjdCkge1xuICAgICAgICByZXQuY29tcGlsZXIgPSBKU09OLnN0cmluZ2lmeShyZXQuY29tcGlsZXIpO1xuXG4gICAgICAgIHRoaXMuc291cmNlLmN1cnJlbnRMb2NhdGlvbiA9IHsgc3RhcnQ6IHsgbGluZTogMSwgY29sdW1uOiAwIH0gfTtcbiAgICAgICAgcmV0ID0gdGhpcy5vYmplY3RMaXRlcmFsKHJldCk7XG5cbiAgICAgICAgaWYgKG9wdGlvbnMuc3JjTmFtZSkge1xuICAgICAgICAgIHJldCA9IHJldC50b1N0cmluZ1dpdGhTb3VyY2VNYXAoeyBmaWxlOiBvcHRpb25zLmRlc3ROYW1lIH0pO1xuICAgICAgICAgIHJldC5tYXAgPSByZXQubWFwICYmIHJldC5tYXAudG9TdHJpbmcoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXQgPSByZXQudG9TdHJpbmcoKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0LmNvbXBpbGVyT3B0aW9ucyA9IHRoaXMub3B0aW9ucztcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHJldDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGZuO1xuICAgIH1cbiAgfSxcblxuICBwcmVhbWJsZTogZnVuY3Rpb24oKSB7XG4gICAgLy8gdHJhY2sgdGhlIGxhc3QgY29udGV4dCBwdXNoZWQgaW50byBwbGFjZSB0byBhbGxvdyBza2lwcGluZyB0aGVcbiAgICAvLyBnZXRDb250ZXh0IG9wY29kZSB3aGVuIGl0IHdvdWxkIGJlIGEgbm9vcFxuICAgIHRoaXMubGFzdENvbnRleHQgPSAwO1xuICAgIHRoaXMuc291cmNlID0gbmV3IENvZGVHZW4odGhpcy5vcHRpb25zLnNyY05hbWUpO1xuICAgIHRoaXMuZGVjb3JhdG9ycyA9IG5ldyBDb2RlR2VuKHRoaXMub3B0aW9ucy5zcmNOYW1lKTtcbiAgfSxcblxuICBjcmVhdGVGdW5jdGlvbkNvbnRleHQ6IGZ1bmN0aW9uKGFzT2JqZWN0KSB7XG4gICAgbGV0IHZhckRlY2xhcmF0aW9ucyA9ICcnO1xuXG4gICAgbGV0IGxvY2FscyA9IHRoaXMuc3RhY2tWYXJzLmNvbmNhdCh0aGlzLnJlZ2lzdGVycy5saXN0KTtcbiAgICBpZiAobG9jYWxzLmxlbmd0aCA+IDApIHtcbiAgICAgIHZhckRlY2xhcmF0aW9ucyArPSAnLCAnICsgbG9jYWxzLmpvaW4oJywgJyk7XG4gICAgfVxuXG4gICAgLy8gR2VuZXJhdGUgbWluaW1pemVyIGFsaWFzIG1hcHBpbmdzXG4gICAgLy9cbiAgICAvLyBXaGVuIHVzaW5nIHRydWUgU291cmNlTm9kZXMsIHRoaXMgd2lsbCB1cGRhdGUgYWxsIHJlZmVyZW5jZXMgdG8gdGhlIGdpdmVuIGFsaWFzXG4gICAgLy8gYXMgdGhlIHNvdXJjZSBub2RlcyBhcmUgcmV1c2VkIGluIHNpdHUuIEZvciB0aGUgbm9uLXNvdXJjZSBub2RlIGNvbXBpbGF0aW9uIG1vZGUsXG4gICAgLy8gYWxpYXNlcyB3aWxsIG5vdCBiZSB1c2VkLCBidXQgdGhpcyBjYXNlIGlzIGFscmVhZHkgYmVpbmcgcnVuIG9uIHRoZSBjbGllbnQgYW5kXG4gICAgLy8gd2UgYXJlbid0IGNvbmNlcm4gYWJvdXQgbWluaW1pemluZyB0aGUgdGVtcGxhdGUgc2l6ZS5cbiAgICBsZXQgYWxpYXNDb3VudCA9IDA7XG4gICAgT2JqZWN0LmtleXModGhpcy5hbGlhc2VzKS5mb3JFYWNoKGFsaWFzID0+IHtcbiAgICAgIGxldCBub2RlID0gdGhpcy5hbGlhc2VzW2FsaWFzXTtcbiAgICAgIGlmIChub2RlLmNoaWxkcmVuICYmIG5vZGUucmVmZXJlbmNlQ291bnQgPiAxKSB7XG4gICAgICAgIHZhckRlY2xhcmF0aW9ucyArPSAnLCBhbGlhcycgKyArK2FsaWFzQ291bnQgKyAnPScgKyBhbGlhcztcbiAgICAgICAgbm9kZS5jaGlsZHJlblswXSA9ICdhbGlhcycgKyBhbGlhc0NvdW50O1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaWYgKHRoaXMubG9va3VwUHJvcGVydHlGdW5jdGlvbklzVXNlZCkge1xuICAgICAgdmFyRGVjbGFyYXRpb25zICs9ICcsICcgKyB0aGlzLmxvb2t1cFByb3BlcnR5RnVuY3Rpb25WYXJEZWNsYXJhdGlvbigpO1xuICAgIH1cblxuICAgIGxldCBwYXJhbXMgPSBbJ2NvbnRhaW5lcicsICdkZXB0aDAnLCAnaGVscGVycycsICdwYXJ0aWFscycsICdkYXRhJ107XG5cbiAgICBpZiAodGhpcy51c2VCbG9ja1BhcmFtcyB8fCB0aGlzLnVzZURlcHRocykge1xuICAgICAgcGFyYW1zLnB1c2goJ2Jsb2NrUGFyYW1zJyk7XG4gICAgfVxuICAgIGlmICh0aGlzLnVzZURlcHRocykge1xuICAgICAgcGFyYW1zLnB1c2goJ2RlcHRocycpO1xuICAgIH1cblxuICAgIC8vIFBlcmZvcm0gYSBzZWNvbmQgcGFzcyBvdmVyIHRoZSBvdXRwdXQgdG8gbWVyZ2UgY29udGVudCB3aGVuIHBvc3NpYmxlXG4gICAgbGV0IHNvdXJjZSA9IHRoaXMubWVyZ2VTb3VyY2UodmFyRGVjbGFyYXRpb25zKTtcblxuICAgIGlmIChhc09iamVjdCkge1xuICAgICAgcGFyYW1zLnB1c2goc291cmNlKTtcblxuICAgICAgcmV0dXJuIEZ1bmN0aW9uLmFwcGx5KHRoaXMsIHBhcmFtcyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0aGlzLnNvdXJjZS53cmFwKFtcbiAgICAgICAgJ2Z1bmN0aW9uKCcsXG4gICAgICAgIHBhcmFtcy5qb2luKCcsJyksXG4gICAgICAgICcpIHtcXG4gICcsXG4gICAgICAgIHNvdXJjZSxcbiAgICAgICAgJ30nXG4gICAgICBdKTtcbiAgICB9XG4gIH0sXG4gIG1lcmdlU291cmNlOiBmdW5jdGlvbih2YXJEZWNsYXJhdGlvbnMpIHtcbiAgICBsZXQgaXNTaW1wbGUgPSB0aGlzLmVudmlyb25tZW50LmlzU2ltcGxlLFxuICAgICAgYXBwZW5kT25seSA9ICF0aGlzLmZvcmNlQnVmZmVyLFxuICAgICAgYXBwZW5kRmlyc3QsXG4gICAgICBzb3VyY2VTZWVuLFxuICAgICAgYnVmZmVyU3RhcnQsXG4gICAgICBidWZmZXJFbmQ7XG4gICAgdGhpcy5zb3VyY2UuZWFjaChsaW5lID0+IHtcbiAgICAgIGlmIChsaW5lLmFwcGVuZFRvQnVmZmVyKSB7XG4gICAgICAgIGlmIChidWZmZXJTdGFydCkge1xuICAgICAgICAgIGxpbmUucHJlcGVuZCgnICArICcpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGJ1ZmZlclN0YXJ0ID0gbGluZTtcbiAgICAgICAgfVxuICAgICAgICBidWZmZXJFbmQgPSBsaW5lO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKGJ1ZmZlclN0YXJ0KSB7XG4gICAgICAgICAgaWYgKCFzb3VyY2VTZWVuKSB7XG4gICAgICAgICAgICBhcHBlbmRGaXJzdCA9IHRydWU7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGJ1ZmZlclN0YXJ0LnByZXBlbmQoJ2J1ZmZlciArPSAnKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYnVmZmVyRW5kLmFkZCgnOycpO1xuICAgICAgICAgIGJ1ZmZlclN0YXJ0ID0gYnVmZmVyRW5kID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG5cbiAgICAgICAgc291cmNlU2VlbiA9IHRydWU7XG4gICAgICAgIGlmICghaXNTaW1wbGUpIHtcbiAgICAgICAgICBhcHBlbmRPbmx5ID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGlmIChhcHBlbmRPbmx5KSB7XG4gICAgICBpZiAoYnVmZmVyU3RhcnQpIHtcbiAgICAgICAgYnVmZmVyU3RhcnQucHJlcGVuZCgncmV0dXJuICcpO1xuICAgICAgICBidWZmZXJFbmQuYWRkKCc7Jyk7XG4gICAgICB9IGVsc2UgaWYgKCFzb3VyY2VTZWVuKSB7XG4gICAgICAgIHRoaXMuc291cmNlLnB1c2goJ3JldHVybiBcIlwiOycpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB2YXJEZWNsYXJhdGlvbnMgKz1cbiAgICAgICAgJywgYnVmZmVyID0gJyArIChhcHBlbmRGaXJzdCA/ICcnIDogdGhpcy5pbml0aWFsaXplQnVmZmVyKCkpO1xuXG4gICAgICBpZiAoYnVmZmVyU3RhcnQpIHtcbiAgICAgICAgYnVmZmVyU3RhcnQucHJlcGVuZCgncmV0dXJuIGJ1ZmZlciArICcpO1xuICAgICAgICBidWZmZXJFbmQuYWRkKCc7Jyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnNvdXJjZS5wdXNoKCdyZXR1cm4gYnVmZmVyOycpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmICh2YXJEZWNsYXJhdGlvbnMpIHtcbiAgICAgIHRoaXMuc291cmNlLnByZXBlbmQoXG4gICAgICAgICd2YXIgJyArIHZhckRlY2xhcmF0aW9ucy5zdWJzdHJpbmcoMikgKyAoYXBwZW5kRmlyc3QgPyAnJyA6ICc7XFxuJylcbiAgICAgICk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuc291cmNlLm1lcmdlKCk7XG4gIH0sXG5cbiAgbG9va3VwUHJvcGVydHlGdW5jdGlvblZhckRlY2xhcmF0aW9uOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gYFxuICAgICAgbG9va3VwUHJvcGVydHkgPSBjb250YWluZXIubG9va3VwUHJvcGVydHkgfHwgZnVuY3Rpb24ocGFyZW50LCBwcm9wZXJ0eU5hbWUpIHtcbiAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChwYXJlbnQsIHByb3BlcnR5TmFtZSkpIHtcbiAgICAgICAgICByZXR1cm4gcGFyZW50W3Byb3BlcnR5TmFtZV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZFxuICAgIH1cbiAgICBgLnRyaW0oKTtcbiAgfSxcblxuICAvLyBbYmxvY2tWYWx1ZV1cbiAgLy9cbiAgLy8gT24gc3RhY2ssIGJlZm9yZTogaGFzaCwgaW52ZXJzZSwgcHJvZ3JhbSwgdmFsdWVcbiAgLy8gT24gc3RhY2ssIGFmdGVyOiByZXR1cm4gdmFsdWUgb2YgYmxvY2tIZWxwZXJNaXNzaW5nXG4gIC8vXG4gIC8vIFRoZSBwdXJwb3NlIG9mIHRoaXMgb3Bjb2RlIGlzIHRvIHRha2UgYSBibG9jayBvZiB0aGUgZm9ybVxuICAvLyBge3sjdGhpcy5mb299fS4uLnt7L3RoaXMuZm9vfX1gLCByZXNvbHZlIHRoZSB2YWx1ZSBvZiBgZm9vYCwgYW5kXG4gIC8vIHJlcGxhY2UgaXQgb24gdGhlIHN0YWNrIHdpdGggdGhlIHJlc3VsdCBvZiBwcm9wZXJseVxuICAvLyBpbnZva2luZyBibG9ja0hlbHBlck1pc3NpbmcuXG4gIGJsb2NrVmFsdWU6IGZ1bmN0aW9uKG5hbWUpIHtcbiAgICBsZXQgYmxvY2tIZWxwZXJNaXNzaW5nID0gdGhpcy5hbGlhc2FibGUoXG4gICAgICAgICdjb250YWluZXIuaG9va3MuYmxvY2tIZWxwZXJNaXNzaW5nJ1xuICAgICAgKSxcbiAgICAgIHBhcmFtcyA9IFt0aGlzLmNvbnRleHROYW1lKDApXTtcbiAgICB0aGlzLnNldHVwSGVscGVyQXJncyhuYW1lLCAwLCBwYXJhbXMpO1xuXG4gICAgbGV0IGJsb2NrTmFtZSA9IHRoaXMucG9wU3RhY2soKTtcbiAgICBwYXJhbXMuc3BsaWNlKDEsIDAsIGJsb2NrTmFtZSk7XG5cbiAgICB0aGlzLnB1c2godGhpcy5zb3VyY2UuZnVuY3Rpb25DYWxsKGJsb2NrSGVscGVyTWlzc2luZywgJ2NhbGwnLCBwYXJhbXMpKTtcbiAgfSxcblxuICAvLyBbYW1iaWd1b3VzQmxvY2tWYWx1ZV1cbiAgLy9cbiAgLy8gT24gc3RhY2ssIGJlZm9yZTogaGFzaCwgaW52ZXJzZSwgcHJvZ3JhbSwgdmFsdWVcbiAgLy8gQ29tcGlsZXIgdmFsdWUsIGJlZm9yZTogbGFzdEhlbHBlcj12YWx1ZSBvZiBsYXN0IGZvdW5kIGhlbHBlciwgaWYgYW55XG4gIC8vIE9uIHN0YWNrLCBhZnRlciwgaWYgbm8gbGFzdEhlbHBlcjogc2FtZSBhcyBbYmxvY2tWYWx1ZV1cbiAgLy8gT24gc3RhY2ssIGFmdGVyLCBpZiBsYXN0SGVscGVyOiB2YWx1ZVxuICBhbWJpZ3VvdXNCbG9ja1ZhbHVlOiBmdW5jdGlvbigpIHtcbiAgICAvLyBXZSdyZSBiZWluZyBhIGJpdCBjaGVla3kgYW5kIHJldXNpbmcgdGhlIG9wdGlvbnMgdmFsdWUgZnJvbSB0aGUgcHJpb3IgZXhlY1xuICAgIGxldCBibG9ja0hlbHBlck1pc3NpbmcgPSB0aGlzLmFsaWFzYWJsZShcbiAgICAgICAgJ2NvbnRhaW5lci5ob29rcy5ibG9ja0hlbHBlck1pc3NpbmcnXG4gICAgICApLFxuICAgICAgcGFyYW1zID0gW3RoaXMuY29udGV4dE5hbWUoMCldO1xuICAgIHRoaXMuc2V0dXBIZWxwZXJBcmdzKCcnLCAwLCBwYXJhbXMsIHRydWUpO1xuXG4gICAgdGhpcy5mbHVzaElubGluZSgpO1xuXG4gICAgbGV0IGN1cnJlbnQgPSB0aGlzLnRvcFN0YWNrKCk7XG4gICAgcGFyYW1zLnNwbGljZSgxLCAwLCBjdXJyZW50KTtcblxuICAgIHRoaXMucHVzaFNvdXJjZShbXG4gICAgICAnaWYgKCEnLFxuICAgICAgdGhpcy5sYXN0SGVscGVyLFxuICAgICAgJykgeyAnLFxuICAgICAgY3VycmVudCxcbiAgICAgICcgPSAnLFxuICAgICAgdGhpcy5zb3VyY2UuZnVuY3Rpb25DYWxsKGJsb2NrSGVscGVyTWlzc2luZywgJ2NhbGwnLCBwYXJhbXMpLFxuICAgICAgJ30nXG4gICAgXSk7XG4gIH0sXG5cbiAgLy8gW2FwcGVuZENvbnRlbnRdXG4gIC8vXG4gIC8vIE9uIHN0YWNrLCBiZWZvcmU6IC4uLlxuICAvLyBPbiBzdGFjaywgYWZ0ZXI6IC4uLlxuICAvL1xuICAvLyBBcHBlbmRzIHRoZSBzdHJpbmcgdmFsdWUgb2YgYGNvbnRlbnRgIHRvIHRoZSBjdXJyZW50IGJ1ZmZlclxuICBhcHBlbmRDb250ZW50OiBmdW5jdGlvbihjb250ZW50KSB7XG4gICAgaWYgKHRoaXMucGVuZGluZ0NvbnRlbnQpIHtcbiAgICAgIGNvbnRlbnQgPSB0aGlzLnBlbmRpbmdDb250ZW50ICsgY29udGVudDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5wZW5kaW5nTG9jYXRpb24gPSB0aGlzLnNvdXJjZS5jdXJyZW50TG9jYXRpb247XG4gICAgfVxuXG4gICAgdGhpcy5wZW5kaW5nQ29udGVudCA9IGNvbnRlbnQ7XG4gIH0sXG5cbiAgLy8gW2FwcGVuZF1cbiAgLy9cbiAgLy8gT24gc3RhY2ssIGJlZm9yZTogdmFsdWUsIC4uLlxuICAvLyBPbiBzdGFjaywgYWZ0ZXI6IC4uLlxuICAvL1xuICAvLyBDb2VyY2VzIGB2YWx1ZWAgdG8gYSBTdHJpbmcgYW5kIGFwcGVuZHMgaXQgdG8gdGhlIGN1cnJlbnQgYnVmZmVyLlxuICAvL1xuICAvLyBJZiBgdmFsdWVgIGlzIHRydXRoeSwgb3IgMCwgaXQgaXMgY29lcmNlZCBpbnRvIGEgc3RyaW5nIGFuZCBhcHBlbmRlZFxuICAvLyBPdGhlcndpc2UsIHRoZSBlbXB0eSBzdHJpbmcgaXMgYXBwZW5kZWRcbiAgYXBwZW5kOiBmdW5jdGlvbigpIHtcbiAgICBpZiAodGhpcy5pc0lubGluZSgpKSB7XG4gICAgICB0aGlzLnJlcGxhY2VTdGFjayhjdXJyZW50ID0+IFsnICE9IG51bGwgPyAnLCBjdXJyZW50LCAnIDogXCJcIiddKTtcblxuICAgICAgdGhpcy5wdXNoU291cmNlKHRoaXMuYXBwZW5kVG9CdWZmZXIodGhpcy5wb3BTdGFjaygpKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGxldCBsb2NhbCA9IHRoaXMucG9wU3RhY2soKTtcbiAgICAgIHRoaXMucHVzaFNvdXJjZShbXG4gICAgICAgICdpZiAoJyxcbiAgICAgICAgbG9jYWwsXG4gICAgICAgICcgIT0gbnVsbCkgeyAnLFxuICAgICAgICB0aGlzLmFwcGVuZFRvQnVmZmVyKGxvY2FsLCB1bmRlZmluZWQsIHRydWUpLFxuICAgICAgICAnIH0nXG4gICAgICBdKTtcbiAgICAgIGlmICh0aGlzLmVudmlyb25tZW50LmlzU2ltcGxlKSB7XG4gICAgICAgIHRoaXMucHVzaFNvdXJjZShbXG4gICAgICAgICAgJ2Vsc2UgeyAnLFxuICAgICAgICAgIHRoaXMuYXBwZW5kVG9CdWZmZXIoXCInJ1wiLCB1bmRlZmluZWQsIHRydWUpLFxuICAgICAgICAgICcgfSdcbiAgICAgICAgXSk7XG4gICAgICB9XG4gICAgfVxuICB9LFxuXG4gIC8vIFthcHBlbmRFc2NhcGVkXVxuICAvL1xuICAvLyBPbiBzdGFjaywgYmVmb3JlOiB2YWx1ZSwgLi4uXG4gIC8vIE9uIHN0YWNrLCBhZnRlcjogLi4uXG4gIC8vXG4gIC8vIEVzY2FwZSBgdmFsdWVgIGFuZCBhcHBlbmQgaXQgdG8gdGhlIGJ1ZmZlclxuICBhcHBlbmRFc2NhcGVkOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLnB1c2hTb3VyY2UoXG4gICAgICB0aGlzLmFwcGVuZFRvQnVmZmVyKFtcbiAgICAgICAgdGhpcy5hbGlhc2FibGUoJ2NvbnRhaW5lci5lc2NhcGVFeHByZXNzaW9uJyksXG4gICAgICAgICcoJyxcbiAgICAgICAgdGhpcy5wb3BTdGFjaygpLFxuICAgICAgICAnKSdcbiAgICAgIF0pXG4gICAgKTtcbiAgfSxcblxuICAvLyBbZ2V0Q29udGV4dF1cbiAgLy9cbiAgLy8gT24gc3RhY2ssIGJlZm9yZTogLi4uXG4gIC8vIE9uIHN0YWNrLCBhZnRlcjogLi4uXG4gIC8vIENvbXBpbGVyIHZhbHVlLCBhZnRlcjogbGFzdENvbnRleHQ9ZGVwdGhcbiAgLy9cbiAgLy8gU2V0IHRoZSB2YWx1ZSBvZiB0aGUgYGxhc3RDb250ZXh0YCBjb21waWxlciB2YWx1ZSB0byB0aGUgZGVwdGhcbiAgZ2V0Q29udGV4dDogZnVuY3Rpb24oZGVwdGgpIHtcbiAgICB0aGlzLmxhc3RDb250ZXh0ID0gZGVwdGg7XG4gIH0sXG5cbiAgLy8gW3B1c2hDb250ZXh0XVxuICAvL1xuICAvLyBPbiBzdGFjaywgYmVmb3JlOiAuLi5cbiAgLy8gT24gc3RhY2ssIGFmdGVyOiBjdXJyZW50Q29udGV4dCwgLi4uXG4gIC8vXG4gIC8vIFB1c2hlcyB0aGUgdmFsdWUgb2YgdGhlIGN1cnJlbnQgY29udGV4dCBvbnRvIHRoZSBzdGFjay5cbiAgcHVzaENvbnRleHQ6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMucHVzaFN0YWNrTGl0ZXJhbCh0aGlzLmNvbnRleHROYW1lKHRoaXMubGFzdENvbnRleHQpKTtcbiAgfSxcblxuICAvLyBbbG9va3VwT25Db250ZXh0XVxuICAvL1xuICAvLyBPbiBzdGFjaywgYmVmb3JlOiAuLi5cbiAgLy8gT24gc3RhY2ssIGFmdGVyOiBjdXJyZW50Q29udGV4dFtuYW1lXSwgLi4uXG4gIC8vXG4gIC8vIExvb2tzIHVwIHRoZSB2YWx1ZSBvZiBgbmFtZWAgb24gdGhlIGN1cnJlbnQgY29udGV4dCBhbmQgcHVzaGVzXG4gIC8vIGl0IG9udG8gdGhlIHN0YWNrLlxuICBsb29rdXBPbkNvbnRleHQ6IGZ1bmN0aW9uKHBhcnRzLCBmYWxzeSwgc3RyaWN0LCBzY29wZWQpIHtcbiAgICBsZXQgaSA9IDA7XG5cbiAgICBpZiAoIXNjb3BlZCAmJiB0aGlzLm9wdGlvbnMuY29tcGF0ICYmICF0aGlzLmxhc3RDb250ZXh0KSB7XG4gICAgICAvLyBUaGUgZGVwdGhlZCBxdWVyeSBpcyBleHBlY3RlZCB0byBoYW5kbGUgdGhlIHVuZGVmaW5lZCBsb2dpYyBmb3IgdGhlIHJvb3QgbGV2ZWwgdGhhdFxuICAgICAgLy8gaXMgaW1wbGVtZW50ZWQgYmVsb3csIHNvIHdlIGV2YWx1YXRlIHRoYXQgZGlyZWN0bHkgaW4gY29tcGF0IG1vZGVcbiAgICAgIHRoaXMucHVzaCh0aGlzLmRlcHRoZWRMb29rdXAocGFydHNbaSsrXSkpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnB1c2hDb250ZXh0KCk7XG4gICAgfVxuXG4gICAgdGhpcy5yZXNvbHZlUGF0aCgnY29udGV4dCcsIHBhcnRzLCBpLCBmYWxzeSwgc3RyaWN0KTtcbiAgfSxcblxuICAvLyBbbG9va3VwQmxvY2tQYXJhbV1cbiAgLy9cbiAgLy8gT24gc3RhY2ssIGJlZm9yZTogLi4uXG4gIC8vIE9uIHN0YWNrLCBhZnRlcjogYmxvY2tQYXJhbVtuYW1lXSwgLi4uXG4gIC8vXG4gIC8vIExvb2tzIHVwIHRoZSB2YWx1ZSBvZiBgcGFydHNgIG9uIHRoZSBnaXZlbiBibG9jayBwYXJhbSBhbmQgcHVzaGVzXG4gIC8vIGl0IG9udG8gdGhlIHN0YWNrLlxuICBsb29rdXBCbG9ja1BhcmFtOiBmdW5jdGlvbihibG9ja1BhcmFtSWQsIHBhcnRzKSB7XG4gICAgdGhpcy51c2VCbG9ja1BhcmFtcyA9IHRydWU7XG5cbiAgICB0aGlzLnB1c2goWydibG9ja1BhcmFtc1snLCBibG9ja1BhcmFtSWRbMF0sICddWycsIGJsb2NrUGFyYW1JZFsxXSwgJ10nXSk7XG4gICAgdGhpcy5yZXNvbHZlUGF0aCgnY29udGV4dCcsIHBhcnRzLCAxKTtcbiAgfSxcblxuICAvLyBbbG9va3VwRGF0YV1cbiAgLy9cbiAgLy8gT24gc3RhY2ssIGJlZm9yZTogLi4uXG4gIC8vIE9uIHN0YWNrLCBhZnRlcjogZGF0YSwgLi4uXG4gIC8vXG4gIC8vIFB1c2ggdGhlIGRhdGEgbG9va3VwIG9wZXJhdG9yXG4gIGxvb2t1cERhdGE6IGZ1bmN0aW9uKGRlcHRoLCBwYXJ0cywgc3RyaWN0KSB7XG4gICAgaWYgKCFkZXB0aCkge1xuICAgICAgdGhpcy5wdXNoU3RhY2tMaXRlcmFsKCdkYXRhJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMucHVzaFN0YWNrTGl0ZXJhbCgnY29udGFpbmVyLmRhdGEoZGF0YSwgJyArIGRlcHRoICsgJyknKTtcbiAgICB9XG5cbiAgICB0aGlzLnJlc29sdmVQYXRoKCdkYXRhJywgcGFydHMsIDAsIHRydWUsIHN0cmljdCk7XG4gIH0sXG5cbiAgcmVzb2x2ZVBhdGg6IGZ1bmN0aW9uKHR5cGUsIHBhcnRzLCBpLCBmYWxzeSwgc3RyaWN0KSB7XG4gICAgaWYgKHRoaXMub3B0aW9ucy5zdHJpY3QgfHwgdGhpcy5vcHRpb25zLmFzc3VtZU9iamVjdHMpIHtcbiAgICAgIHRoaXMucHVzaChcbiAgICAgICAgc3RyaWN0TG9va3VwKHRoaXMub3B0aW9ucy5zdHJpY3QgJiYgc3RyaWN0LCB0aGlzLCBwYXJ0cywgaSwgdHlwZSlcbiAgICAgICk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgbGV0IGxlbiA9IHBhcnRzLmxlbmd0aDtcbiAgICBmb3IgKDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAvKiBlc2xpbnQtZGlzYWJsZSBuby1sb29wLWZ1bmMgKi9cbiAgICAgIHRoaXMucmVwbGFjZVN0YWNrKGN1cnJlbnQgPT4ge1xuICAgICAgICBsZXQgbG9va3VwID0gdGhpcy5uYW1lTG9va3VwKGN1cnJlbnQsIHBhcnRzW2ldLCB0eXBlKTtcbiAgICAgICAgLy8gV2Ugd2FudCB0byBlbnN1cmUgdGhhdCB6ZXJvIGFuZCBmYWxzZSBhcmUgaGFuZGxlZCBwcm9wZXJseSBpZiB0aGUgY29udGV4dCAoZmFsc3kgZmxhZylcbiAgICAgICAgLy8gbmVlZHMgdG8gaGF2ZSB0aGUgc3BlY2lhbCBoYW5kbGluZyBmb3IgdGhlc2UgdmFsdWVzLlxuICAgICAgICBpZiAoIWZhbHN5KSB7XG4gICAgICAgICAgcmV0dXJuIFsnICE9IG51bGwgPyAnLCBsb29rdXAsICcgOiAnLCBjdXJyZW50XTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBPdGhlcndpc2Ugd2UgY2FuIHVzZSBnZW5lcmljIGZhbHN5IGhhbmRsaW5nXG4gICAgICAgICAgcmV0dXJuIFsnICYmICcsIGxvb2t1cF07XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgLyogZXNsaW50LWVuYWJsZSBuby1sb29wLWZ1bmMgKi9cbiAgICB9XG4gIH0sXG5cbiAgLy8gW3Jlc29sdmVQb3NzaWJsZUxhbWJkYV1cbiAgLy9cbiAgLy8gT24gc3RhY2ssIGJlZm9yZTogdmFsdWUsIC4uLlxuICAvLyBPbiBzdGFjaywgYWZ0ZXI6IHJlc29sdmVkIHZhbHVlLCAuLi5cbiAgLy9cbiAgLy8gSWYgdGhlIGB2YWx1ZWAgaXMgYSBsYW1iZGEsIHJlcGxhY2UgaXQgb24gdGhlIHN0YWNrIGJ5XG4gIC8vIHRoZSByZXR1cm4gdmFsdWUgb2YgdGhlIGxhbWJkYVxuICByZXNvbHZlUG9zc2libGVMYW1iZGE6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMucHVzaChbXG4gICAgICB0aGlzLmFsaWFzYWJsZSgnY29udGFpbmVyLmxhbWJkYScpLFxuICAgICAgJygnLFxuICAgICAgdGhpcy5wb3BTdGFjaygpLFxuICAgICAgJywgJyxcbiAgICAgIHRoaXMuY29udGV4dE5hbWUoMCksXG4gICAgICAnKSdcbiAgICBdKTtcbiAgfSxcblxuICAvLyBbcHVzaFN0cmluZ1BhcmFtXVxuICAvL1xuICAvLyBPbiBzdGFjaywgYmVmb3JlOiAuLi5cbiAgLy8gT24gc3RhY2ssIGFmdGVyOiBzdHJpbmcsIGN1cnJlbnRDb250ZXh0LCAuLi5cbiAgLy9cbiAgLy8gVGhpcyBvcGNvZGUgaXMgZGVzaWduZWQgZm9yIHVzZSBpbiBzdHJpbmcgbW9kZSwgd2hpY2hcbiAgLy8gcHJvdmlkZXMgdGhlIHN0cmluZyB2YWx1ZSBvZiBhIHBhcmFtZXRlciBhbG9uZyB3aXRoIGl0c1xuICAvLyBkZXB0aCByYXRoZXIgdGhhbiByZXNvbHZpbmcgaXQgaW1tZWRpYXRlbHkuXG4gIHB1c2hTdHJpbmdQYXJhbTogZnVuY3Rpb24oc3RyaW5nLCB0eXBlKSB7XG4gICAgdGhpcy5wdXNoQ29udGV4dCgpO1xuICAgIHRoaXMucHVzaFN0cmluZyh0eXBlKTtcblxuICAgIC8vIElmIGl0J3MgYSBzdWJleHByZXNzaW9uLCB0aGUgc3RyaW5nIHJlc3VsdFxuICAgIC8vIHdpbGwgYmUgcHVzaGVkIGFmdGVyIHRoaXMgb3Bjb2RlLlxuICAgIGlmICh0eXBlICE9PSAnU3ViRXhwcmVzc2lvbicpIHtcbiAgICAgIGlmICh0eXBlb2Ygc3RyaW5nID09PSAnc3RyaW5nJykge1xuICAgICAgICB0aGlzLnB1c2hTdHJpbmcoc3RyaW5nKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMucHVzaFN0YWNrTGl0ZXJhbChzdHJpbmcpO1xuICAgICAgfVxuICAgIH1cbiAgfSxcblxuICBlbXB0eUhhc2g6IGZ1bmN0aW9uKG9taXRFbXB0eSkge1xuICAgIGlmICh0aGlzLnRyYWNrSWRzKSB7XG4gICAgICB0aGlzLnB1c2goJ3t9Jyk7IC8vIGhhc2hJZHNcbiAgICB9XG4gICAgaWYgKHRoaXMuc3RyaW5nUGFyYW1zKSB7XG4gICAgICB0aGlzLnB1c2goJ3t9Jyk7IC8vIGhhc2hDb250ZXh0c1xuICAgICAgdGhpcy5wdXNoKCd7fScpOyAvLyBoYXNoVHlwZXNcbiAgICB9XG4gICAgdGhpcy5wdXNoU3RhY2tMaXRlcmFsKG9taXRFbXB0eSA/ICd1bmRlZmluZWQnIDogJ3t9Jyk7XG4gIH0sXG4gIHB1c2hIYXNoOiBmdW5jdGlvbigpIHtcbiAgICBpZiAodGhpcy5oYXNoKSB7XG4gICAgICB0aGlzLmhhc2hlcy5wdXNoKHRoaXMuaGFzaCk7XG4gICAgfVxuICAgIHRoaXMuaGFzaCA9IHsgdmFsdWVzOiB7fSwgdHlwZXM6IFtdLCBjb250ZXh0czogW10sIGlkczogW10gfTtcbiAgfSxcbiAgcG9wSGFzaDogZnVuY3Rpb24oKSB7XG4gICAgbGV0IGhhc2ggPSB0aGlzLmhhc2g7XG4gICAgdGhpcy5oYXNoID0gdGhpcy5oYXNoZXMucG9wKCk7XG5cbiAgICBpZiAodGhpcy50cmFja0lkcykge1xuICAgICAgdGhpcy5wdXNoKHRoaXMub2JqZWN0TGl0ZXJhbChoYXNoLmlkcykpO1xuICAgIH1cbiAgICBpZiAodGhpcy5zdHJpbmdQYXJhbXMpIHtcbiAgICAgIHRoaXMucHVzaCh0aGlzLm9iamVjdExpdGVyYWwoaGFzaC5jb250ZXh0cykpO1xuICAgICAgdGhpcy5wdXNoKHRoaXMub2JqZWN0TGl0ZXJhbChoYXNoLnR5cGVzKSk7XG4gICAgfVxuXG4gICAgdGhpcy5wdXNoKHRoaXMub2JqZWN0TGl0ZXJhbChoYXNoLnZhbHVlcykpO1xuICB9LFxuXG4gIC8vIFtwdXNoU3RyaW5nXVxuICAvL1xuICAvLyBPbiBzdGFjaywgYmVmb3JlOiAuLi5cbiAgLy8gT24gc3RhY2ssIGFmdGVyOiBxdW90ZWRTdHJpbmcoc3RyaW5nKSwgLi4uXG4gIC8vXG4gIC8vIFB1c2ggYSBxdW90ZWQgdmVyc2lvbiBvZiBgc3RyaW5nYCBvbnRvIHRoZSBzdGFja1xuICBwdXNoU3RyaW5nOiBmdW5jdGlvbihzdHJpbmcpIHtcbiAgICB0aGlzLnB1c2hTdGFja0xpdGVyYWwodGhpcy5xdW90ZWRTdHJpbmcoc3RyaW5nKSk7XG4gIH0sXG5cbiAgLy8gW3B1c2hMaXRlcmFsXVxuICAvL1xuICAvLyBPbiBzdGFjaywgYmVmb3JlOiAuLi5cbiAgLy8gT24gc3RhY2ssIGFmdGVyOiB2YWx1ZSwgLi4uXG4gIC8vXG4gIC8vIFB1c2hlcyBhIHZhbHVlIG9udG8gdGhlIHN0YWNrLiBUaGlzIG9wZXJhdGlvbiBwcmV2ZW50c1xuICAvLyB0aGUgY29tcGlsZXIgZnJvbSBjcmVhdGluZyBhIHRlbXBvcmFyeSB2YXJpYWJsZSB0byBob2xkXG4gIC8vIGl0LlxuICBwdXNoTGl0ZXJhbDogZnVuY3Rpb24odmFsdWUpIHtcbiAgICB0aGlzLnB1c2hTdGFja0xpdGVyYWwodmFsdWUpO1xuICB9LFxuXG4gIC8vIFtwdXNoUHJvZ3JhbV1cbiAgLy9cbiAgLy8gT24gc3RhY2ssIGJlZm9yZTogLi4uXG4gIC8vIE9uIHN0YWNrLCBhZnRlcjogcHJvZ3JhbShndWlkKSwgLi4uXG4gIC8vXG4gIC8vIFB1c2ggYSBwcm9ncmFtIGV4cHJlc3Npb24gb250byB0aGUgc3RhY2suIFRoaXMgdGFrZXNcbiAgLy8gYSBjb21waWxlLXRpbWUgZ3VpZCBhbmQgY29udmVydHMgaXQgaW50byBhIHJ1bnRpbWUtYWNjZXNzaWJsZVxuICAvLyBleHByZXNzaW9uLlxuICBwdXNoUHJvZ3JhbTogZnVuY3Rpb24oZ3VpZCkge1xuICAgIGlmIChndWlkICE9IG51bGwpIHtcbiAgICAgIHRoaXMucHVzaFN0YWNrTGl0ZXJhbCh0aGlzLnByb2dyYW1FeHByZXNzaW9uKGd1aWQpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5wdXNoU3RhY2tMaXRlcmFsKG51bGwpO1xuICAgIH1cbiAgfSxcblxuICAvLyBbcmVnaXN0ZXJEZWNvcmF0b3JdXG4gIC8vXG4gIC8vIE9uIHN0YWNrLCBiZWZvcmU6IGhhc2gsIHByb2dyYW0sIHBhcmFtcy4uLiwgLi4uXG4gIC8vIE9uIHN0YWNrLCBhZnRlcjogLi4uXG4gIC8vXG4gIC8vIFBvcHMgb2ZmIHRoZSBkZWNvcmF0b3IncyBwYXJhbWV0ZXJzLCBpbnZva2VzIHRoZSBkZWNvcmF0b3IsXG4gIC8vIGFuZCBpbnNlcnRzIHRoZSBkZWNvcmF0b3IgaW50byB0aGUgZGVjb3JhdG9ycyBsaXN0LlxuICByZWdpc3RlckRlY29yYXRvcihwYXJhbVNpemUsIG5hbWUpIHtcbiAgICBsZXQgZm91bmREZWNvcmF0b3IgPSB0aGlzLm5hbWVMb29rdXAoJ2RlY29yYXRvcnMnLCBuYW1lLCAnZGVjb3JhdG9yJyksXG4gICAgICBvcHRpb25zID0gdGhpcy5zZXR1cEhlbHBlckFyZ3MobmFtZSwgcGFyYW1TaXplKTtcblxuICAgIHRoaXMuZGVjb3JhdG9ycy5wdXNoKFtcbiAgICAgICdmbiA9ICcsXG4gICAgICB0aGlzLmRlY29yYXRvcnMuZnVuY3Rpb25DYWxsKGZvdW5kRGVjb3JhdG9yLCAnJywgW1xuICAgICAgICAnZm4nLFxuICAgICAgICAncHJvcHMnLFxuICAgICAgICAnY29udGFpbmVyJyxcbiAgICAgICAgb3B0aW9uc1xuICAgICAgXSksXG4gICAgICAnIHx8IGZuOydcbiAgICBdKTtcbiAgfSxcblxuICAvLyBbaW52b2tlSGVscGVyXVxuICAvL1xuICAvLyBPbiBzdGFjaywgYmVmb3JlOiBoYXNoLCBpbnZlcnNlLCBwcm9ncmFtLCBwYXJhbXMuLi4sIC4uLlxuICAvLyBPbiBzdGFjaywgYWZ0ZXI6IHJlc3VsdCBvZiBoZWxwZXIgaW52b2NhdGlvblxuICAvL1xuICAvLyBQb3BzIG9mZiB0aGUgaGVscGVyJ3MgcGFyYW1ldGVycywgaW52b2tlcyB0aGUgaGVscGVyLFxuICAvLyBhbmQgcHVzaGVzIHRoZSBoZWxwZXIncyByZXR1cm4gdmFsdWUgb250byB0aGUgc3RhY2suXG4gIC8vXG4gIC8vIElmIHRoZSBoZWxwZXIgaXMgbm90IGZvdW5kLCBgaGVscGVyTWlzc2luZ2AgaXMgY2FsbGVkLlxuICBpbnZva2VIZWxwZXI6IGZ1bmN0aW9uKHBhcmFtU2l6ZSwgbmFtZSwgaXNTaW1wbGUpIHtcbiAgICBsZXQgbm9uSGVscGVyID0gdGhpcy5wb3BTdGFjaygpLFxuICAgICAgaGVscGVyID0gdGhpcy5zZXR1cEhlbHBlcihwYXJhbVNpemUsIG5hbWUpO1xuXG4gICAgbGV0IHBvc3NpYmxlRnVuY3Rpb25DYWxscyA9IFtdO1xuXG4gICAgaWYgKGlzU2ltcGxlKSB7XG4gICAgICAvLyBkaXJlY3QgY2FsbCB0byBoZWxwZXJcbiAgICAgIHBvc3NpYmxlRnVuY3Rpb25DYWxscy5wdXNoKGhlbHBlci5uYW1lKTtcbiAgICB9XG4gICAgLy8gY2FsbCBhIGZ1bmN0aW9uIGZyb20gdGhlIGlucHV0IG9iamVjdFxuICAgIHBvc3NpYmxlRnVuY3Rpb25DYWxscy5wdXNoKG5vbkhlbHBlcik7XG4gICAgaWYgKCF0aGlzLm9wdGlvbnMuc3RyaWN0KSB7XG4gICAgICBwb3NzaWJsZUZ1bmN0aW9uQ2FsbHMucHVzaChcbiAgICAgICAgdGhpcy5hbGlhc2FibGUoJ2NvbnRhaW5lci5ob29rcy5oZWxwZXJNaXNzaW5nJylcbiAgICAgICk7XG4gICAgfVxuXG4gICAgbGV0IGZ1bmN0aW9uTG9va3VwQ29kZSA9IFtcbiAgICAgICcoJyxcbiAgICAgIHRoaXMuaXRlbXNTZXBhcmF0ZWRCeShwb3NzaWJsZUZ1bmN0aW9uQ2FsbHMsICd8fCcpLFxuICAgICAgJyknXG4gICAgXTtcbiAgICBsZXQgZnVuY3Rpb25DYWxsID0gdGhpcy5zb3VyY2UuZnVuY3Rpb25DYWxsKFxuICAgICAgZnVuY3Rpb25Mb29rdXBDb2RlLFxuICAgICAgJ2NhbGwnLFxuICAgICAgaGVscGVyLmNhbGxQYXJhbXNcbiAgICApO1xuICAgIHRoaXMucHVzaChmdW5jdGlvbkNhbGwpO1xuICB9LFxuXG4gIGl0ZW1zU2VwYXJhdGVkQnk6IGZ1bmN0aW9uKGl0ZW1zLCBzZXBhcmF0b3IpIHtcbiAgICBsZXQgcmVzdWx0ID0gW107XG4gICAgcmVzdWx0LnB1c2goaXRlbXNbMF0pO1xuICAgIGZvciAobGV0IGkgPSAxOyBpIDwgaXRlbXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHJlc3VsdC5wdXNoKHNlcGFyYXRvciwgaXRlbXNbaV0pO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9LFxuICAvLyBbaW52b2tlS25vd25IZWxwZXJdXG4gIC8vXG4gIC8vIE9uIHN0YWNrLCBiZWZvcmU6IGhhc2gsIGludmVyc2UsIHByb2dyYW0sIHBhcmFtcy4uLiwgLi4uXG4gIC8vIE9uIHN0YWNrLCBhZnRlcjogcmVzdWx0IG9mIGhlbHBlciBpbnZvY2F0aW9uXG4gIC8vXG4gIC8vIFRoaXMgb3BlcmF0aW9uIGlzIHVzZWQgd2hlbiB0aGUgaGVscGVyIGlzIGtub3duIHRvIGV4aXN0LFxuICAvLyBzbyBhIGBoZWxwZXJNaXNzaW5nYCBmYWxsYmFjayBpcyBub3QgcmVxdWlyZWQuXG4gIGludm9rZUtub3duSGVscGVyOiBmdW5jdGlvbihwYXJhbVNpemUsIG5hbWUpIHtcbiAgICBsZXQgaGVscGVyID0gdGhpcy5zZXR1cEhlbHBlcihwYXJhbVNpemUsIG5hbWUpO1xuICAgIHRoaXMucHVzaCh0aGlzLnNvdXJjZS5mdW5jdGlvbkNhbGwoaGVscGVyLm5hbWUsICdjYWxsJywgaGVscGVyLmNhbGxQYXJhbXMpKTtcbiAgfSxcblxuICAvLyBbaW52b2tlQW1iaWd1b3VzXVxuICAvL1xuICAvLyBPbiBzdGFjaywgYmVmb3JlOiBoYXNoLCBpbnZlcnNlLCBwcm9ncmFtLCBwYXJhbXMuLi4sIC4uLlxuICAvLyBPbiBzdGFjaywgYWZ0ZXI6IHJlc3VsdCBvZiBkaXNhbWJpZ3VhdGlvblxuICAvL1xuICAvLyBUaGlzIG9wZXJhdGlvbiBpcyB1c2VkIHdoZW4gYW4gZXhwcmVzc2lvbiBsaWtlIGB7e2Zvb319YFxuICAvLyBpcyBwcm92aWRlZCwgYnV0IHdlIGRvbid0IGtub3cgYXQgY29tcGlsZS10aW1lIHdoZXRoZXIgaXRcbiAgLy8gaXMgYSBoZWxwZXIgb3IgYSBwYXRoLlxuICAvL1xuICAvLyBUaGlzIG9wZXJhdGlvbiBlbWl0cyBtb3JlIGNvZGUgdGhhbiB0aGUgb3RoZXIgb3B0aW9ucyxcbiAgLy8gYW5kIGNhbiBiZSBhdm9pZGVkIGJ5IHBhc3NpbmcgdGhlIGBrbm93bkhlbHBlcnNgIGFuZFxuICAvLyBga25vd25IZWxwZXJzT25seWAgZmxhZ3MgYXQgY29tcGlsZS10aW1lLlxuICBpbnZva2VBbWJpZ3VvdXM6IGZ1bmN0aW9uKG5hbWUsIGhlbHBlckNhbGwpIHtcbiAgICB0aGlzLnVzZVJlZ2lzdGVyKCdoZWxwZXInKTtcblxuICAgIGxldCBub25IZWxwZXIgPSB0aGlzLnBvcFN0YWNrKCk7XG5cbiAgICB0aGlzLmVtcHR5SGFzaCgpO1xuICAgIGxldCBoZWxwZXIgPSB0aGlzLnNldHVwSGVscGVyKDAsIG5hbWUsIGhlbHBlckNhbGwpO1xuXG4gICAgbGV0IGhlbHBlck5hbWUgPSAodGhpcy5sYXN0SGVscGVyID0gdGhpcy5uYW1lTG9va3VwKFxuICAgICAgJ2hlbHBlcnMnLFxuICAgICAgbmFtZSxcbiAgICAgICdoZWxwZXInXG4gICAgKSk7XG5cbiAgICBsZXQgbG9va3VwID0gWycoJywgJyhoZWxwZXIgPSAnLCBoZWxwZXJOYW1lLCAnIHx8ICcsIG5vbkhlbHBlciwgJyknXTtcbiAgICBpZiAoIXRoaXMub3B0aW9ucy5zdHJpY3QpIHtcbiAgICAgIGxvb2t1cFswXSA9ICcoaGVscGVyID0gJztcbiAgICAgIGxvb2t1cC5wdXNoKFxuICAgICAgICAnICE9IG51bGwgPyBoZWxwZXIgOiAnLFxuICAgICAgICB0aGlzLmFsaWFzYWJsZSgnY29udGFpbmVyLmhvb2tzLmhlbHBlck1pc3NpbmcnKVxuICAgICAgKTtcbiAgICB9XG5cbiAgICB0aGlzLnB1c2goW1xuICAgICAgJygnLFxuICAgICAgbG9va3VwLFxuICAgICAgaGVscGVyLnBhcmFtc0luaXQgPyBbJyksKCcsIGhlbHBlci5wYXJhbXNJbml0XSA6IFtdLFxuICAgICAgJyksJyxcbiAgICAgICcodHlwZW9mIGhlbHBlciA9PT0gJyxcbiAgICAgIHRoaXMuYWxpYXNhYmxlKCdcImZ1bmN0aW9uXCInKSxcbiAgICAgICcgPyAnLFxuICAgICAgdGhpcy5zb3VyY2UuZnVuY3Rpb25DYWxsKCdoZWxwZXInLCAnY2FsbCcsIGhlbHBlci5jYWxsUGFyYW1zKSxcbiAgICAgICcgOiBoZWxwZXIpKSdcbiAgICBdKTtcbiAgfSxcblxuICAvLyBbaW52b2tlUGFydGlhbF1cbiAgLy9cbiAgLy8gT24gc3RhY2ssIGJlZm9yZTogY29udGV4dCwgLi4uXG4gIC8vIE9uIHN0YWNrIGFmdGVyOiByZXN1bHQgb2YgcGFydGlhbCBpbnZvY2F0aW9uXG4gIC8vXG4gIC8vIFRoaXMgb3BlcmF0aW9uIHBvcHMgb2ZmIGEgY29udGV4dCwgaW52b2tlcyBhIHBhcnRpYWwgd2l0aCB0aGF0IGNvbnRleHQsXG4gIC8vIGFuZCBwdXNoZXMgdGhlIHJlc3VsdCBvZiB0aGUgaW52b2NhdGlvbiBiYWNrLlxuICBpbnZva2VQYXJ0aWFsOiBmdW5jdGlvbihpc0R5bmFtaWMsIG5hbWUsIGluZGVudCkge1xuICAgIGxldCBwYXJhbXMgPSBbXSxcbiAgICAgIG9wdGlvbnMgPSB0aGlzLnNldHVwUGFyYW1zKG5hbWUsIDEsIHBhcmFtcyk7XG5cbiAgICBpZiAoaXNEeW5hbWljKSB7XG4gICAgICBuYW1lID0gdGhpcy5wb3BTdGFjaygpO1xuICAgICAgZGVsZXRlIG9wdGlvbnMubmFtZTtcbiAgICB9XG5cbiAgICBpZiAoaW5kZW50KSB7XG4gICAgICBvcHRpb25zLmluZGVudCA9IEpTT04uc3RyaW5naWZ5KGluZGVudCk7XG4gICAgfVxuICAgIG9wdGlvbnMuaGVscGVycyA9ICdoZWxwZXJzJztcbiAgICBvcHRpb25zLnBhcnRpYWxzID0gJ3BhcnRpYWxzJztcbiAgICBvcHRpb25zLmRlY29yYXRvcnMgPSAnY29udGFpbmVyLmRlY29yYXRvcnMnO1xuXG4gICAgaWYgKCFpc0R5bmFtaWMpIHtcbiAgICAgIHBhcmFtcy51bnNoaWZ0KHRoaXMubmFtZUxvb2t1cCgncGFydGlhbHMnLCBuYW1lLCAncGFydGlhbCcpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcGFyYW1zLnVuc2hpZnQobmFtZSk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMub3B0aW9ucy5jb21wYXQpIHtcbiAgICAgIG9wdGlvbnMuZGVwdGhzID0gJ2RlcHRocyc7XG4gICAgfVxuICAgIG9wdGlvbnMgPSB0aGlzLm9iamVjdExpdGVyYWwob3B0aW9ucyk7XG4gICAgcGFyYW1zLnB1c2gob3B0aW9ucyk7XG5cbiAgICB0aGlzLnB1c2godGhpcy5zb3VyY2UuZnVuY3Rpb25DYWxsKCdjb250YWluZXIuaW52b2tlUGFydGlhbCcsICcnLCBwYXJhbXMpKTtcbiAgfSxcblxuICAvLyBbYXNzaWduVG9IYXNoXVxuICAvL1xuICAvLyBPbiBzdGFjaywgYmVmb3JlOiB2YWx1ZSwgLi4uLCBoYXNoLCAuLi5cbiAgLy8gT24gc3RhY2ssIGFmdGVyOiAuLi4sIGhhc2gsIC4uLlxuICAvL1xuICAvLyBQb3BzIGEgdmFsdWUgb2ZmIHRoZSBzdGFjayBhbmQgYXNzaWducyBpdCB0byB0aGUgY3VycmVudCBoYXNoXG4gIGFzc2lnblRvSGFzaDogZnVuY3Rpb24oa2V5KSB7XG4gICAgbGV0IHZhbHVlID0gdGhpcy5wb3BTdGFjaygpLFxuICAgICAgY29udGV4dCxcbiAgICAgIHR5cGUsXG4gICAgICBpZDtcblxuICAgIGlmICh0aGlzLnRyYWNrSWRzKSB7XG4gICAgICBpZCA9IHRoaXMucG9wU3RhY2soKTtcbiAgICB9XG4gICAgaWYgKHRoaXMuc3RyaW5nUGFyYW1zKSB7XG4gICAgICB0eXBlID0gdGhpcy5wb3BTdGFjaygpO1xuICAgICAgY29udGV4dCA9IHRoaXMucG9wU3RhY2soKTtcbiAgICB9XG5cbiAgICBsZXQgaGFzaCA9IHRoaXMuaGFzaDtcbiAgICBpZiAoY29udGV4dCkge1xuICAgICAgaGFzaC5jb250ZXh0c1trZXldID0gY29udGV4dDtcbiAgICB9XG4gICAgaWYgKHR5cGUpIHtcbiAgICAgIGhhc2gudHlwZXNba2V5XSA9IHR5cGU7XG4gICAgfVxuICAgIGlmIChpZCkge1xuICAgICAgaGFzaC5pZHNba2V5XSA9IGlkO1xuICAgIH1cbiAgICBoYXNoLnZhbHVlc1trZXldID0gdmFsdWU7XG4gIH0sXG5cbiAgcHVzaElkOiBmdW5jdGlvbih0eXBlLCBuYW1lLCBjaGlsZCkge1xuICAgIGlmICh0eXBlID09PSAnQmxvY2tQYXJhbScpIHtcbiAgICAgIHRoaXMucHVzaFN0YWNrTGl0ZXJhbChcbiAgICAgICAgJ2Jsb2NrUGFyYW1zWycgK1xuICAgICAgICAgIG5hbWVbMF0gK1xuICAgICAgICAgICddLnBhdGhbJyArXG4gICAgICAgICAgbmFtZVsxXSArXG4gICAgICAgICAgJ10nICtcbiAgICAgICAgICAoY2hpbGQgPyAnICsgJyArIEpTT04uc3RyaW5naWZ5KCcuJyArIGNoaWxkKSA6ICcnKVxuICAgICAgKTtcbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdQYXRoRXhwcmVzc2lvbicpIHtcbiAgICAgIHRoaXMucHVzaFN0cmluZyhuYW1lKTtcbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdTdWJFeHByZXNzaW9uJykge1xuICAgICAgdGhpcy5wdXNoU3RhY2tMaXRlcmFsKCd0cnVlJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMucHVzaFN0YWNrTGl0ZXJhbCgnbnVsbCcpO1xuICAgIH1cbiAgfSxcblxuICAvLyBIRUxQRVJTXG5cbiAgY29tcGlsZXI6IEphdmFTY3JpcHRDb21waWxlcixcblxuICBjb21waWxlQ2hpbGRyZW46IGZ1bmN0aW9uKGVudmlyb25tZW50LCBvcHRpb25zKSB7XG4gICAgbGV0IGNoaWxkcmVuID0gZW52aXJvbm1lbnQuY2hpbGRyZW4sXG4gICAgICBjaGlsZCxcbiAgICAgIGNvbXBpbGVyO1xuXG4gICAgZm9yIChsZXQgaSA9IDAsIGwgPSBjaGlsZHJlbi5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgIGNoaWxkID0gY2hpbGRyZW5baV07XG4gICAgICBjb21waWxlciA9IG5ldyB0aGlzLmNvbXBpbGVyKCk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbmV3LWNhcFxuXG4gICAgICBsZXQgZXhpc3RpbmcgPSB0aGlzLm1hdGNoRXhpc3RpbmdQcm9ncmFtKGNoaWxkKTtcblxuICAgICAgaWYgKGV4aXN0aW5nID09IG51bGwpIHtcbiAgICAgICAgdGhpcy5jb250ZXh0LnByb2dyYW1zLnB1c2goJycpOyAvLyBQbGFjZWhvbGRlciB0byBwcmV2ZW50IG5hbWUgY29uZmxpY3RzIGZvciBuZXN0ZWQgY2hpbGRyZW5cbiAgICAgICAgbGV0IGluZGV4ID0gdGhpcy5jb250ZXh0LnByb2dyYW1zLmxlbmd0aDtcbiAgICAgICAgY2hpbGQuaW5kZXggPSBpbmRleDtcbiAgICAgICAgY2hpbGQubmFtZSA9ICdwcm9ncmFtJyArIGluZGV4O1xuICAgICAgICB0aGlzLmNvbnRleHQucHJvZ3JhbXNbaW5kZXhdID0gY29tcGlsZXIuY29tcGlsZShcbiAgICAgICAgICBjaGlsZCxcbiAgICAgICAgICBvcHRpb25zLFxuICAgICAgICAgIHRoaXMuY29udGV4dCxcbiAgICAgICAgICAhdGhpcy5wcmVjb21waWxlXG4gICAgICAgICk7XG4gICAgICAgIHRoaXMuY29udGV4dC5kZWNvcmF0b3JzW2luZGV4XSA9IGNvbXBpbGVyLmRlY29yYXRvcnM7XG4gICAgICAgIHRoaXMuY29udGV4dC5lbnZpcm9ubWVudHNbaW5kZXhdID0gY2hpbGQ7XG5cbiAgICAgICAgdGhpcy51c2VEZXB0aHMgPSB0aGlzLnVzZURlcHRocyB8fCBjb21waWxlci51c2VEZXB0aHM7XG4gICAgICAgIHRoaXMudXNlQmxvY2tQYXJhbXMgPSB0aGlzLnVzZUJsb2NrUGFyYW1zIHx8IGNvbXBpbGVyLnVzZUJsb2NrUGFyYW1zO1xuICAgICAgICBjaGlsZC51c2VEZXB0aHMgPSB0aGlzLnVzZURlcHRocztcbiAgICAgICAgY2hpbGQudXNlQmxvY2tQYXJhbXMgPSB0aGlzLnVzZUJsb2NrUGFyYW1zO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY2hpbGQuaW5kZXggPSBleGlzdGluZy5pbmRleDtcbiAgICAgICAgY2hpbGQubmFtZSA9ICdwcm9ncmFtJyArIGV4aXN0aW5nLmluZGV4O1xuXG4gICAgICAgIHRoaXMudXNlRGVwdGhzID0gdGhpcy51c2VEZXB0aHMgfHwgZXhpc3RpbmcudXNlRGVwdGhzO1xuICAgICAgICB0aGlzLnVzZUJsb2NrUGFyYW1zID0gdGhpcy51c2VCbG9ja1BhcmFtcyB8fCBleGlzdGluZy51c2VCbG9ja1BhcmFtcztcbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIG1hdGNoRXhpc3RpbmdQcm9ncmFtOiBmdW5jdGlvbihjaGlsZCkge1xuICAgIGZvciAobGV0IGkgPSAwLCBsZW4gPSB0aGlzLmNvbnRleHQuZW52aXJvbm1lbnRzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICBsZXQgZW52aXJvbm1lbnQgPSB0aGlzLmNvbnRleHQuZW52aXJvbm1lbnRzW2ldO1xuICAgICAgaWYgKGVudmlyb25tZW50ICYmIGVudmlyb25tZW50LmVxdWFscyhjaGlsZCkpIHtcbiAgICAgICAgcmV0dXJuIGVudmlyb25tZW50O1xuICAgICAgfVxuICAgIH1cbiAgfSxcblxuICBwcm9ncmFtRXhwcmVzc2lvbjogZnVuY3Rpb24oZ3VpZCkge1xuICAgIGxldCBjaGlsZCA9IHRoaXMuZW52aXJvbm1lbnQuY2hpbGRyZW5bZ3VpZF0sXG4gICAgICBwcm9ncmFtUGFyYW1zID0gW2NoaWxkLmluZGV4LCAnZGF0YScsIGNoaWxkLmJsb2NrUGFyYW1zXTtcblxuICAgIGlmICh0aGlzLnVzZUJsb2NrUGFyYW1zIHx8IHRoaXMudXNlRGVwdGhzKSB7XG4gICAgICBwcm9ncmFtUGFyYW1zLnB1c2goJ2Jsb2NrUGFyYW1zJyk7XG4gICAgfVxuICAgIGlmICh0aGlzLnVzZURlcHRocykge1xuICAgICAgcHJvZ3JhbVBhcmFtcy5wdXNoKCdkZXB0aHMnKTtcbiAgICB9XG5cbiAgICByZXR1cm4gJ2NvbnRhaW5lci5wcm9ncmFtKCcgKyBwcm9ncmFtUGFyYW1zLmpvaW4oJywgJykgKyAnKSc7XG4gIH0sXG5cbiAgdXNlUmVnaXN0ZXI6IGZ1bmN0aW9uKG5hbWUpIHtcbiAgICBpZiAoIXRoaXMucmVnaXN0ZXJzW25hbWVdKSB7XG4gICAgICB0aGlzLnJlZ2lzdGVyc1tuYW1lXSA9IHRydWU7XG4gICAgICB0aGlzLnJlZ2lzdGVycy5saXN0LnB1c2gobmFtZSk7XG4gICAgfVxuICB9LFxuXG4gIHB1c2g6IGZ1bmN0aW9uKGV4cHIpIHtcbiAgICBpZiAoIShleHByIGluc3RhbmNlb2YgTGl0ZXJhbCkpIHtcbiAgICAgIGV4cHIgPSB0aGlzLnNvdXJjZS53cmFwKGV4cHIpO1xuICAgIH1cblxuICAgIHRoaXMuaW5saW5lU3RhY2sucHVzaChleHByKTtcbiAgICByZXR1cm4gZXhwcjtcbiAgfSxcblxuICBwdXNoU3RhY2tMaXRlcmFsOiBmdW5jdGlvbihpdGVtKSB7XG4gICAgdGhpcy5wdXNoKG5ldyBMaXRlcmFsKGl0ZW0pKTtcbiAgfSxcblxuICBwdXNoU291cmNlOiBmdW5jdGlvbihzb3VyY2UpIHtcbiAgICBpZiAodGhpcy5wZW5kaW5nQ29udGVudCkge1xuICAgICAgdGhpcy5zb3VyY2UucHVzaChcbiAgICAgICAgdGhpcy5hcHBlbmRUb0J1ZmZlcihcbiAgICAgICAgICB0aGlzLnNvdXJjZS5xdW90ZWRTdHJpbmcodGhpcy5wZW5kaW5nQ29udGVudCksXG4gICAgICAgICAgdGhpcy5wZW5kaW5nTG9jYXRpb25cbiAgICAgICAgKVxuICAgICAgKTtcbiAgICAgIHRoaXMucGVuZGluZ0NvbnRlbnQgPSB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgaWYgKHNvdXJjZSkge1xuICAgICAgdGhpcy5zb3VyY2UucHVzaChzb3VyY2UpO1xuICAgIH1cbiAgfSxcblxuICByZXBsYWNlU3RhY2s6IGZ1bmN0aW9uKGNhbGxiYWNrKSB7XG4gICAgbGV0IHByZWZpeCA9IFsnKCddLFxuICAgICAgc3RhY2ssXG4gICAgICBjcmVhdGVkU3RhY2ssXG4gICAgICB1c2VkTGl0ZXJhbDtcblxuICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG4gICAgaWYgKCF0aGlzLmlzSW5saW5lKCkpIHtcbiAgICAgIHRocm93IG5ldyBFeGNlcHRpb24oJ3JlcGxhY2VTdGFjayBvbiBub24taW5saW5lJyk7XG4gICAgfVxuXG4gICAgLy8gV2Ugd2FudCB0byBtZXJnZSB0aGUgaW5saW5lIHN0YXRlbWVudCBpbnRvIHRoZSByZXBsYWNlbWVudCBzdGF0ZW1lbnQgdmlhICcsJ1xuICAgIGxldCB0b3AgPSB0aGlzLnBvcFN0YWNrKHRydWUpO1xuXG4gICAgaWYgKHRvcCBpbnN0YW5jZW9mIExpdGVyYWwpIHtcbiAgICAgIC8vIExpdGVyYWxzIGRvIG5vdCBuZWVkIHRvIGJlIGlubGluZWRcbiAgICAgIHN0YWNrID0gW3RvcC52YWx1ZV07XG4gICAgICBwcmVmaXggPSBbJygnLCBzdGFja107XG4gICAgICB1c2VkTGl0ZXJhbCA9IHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIEdldCBvciBjcmVhdGUgdGhlIGN1cnJlbnQgc3RhY2sgbmFtZSBmb3IgdXNlIGJ5IHRoZSBpbmxpbmVcbiAgICAgIGNyZWF0ZWRTdGFjayA9IHRydWU7XG4gICAgICBsZXQgbmFtZSA9IHRoaXMuaW5jclN0YWNrKCk7XG5cbiAgICAgIHByZWZpeCA9IFsnKCgnLCB0aGlzLnB1c2gobmFtZSksICcgPSAnLCB0b3AsICcpJ107XG4gICAgICBzdGFjayA9IHRoaXMudG9wU3RhY2soKTtcbiAgICB9XG5cbiAgICBsZXQgaXRlbSA9IGNhbGxiYWNrLmNhbGwodGhpcywgc3RhY2spO1xuXG4gICAgaWYgKCF1c2VkTGl0ZXJhbCkge1xuICAgICAgdGhpcy5wb3BTdGFjaygpO1xuICAgIH1cbiAgICBpZiAoY3JlYXRlZFN0YWNrKSB7XG4gICAgICB0aGlzLnN0YWNrU2xvdC0tO1xuICAgIH1cbiAgICB0aGlzLnB1c2gocHJlZml4LmNvbmNhdChpdGVtLCAnKScpKTtcbiAgfSxcblxuICBpbmNyU3RhY2s6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuc3RhY2tTbG90Kys7XG4gICAgaWYgKHRoaXMuc3RhY2tTbG90ID4gdGhpcy5zdGFja1ZhcnMubGVuZ3RoKSB7XG4gICAgICB0aGlzLnN0YWNrVmFycy5wdXNoKCdzdGFjaycgKyB0aGlzLnN0YWNrU2xvdCk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLnRvcFN0YWNrTmFtZSgpO1xuICB9LFxuICB0b3BTdGFja05hbWU6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiAnc3RhY2snICsgdGhpcy5zdGFja1Nsb3Q7XG4gIH0sXG4gIGZsdXNoSW5saW5lOiBmdW5jdGlvbigpIHtcbiAgICBsZXQgaW5saW5lU3RhY2sgPSB0aGlzLmlubGluZVN0YWNrO1xuICAgIHRoaXMuaW5saW5lU3RhY2sgPSBbXTtcbiAgICBmb3IgKGxldCBpID0gMCwgbGVuID0gaW5saW5lU3RhY2subGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgIGxldCBlbnRyeSA9IGlubGluZVN0YWNrW2ldO1xuICAgICAgLyogaXN0YW5idWwgaWdub3JlIGlmICovXG4gICAgICBpZiAoZW50cnkgaW5zdGFuY2VvZiBMaXRlcmFsKSB7XG4gICAgICAgIHRoaXMuY29tcGlsZVN0YWNrLnB1c2goZW50cnkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbGV0IHN0YWNrID0gdGhpcy5pbmNyU3RhY2soKTtcbiAgICAgICAgdGhpcy5wdXNoU291cmNlKFtzdGFjaywgJyA9ICcsIGVudHJ5LCAnOyddKTtcbiAgICAgICAgdGhpcy5jb21waWxlU3RhY2sucHVzaChzdGFjayk7XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBpc0lubGluZTogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuaW5saW5lU3RhY2subGVuZ3RoO1xuICB9LFxuXG4gIHBvcFN0YWNrOiBmdW5jdGlvbih3cmFwcGVkKSB7XG4gICAgbGV0IGlubGluZSA9IHRoaXMuaXNJbmxpbmUoKSxcbiAgICAgIGl0ZW0gPSAoaW5saW5lID8gdGhpcy5pbmxpbmVTdGFjayA6IHRoaXMuY29tcGlsZVN0YWNrKS5wb3AoKTtcblxuICAgIGlmICghd3JhcHBlZCAmJiBpdGVtIGluc3RhbmNlb2YgTGl0ZXJhbCkge1xuICAgICAgcmV0dXJuIGl0ZW0udmFsdWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmICghaW5saW5lKSB7XG4gICAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG4gICAgICAgIGlmICghdGhpcy5zdGFja1Nsb3QpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKCdJbnZhbGlkIHN0YWNrIHBvcCcpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc3RhY2tTbG90LS07XG4gICAgICB9XG4gICAgICByZXR1cm4gaXRlbTtcbiAgICB9XG4gIH0sXG5cbiAgdG9wU3RhY2s6IGZ1bmN0aW9uKCkge1xuICAgIGxldCBzdGFjayA9IHRoaXMuaXNJbmxpbmUoKSA/IHRoaXMuaW5saW5lU3RhY2sgOiB0aGlzLmNvbXBpbGVTdGFjayxcbiAgICAgIGl0ZW0gPSBzdGFja1tzdGFjay5sZW5ndGggLSAxXTtcblxuICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBpZiAqL1xuICAgIGlmIChpdGVtIGluc3RhbmNlb2YgTGl0ZXJhbCkge1xuICAgICAgcmV0dXJuIGl0ZW0udmFsdWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBpdGVtO1xuICAgIH1cbiAgfSxcblxuICBjb250ZXh0TmFtZTogZnVuY3Rpb24oY29udGV4dCkge1xuICAgIGlmICh0aGlzLnVzZURlcHRocyAmJiBjb250ZXh0KSB7XG4gICAgICByZXR1cm4gJ2RlcHRoc1snICsgY29udGV4dCArICddJztcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuICdkZXB0aCcgKyBjb250ZXh0O1xuICAgIH1cbiAgfSxcblxuICBxdW90ZWRTdHJpbmc6IGZ1bmN0aW9uKHN0cikge1xuICAgIHJldHVybiB0aGlzLnNvdXJjZS5xdW90ZWRTdHJpbmcoc3RyKTtcbiAgfSxcblxuICBvYmplY3RMaXRlcmFsOiBmdW5jdGlvbihvYmopIHtcbiAgICByZXR1cm4gdGhpcy5zb3VyY2Uub2JqZWN0TGl0ZXJhbChvYmopO1xuICB9LFxuXG4gIGFsaWFzYWJsZTogZnVuY3Rpb24obmFtZSkge1xuICAgIGxldCByZXQgPSB0aGlzLmFsaWFzZXNbbmFtZV07XG4gICAgaWYgKHJldCkge1xuICAgICAgcmV0LnJlZmVyZW5jZUNvdW50Kys7XG4gICAgICByZXR1cm4gcmV0O1xuICAgIH1cblxuICAgIHJldCA9IHRoaXMuYWxpYXNlc1tuYW1lXSA9IHRoaXMuc291cmNlLndyYXAobmFtZSk7XG4gICAgcmV0LmFsaWFzYWJsZSA9IHRydWU7XG4gICAgcmV0LnJlZmVyZW5jZUNvdW50ID0gMTtcblxuICAgIHJldHVybiByZXQ7XG4gIH0sXG5cbiAgc2V0dXBIZWxwZXI6IGZ1bmN0aW9uKHBhcmFtU2l6ZSwgbmFtZSwgYmxvY2tIZWxwZXIpIHtcbiAgICBsZXQgcGFyYW1zID0gW10sXG4gICAgICBwYXJhbXNJbml0ID0gdGhpcy5zZXR1cEhlbHBlckFyZ3MobmFtZSwgcGFyYW1TaXplLCBwYXJhbXMsIGJsb2NrSGVscGVyKTtcbiAgICBsZXQgZm91bmRIZWxwZXIgPSB0aGlzLm5hbWVMb29rdXAoJ2hlbHBlcnMnLCBuYW1lLCAnaGVscGVyJyksXG4gICAgICBjYWxsQ29udGV4dCA9IHRoaXMuYWxpYXNhYmxlKFxuICAgICAgICBgJHt0aGlzLmNvbnRleHROYW1lKDApfSAhPSBudWxsID8gJHt0aGlzLmNvbnRleHROYW1lKFxuICAgICAgICAgIDBcbiAgICAgICAgKX0gOiAoY29udGFpbmVyLm51bGxDb250ZXh0IHx8IHt9KWBcbiAgICAgICk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgcGFyYW1zOiBwYXJhbXMsXG4gICAgICBwYXJhbXNJbml0OiBwYXJhbXNJbml0LFxuICAgICAgbmFtZTogZm91bmRIZWxwZXIsXG4gICAgICBjYWxsUGFyYW1zOiBbY2FsbENvbnRleHRdLmNvbmNhdChwYXJhbXMpXG4gICAgfTtcbiAgfSxcblxuICBzZXR1cFBhcmFtczogZnVuY3Rpb24oaGVscGVyLCBwYXJhbVNpemUsIHBhcmFtcykge1xuICAgIGxldCBvcHRpb25zID0ge30sXG4gICAgICBjb250ZXh0cyA9IFtdLFxuICAgICAgdHlwZXMgPSBbXSxcbiAgICAgIGlkcyA9IFtdLFxuICAgICAgb2JqZWN0QXJncyA9ICFwYXJhbXMsXG4gICAgICBwYXJhbTtcblxuICAgIGlmIChvYmplY3RBcmdzKSB7XG4gICAgICBwYXJhbXMgPSBbXTtcbiAgICB9XG5cbiAgICBvcHRpb25zLm5hbWUgPSB0aGlzLnF1b3RlZFN0cmluZyhoZWxwZXIpO1xuICAgIG9wdGlvbnMuaGFzaCA9IHRoaXMucG9wU3RhY2soKTtcblxuICAgIGlmICh0aGlzLnRyYWNrSWRzKSB7XG4gICAgICBvcHRpb25zLmhhc2hJZHMgPSB0aGlzLnBvcFN0YWNrKCk7XG4gICAgfVxuICAgIGlmICh0aGlzLnN0cmluZ1BhcmFtcykge1xuICAgICAgb3B0aW9ucy5oYXNoVHlwZXMgPSB0aGlzLnBvcFN0YWNrKCk7XG4gICAgICBvcHRpb25zLmhhc2hDb250ZXh0cyA9IHRoaXMucG9wU3RhY2soKTtcbiAgICB9XG5cbiAgICBsZXQgaW52ZXJzZSA9IHRoaXMucG9wU3RhY2soKSxcbiAgICAgIHByb2dyYW0gPSB0aGlzLnBvcFN0YWNrKCk7XG5cbiAgICAvLyBBdm9pZCBzZXR0aW5nIGZuIGFuZCBpbnZlcnNlIGlmIG5laXRoZXIgYXJlIHNldC4gVGhpcyBhbGxvd3NcbiAgICAvLyBoZWxwZXJzIHRvIGRvIGEgY2hlY2sgZm9yIGBpZiAob3B0aW9ucy5mbilgXG4gICAgaWYgKHByb2dyYW0gfHwgaW52ZXJzZSkge1xuICAgICAgb3B0aW9ucy5mbiA9IHByb2dyYW0gfHwgJ2NvbnRhaW5lci5ub29wJztcbiAgICAgIG9wdGlvbnMuaW52ZXJzZSA9IGludmVyc2UgfHwgJ2NvbnRhaW5lci5ub29wJztcbiAgICB9XG5cbiAgICAvLyBUaGUgcGFyYW1ldGVycyBnbyBvbiB0byB0aGUgc3RhY2sgaW4gb3JkZXIgKG1ha2luZyBzdXJlIHRoYXQgdGhleSBhcmUgZXZhbHVhdGVkIGluIG9yZGVyKVxuICAgIC8vIHNvIHdlIG5lZWQgdG8gcG9wIHRoZW0gb2ZmIHRoZSBzdGFjayBpbiByZXZlcnNlIG9yZGVyXG4gICAgbGV0IGkgPSBwYXJhbVNpemU7XG4gICAgd2hpbGUgKGktLSkge1xuICAgICAgcGFyYW0gPSB0aGlzLnBvcFN0YWNrKCk7XG4gICAgICBwYXJhbXNbaV0gPSBwYXJhbTtcblxuICAgICAgaWYgKHRoaXMudHJhY2tJZHMpIHtcbiAgICAgICAgaWRzW2ldID0gdGhpcy5wb3BTdGFjaygpO1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMuc3RyaW5nUGFyYW1zKSB7XG4gICAgICAgIHR5cGVzW2ldID0gdGhpcy5wb3BTdGFjaygpO1xuICAgICAgICBjb250ZXh0c1tpXSA9IHRoaXMucG9wU3RhY2soKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAob2JqZWN0QXJncykge1xuICAgICAgb3B0aW9ucy5hcmdzID0gdGhpcy5zb3VyY2UuZ2VuZXJhdGVBcnJheShwYXJhbXMpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLnRyYWNrSWRzKSB7XG4gICAgICBvcHRpb25zLmlkcyA9IHRoaXMuc291cmNlLmdlbmVyYXRlQXJyYXkoaWRzKTtcbiAgICB9XG4gICAgaWYgKHRoaXMuc3RyaW5nUGFyYW1zKSB7XG4gICAgICBvcHRpb25zLnR5cGVzID0gdGhpcy5zb3VyY2UuZ2VuZXJhdGVBcnJheSh0eXBlcyk7XG4gICAgICBvcHRpb25zLmNvbnRleHRzID0gdGhpcy5zb3VyY2UuZ2VuZXJhdGVBcnJheShjb250ZXh0cyk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMub3B0aW9ucy5kYXRhKSB7XG4gICAgICBvcHRpb25zLmRhdGEgPSAnZGF0YSc7XG4gICAgfVxuICAgIGlmICh0aGlzLnVzZUJsb2NrUGFyYW1zKSB7XG4gICAgICBvcHRpb25zLmJsb2NrUGFyYW1zID0gJ2Jsb2NrUGFyYW1zJztcbiAgICB9XG4gICAgcmV0dXJuIG9wdGlvbnM7XG4gIH0sXG5cbiAgc2V0dXBIZWxwZXJBcmdzOiBmdW5jdGlvbihoZWxwZXIsIHBhcmFtU2l6ZSwgcGFyYW1zLCB1c2VSZWdpc3Rlcikge1xuICAgIGxldCBvcHRpb25zID0gdGhpcy5zZXR1cFBhcmFtcyhoZWxwZXIsIHBhcmFtU2l6ZSwgcGFyYW1zKTtcbiAgICBvcHRpb25zLmxvYyA9IEpTT04uc3RyaW5naWZ5KHRoaXMuc291cmNlLmN1cnJlbnRMb2NhdGlvbik7XG4gICAgb3B0aW9ucyA9IHRoaXMub2JqZWN0TGl0ZXJhbChvcHRpb25zKTtcbiAgICBpZiAodXNlUmVnaXN0ZXIpIHtcbiAgICAgIHRoaXMudXNlUmVnaXN0ZXIoJ29wdGlvbnMnKTtcbiAgICAgIHBhcmFtcy5wdXNoKCdvcHRpb25zJyk7XG4gICAgICByZXR1cm4gWydvcHRpb25zPScsIG9wdGlvbnNdO1xuICAgIH0gZWxzZSBpZiAocGFyYW1zKSB7XG4gICAgICBwYXJhbXMucHVzaChvcHRpb25zKTtcbiAgICAgIHJldHVybiAnJztcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIG9wdGlvbnM7XG4gICAgfVxuICB9XG59O1xuXG4oZnVuY3Rpb24oKSB7XG4gIGNvbnN0IHJlc2VydmVkV29yZHMgPSAoXG4gICAgJ2JyZWFrIGVsc2UgbmV3IHZhcicgK1xuICAgICcgY2FzZSBmaW5hbGx5IHJldHVybiB2b2lkJyArXG4gICAgJyBjYXRjaCBmb3Igc3dpdGNoIHdoaWxlJyArXG4gICAgJyBjb250aW51ZSBmdW5jdGlvbiB0aGlzIHdpdGgnICtcbiAgICAnIGRlZmF1bHQgaWYgdGhyb3cnICtcbiAgICAnIGRlbGV0ZSBpbiB0cnknICtcbiAgICAnIGRvIGluc3RhbmNlb2YgdHlwZW9mJyArXG4gICAgJyBhYnN0cmFjdCBlbnVtIGludCBzaG9ydCcgK1xuICAgICcgYm9vbGVhbiBleHBvcnQgaW50ZXJmYWNlIHN0YXRpYycgK1xuICAgICcgYnl0ZSBleHRlbmRzIGxvbmcgc3VwZXInICtcbiAgICAnIGNoYXIgZmluYWwgbmF0aXZlIHN5bmNocm9uaXplZCcgK1xuICAgICcgY2xhc3MgZmxvYXQgcGFja2FnZSB0aHJvd3MnICtcbiAgICAnIGNvbnN0IGdvdG8gcHJpdmF0ZSB0cmFuc2llbnQnICtcbiAgICAnIGRlYnVnZ2VyIGltcGxlbWVudHMgcHJvdGVjdGVkIHZvbGF0aWxlJyArXG4gICAgJyBkb3VibGUgaW1wb3J0IHB1YmxpYyBsZXQgeWllbGQgYXdhaXQnICtcbiAgICAnIG51bGwgdHJ1ZSBmYWxzZSdcbiAgKS5zcGxpdCgnICcpO1xuXG4gIGNvbnN0IGNvbXBpbGVyV29yZHMgPSAoSmF2YVNjcmlwdENvbXBpbGVyLlJFU0VSVkVEX1dPUkRTID0ge30pO1xuXG4gIGZvciAobGV0IGkgPSAwLCBsID0gcmVzZXJ2ZWRXb3Jkcy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICBjb21waWxlcldvcmRzW3Jlc2VydmVkV29yZHNbaV1dID0gdHJ1ZTtcbiAgfVxufSkoKTtcblxuLyoqXG4gKiBAZGVwcmVjYXRlZCBNYXkgYmUgcmVtb3ZlZCBpbiB0aGUgbmV4dCBtYWpvciB2ZXJzaW9uXG4gKi9cbkphdmFTY3JpcHRDb21waWxlci5pc1ZhbGlkSmF2YVNjcmlwdFZhcmlhYmxlTmFtZSA9IGZ1bmN0aW9uKG5hbWUpIHtcbiAgcmV0dXJuIChcbiAgICAhSmF2YVNjcmlwdENvbXBpbGVyLlJFU0VSVkVEX1dPUkRTW25hbWVdICYmXG4gICAgL15bYS16QS1aXyRdWzAtOWEtekEtWl8kXSokLy50ZXN0KG5hbWUpXG4gICk7XG59O1xuXG5mdW5jdGlvbiBzdHJpY3RMb29rdXAocmVxdWlyZVRlcm1pbmFsLCBjb21waWxlciwgcGFydHMsIGksIHR5cGUpIHtcbiAgbGV0IHN0YWNrID0gY29tcGlsZXIucG9wU3RhY2soKSxcbiAgICBsZW4gPSBwYXJ0cy5sZW5ndGg7XG4gIGlmIChyZXF1aXJlVGVybWluYWwpIHtcbiAgICBsZW4tLTtcbiAgfVxuXG4gIGZvciAoOyBpIDwgbGVuOyBpKyspIHtcbiAgICBzdGFjayA9IGNvbXBpbGVyLm5hbWVMb29rdXAoc3RhY2ssIHBhcnRzW2ldLCB0eXBlKTtcbiAgfVxuXG4gIGlmIChyZXF1aXJlVGVybWluYWwpIHtcbiAgICByZXR1cm4gW1xuICAgICAgY29tcGlsZXIuYWxpYXNhYmxlKCdjb250YWluZXIuc3RyaWN0JyksXG4gICAgICAnKCcsXG4gICAgICBzdGFjayxcbiAgICAgICcsICcsXG4gICAgICBjb21waWxlci5xdW90ZWRTdHJpbmcocGFydHNbaV0pLFxuICAgICAgJywgJyxcbiAgICAgIEpTT04uc3RyaW5naWZ5KGNvbXBpbGVyLnNvdXJjZS5jdXJyZW50TG9jYXRpb24pLFxuICAgICAgJyApJ1xuICAgIF07XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHN0YWNrO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IEphdmFTY3JpcHRDb21waWxlcjtcbiJdfQ==</span>
<a name="l1159"><span class="ln">1159 </span></a></pre>
</body>
</html>